!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).TRTCDebugDialog=t()}(this,function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=function(e){return e&&e.Math===Math&&e},i=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof e&&e)||t("object"==typeof e&&e)||function(){return this}()||Function("return this")(),r={},n=function(e){try{return!!e()}catch(t){return!0}},a=!n(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}),o=!n(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),s=o,c=Function.prototype.call,l=s?c.bind(c):function(){return c.apply(c,arguments)},d={},u={}.propertyIsEnumerable,h=Object.getOwnPropertyDescriptor,p=h&&!u.call({1:2},1);d.f=p?function(e){var t=h(this,e);return!!t&&t.enumerable}:u;var f,m,g=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},v=o,_=Function.prototype,y=_.call,E=v&&_.bind.bind(y,y),b=v?E:function(e){return function(){return y.apply(e,arguments)}},w=b,I=w({}.toString),T=w("".slice),S=function(e){return T(I(e),8,-1)},A=n,R=S,k=Object,C=b("".split),D=A(function(){return!k("z").propertyIsEnumerable(0)})?function(e){return"String"===R(e)?C(e,""):k(e)}:k,O=function(e){return null==e},L=O,N=TypeError,P=function(e){if(L(e))throw new N("Can't call method on "+e);return e},x=D,M=P,U=function(e){return x(M(e))},F="object"==typeof document&&document.all,B=void 0===F&&void 0!==F?function(e){return"function"==typeof e||e===F}:function(e){return"function"==typeof e},V=B,H=function(e){return"object"==typeof e?null!==e:V(e)},j=i,z=B,W=function(e,t){return arguments.length<2?(i=j[e],z(i)?i:void 0):j[e]&&j[e][t];var i},G=b({}.isPrototypeOf),q=i.navigator,K=q&&q.userAgent,Y=K?String(K):"",X=i,Z=Y,J=X.process,Q=X.Deno,$=J&&J.versions||Q&&Q.version,ee=$&&$.v8;ee&&(m=(f=ee.split("."))[0]>0&&f[0]<4?1:+(f[0]+f[1])),!m&&Z&&(!(f=Z.match(/Edge\/(\d+)/))||f[1]>=74)&&(f=Z.match(/Chrome\/(\d+)/))&&(m=+f[1]);var te=m,ie=te,re=n,ne=i.String,ae=!!Object.getOwnPropertySymbols&&!re(function(){var e=Symbol("symbol detection");return!ne(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&ie&&ie<41}),oe=ae&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,se=W,ce=B,le=G,de=Object,ue=oe?function(e){return"symbol"==typeof e}:function(e){var t=se("Symbol");return ce(t)&&le(t.prototype,de(e))},he=String,pe=function(e){try{return he(e)}catch(t){return"Object"}},fe=B,me=pe,ge=TypeError,ve=function(e){if(fe(e))return e;throw new ge(me(e)+" is not a function")},_e=ve,ye=O,Ee=function(e,t){var i=e[t];return ye(i)?void 0:_e(i)},be=l,we=B,Ie=H,Te=TypeError,Se={exports:{}},Ae=i,Re=Object.defineProperty,ke=function(e,t){try{Re(Ae,e,{value:t,configurable:!0,writable:!0})}catch(i){Ae[e]=t}return t},Ce=i,De=ke,Oe="__core-js_shared__",Le=Se.exports=Ce[Oe]||De(Oe,{});(Le.versions||(Le.versions=[])).push({version:"3.47.0",mode:"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Ne=Se.exports,Pe=Ne,xe=function(e,t){return Pe[e]||(Pe[e]=t||{})},Me=P,Ue=Object,Fe=function(e){return Ue(Me(e))},Be=Fe,Ve=b({}.hasOwnProperty),He=Object.hasOwn||function(e,t){return Ve(Be(e),t)},je=b,ze=0,We=Math.random(),Ge=je(1.1.toString),qe=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Ge(++ze+We,36)},Ke=xe,Ye=He,Xe=qe,Ze=ae,Je=oe,Qe=i.Symbol,$e=Ke("wks"),et=Je?Qe.for||Qe:Qe&&Qe.withoutSetter||Xe,tt=function(e){return Ye($e,e)||($e[e]=Ze&&Ye(Qe,e)?Qe[e]:et("Symbol."+e)),$e[e]},it=l,rt=H,nt=ue,at=Ee,ot=function(e,t){var i,r;if("string"===t&&we(i=e.toString)&&!Ie(r=be(i,e)))return r;if(we(i=e.valueOf)&&!Ie(r=be(i,e)))return r;if("string"!==t&&we(i=e.toString)&&!Ie(r=be(i,e)))return r;throw new Te("Can't convert object to primitive value")},st=TypeError,ct=tt("toPrimitive"),lt=function(e,t){if(!rt(e)||nt(e))return e;var i,r=at(e,ct);if(r){if(void 0===t&&(t="default"),i=it(r,e,t),!rt(i)||nt(i))return i;throw new st("Can't convert object to primitive value")}return void 0===t&&(t="number"),ot(e,t)},dt=lt,ut=ue,ht=function(e){var t=dt(e,"string");return ut(t)?t:t+""},pt=H,ft=i.document,mt=pt(ft)&&pt(ft.createElement),gt=function(e){return mt?ft.createElement(e):{}},vt=gt,_t=!a&&!n(function(){return 7!==Object.defineProperty(vt("div"),"a",{get:function(){return 7}}).a}),yt=a,Et=l,bt=d,wt=g,It=U,Tt=ht,St=He,At=_t,Rt=Object.getOwnPropertyDescriptor;r.f=yt?Rt:function(e,t){if(e=It(e),t=Tt(t),At)try{return Rt(e,t)}catch(i){}if(St(e,t))return wt(!Et(bt.f,e,t),e[t])};var kt={},Ct=a&&n(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),Dt=H,Ot=String,Lt=TypeError,Nt=function(e){if(Dt(e))return e;throw new Lt(Ot(e)+" is not an object")},Pt=a,xt=_t,Mt=Ct,Ut=Nt,Ft=ht,Bt=TypeError,Vt=Object.defineProperty,Ht=Object.getOwnPropertyDescriptor,jt="enumerable",zt="configurable",Wt="writable";kt.f=Pt?Mt?function(e,t,i){if(Ut(e),t=Ft(t),Ut(i),"function"==typeof e&&"prototype"===t&&"value"in i&&Wt in i&&!i[Wt]){var r=Ht(e,t);r&&r[Wt]&&(e[t]=i.value,i={configurable:zt in i?i[zt]:r[zt],enumerable:jt in i?i[jt]:r[jt],writable:!1})}return Vt(e,t,i)}:Vt:function(e,t,i){if(Ut(e),t=Ft(t),Ut(i),xt)try{return Vt(e,t,i)}catch(r){}if("get"in i||"set"in i)throw new Bt("Accessors not supported");return"value"in i&&(e[t]=i.value),e};var Gt=kt,qt=g,Kt=a?function(e,t,i){return Gt.f(e,t,qt(1,i))}:function(e,t,i){return e[t]=i,e},Yt={exports:{}},Xt=a,Zt=He,Jt=Function.prototype,Qt=Xt&&Object.getOwnPropertyDescriptor,$t=Zt(Jt,"name"),ei={EXISTS:$t,PROPER:$t&&"something"===function(){}.name,CONFIGURABLE:$t&&(!Xt||Xt&&Qt(Jt,"name").configurable)},ti=B,ii=Ne,ri=b(Function.toString);ti(ii.inspectSource)||(ii.inspectSource=function(e){return ri(e)});var ni,ai,oi,si=ii.inspectSource,ci=B,li=i.WeakMap,di=ci(li)&&/native code/.test(String(li)),ui=qe,hi=xe("keys"),pi=function(e){return hi[e]||(hi[e]=ui(e))},fi={},mi=di,gi=i,vi=H,_i=Kt,yi=He,Ei=Ne,bi=pi,wi=fi,Ii="Object already initialized",Ti=gi.TypeError,Si=gi.WeakMap;if(mi||Ei.state){var Ai=Ei.state||(Ei.state=new Si);Ai.get=Ai.get,Ai.has=Ai.has,Ai.set=Ai.set,ni=function(e,t){if(Ai.has(e))throw new Ti(Ii);return t.facade=e,Ai.set(e,t),t},ai=function(e){return Ai.get(e)||{}},oi=function(e){return Ai.has(e)}}else{var Ri=bi("state");wi[Ri]=!0,ni=function(e,t){if(yi(e,Ri))throw new Ti(Ii);return t.facade=e,_i(e,Ri,t),t},ai=function(e){return yi(e,Ri)?e[Ri]:{}},oi=function(e){return yi(e,Ri)}}var ki={set:ni,get:ai,has:oi,enforce:function(e){return oi(e)?ai(e):ni(e,{})},getterFor:function(e){return function(t){var i;if(!vi(t)||(i=ai(t)).type!==e)throw new Ti("Incompatible receiver, "+e+" required");return i}}},Ci=b,Di=n,Oi=B,Li=He,Ni=a,Pi=ei.CONFIGURABLE,xi=si,Mi=ki.enforce,Ui=ki.get,Fi=String,Bi=Object.defineProperty,Vi=Ci("".slice),Hi=Ci("".replace),ji=Ci([].join),zi=Ni&&!Di(function(){return 8!==Bi(function(){},"length",{value:8}).length}),Wi=String(String).split("String"),Gi=Yt.exports=function(e,t,i){"Symbol("===Vi(Fi(t),0,7)&&(t="["+Hi(Fi(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(t="get "+t),i&&i.setter&&(t="set "+t),(!Li(e,"name")||Pi&&e.name!==t)&&(Ni?Bi(e,"name",{value:t,configurable:!0}):e.name=t),zi&&i&&Li(i,"arity")&&e.length!==i.arity&&Bi(e,"length",{value:i.arity});try{i&&Li(i,"constructor")&&i.constructor?Ni&&Bi(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(n){}var r=Mi(e);return Li(r,"source")||(r.source=ji(Wi,"string"==typeof t?t:"")),e};Function.prototype.toString=Gi(function(){return Oi(this)&&Ui(this).source||xi(this)},"toString");var qi=Yt.exports,Ki=B,Yi=kt,Xi=qi,Zi=ke,Ji=function(e,t,i,r){r||(r={});var n=r.enumerable,a=void 0!==r.name?r.name:t;if(Ki(i)&&Xi(i,a,r),r.global)n?e[t]=i:Zi(t,i);else{try{r.unsafe?e[t]&&(n=!0):delete e[t]}catch(o){}n?e[t]=i:Yi.f(e,t,{value:i,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return e},Qi={},$i=Math.ceil,er=Math.floor,tr=Math.trunc||function(e){var t=+e;return(t>0?er:$i)(t)},ir=function(e){var t=+e;return t!=t||0===t?0:tr(t)},rr=ir,nr=Math.max,ar=Math.min,or=function(e,t){var i=rr(e);return i<0?nr(i+t,0):ar(i,t)},sr=ir,cr=Math.min,lr=function(e){var t=sr(e);return t>0?cr(t,9007199254740991):0},dr=lr,ur=function(e){return dr(e.length)},hr=U,pr=or,fr=ur,mr=function(e){return function(t,i,r){var n=hr(t),a=fr(n);if(0===a)return!e&&-1;var o,s=pr(r,a);if(e&&i!=i){for(;a>s;)if((o=n[s++])!=o)return!0}else for(;a>s;s++)if((e||s in n)&&n[s]===i)return e||s||0;return!e&&-1}},gr={includes:mr(!0),indexOf:mr(!1)},vr=He,_r=U,yr=gr.indexOf,Er=fi,br=b([].push),wr=function(e,t){var i,r=_r(e),n=0,a=[];for(i in r)!vr(Er,i)&&vr(r,i)&&br(a,i);for(;t.length>n;)vr(r,i=t[n++])&&(~yr(a,i)||br(a,i));return a},Ir=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Tr=wr,Sr=Ir.concat("length","prototype");Qi.f=Object.getOwnPropertyNames||function(e){return Tr(e,Sr)};var Ar={};Ar.f=Object.getOwnPropertySymbols;var Rr=W,kr=Qi,Cr=Ar,Dr=Nt,Or=b([].concat),Lr=Rr("Reflect","ownKeys")||function(e){var t=kr.f(Dr(e)),i=Cr.f;return i?Or(t,i(e)):t},Nr=He,Pr=Lr,xr=r,Mr=kt,Ur=function(e,t,i){for(var r=Pr(t),n=Mr.f,a=xr.f,o=0;o<r.length;o++){var s=r[o];Nr(e,s)||i&&Nr(i,s)||n(e,s,a(t,s))}},Fr=n,Br=B,Vr=/#|\.prototype\./,Hr=function(e,t){var i=zr[jr(e)];return i===Gr||i!==Wr&&(Br(t)?Fr(t):!!t)},jr=Hr.normalize=function(e){return String(e).replace(Vr,".").toLowerCase()},zr=Hr.data={},Wr=Hr.NATIVE="N",Gr=Hr.POLYFILL="P",qr=Hr,Kr=i,Yr=r.f,Xr=Kt,Zr=Ji,Jr=ke,Qr=Ur,$r=qr,en=function(e,t){var i,r,n,a,o,s=e.target,c=e.global,l=e.stat;if(i=c?Kr:l?Kr[s]||Jr(s,{}):Kr[s]&&Kr[s].prototype)for(r in t){if(a=t[r],n=e.dontCallGetSet?(o=Yr(i,r))&&o.value:i[r],!$r(c?r:s+(l?".":"#")+r,e.forced)&&void 0!==n){if(typeof a==typeof n)continue;Qr(a,n)}(e.sham||n&&n.sham)&&Xr(a,"sham",!0),Zr(i,r,a,e)}},tn={};tn[tt("toStringTag")]="z";var rn="[object z]"===String(tn),nn=B,an=S,on=tt("toStringTag"),sn=Object,cn="Arguments"===an(function(){return arguments}()),ln=rn?an:function(e){var t,i,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(i){}}(t=sn(e),on))?i:cn?an(t):"Object"===(r=an(t))&&nn(t.callee)?"Arguments":r},dn=ln,un=String,hn=function(e){if("Symbol"===dn(e))throw new TypeError("Cannot convert a Symbol value to a string");return un(e)},pn=qi,fn=kt,mn=function(e,t,i){return i.get&&pn(i.get,t,{getter:!0}),i.set&&pn(i.set,t,{setter:!0}),fn.f(e,t,i)},gn=en,vn=a,_n=b,yn=He,En=B,bn=G,wn=hn,In=mn,Tn=Ur,Sn=i.Symbol,An=Sn&&Sn.prototype;if(vn&&En(Sn)&&(!("description"in An)||void 0!==Sn().description)){var Rn={},kn=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:wn(arguments[0]),t=bn(An,this)?new Sn(e):void 0===e?Sn():Sn(e);return""===e&&(Rn[t]=!0),t};Tn(kn,Sn),kn.prototype=An,An.constructor=kn;var Cn="Symbol(description detection)"===String(Sn("description detection")),Dn=_n(An.valueOf),On=_n(An.toString),Ln=/^Symbol\((.*)\)[^)]+$/,Nn=_n("".replace),Pn=_n("".slice);In(An,"description",{configurable:!0,get:function(){var e=Dn(this);if(yn(Rn,e))return"";var t=On(e),i=Cn?Pn(t,7,-1):Nn(t,Ln,"$1");return""===i?void 0:i}}),gn({global:!0,constructor:!0,forced:!0},{Symbol:kn})}var xn={},Mn=wr,Un=Ir,Fn=Object.keys||function(e){return Mn(e,Un)},Bn=a,Vn=Ct,Hn=kt,jn=Nt,zn=U,Wn=Fn;xn.f=Bn&&!Vn?Object.defineProperties:function(e,t){jn(e);for(var i,r=zn(t),n=Wn(t),a=n.length,o=0;a>o;)Hn.f(e,i=n[o++],r[i]);return e};var Gn,qn=W("document","documentElement"),Kn=Nt,Yn=xn,Xn=Ir,Zn=fi,Jn=qn,Qn=gt,$n="prototype",ea="script",ta=pi("IE_PROTO"),ia=function(){},ra=function(e){return"<"+ea+">"+e+"</"+ea+">"},na=function(e){e.write(ra("")),e.close();var t=e.parentWindow.Object;return e=null,t},aa=function(){try{Gn=new ActiveXObject("htmlfile")}catch(n){}var e,t,i;aa="undefined"!=typeof document?document.domain&&Gn?na(Gn):(t=Qn("iframe"),i="java"+ea+":",t.style.display="none",Jn.appendChild(t),t.src=String(i),(e=t.contentWindow.document).open(),e.write(ra("document.F=Object")),e.close(),e.F):na(Gn);for(var r=Xn.length;r--;)delete aa[$n][Xn[r]];return aa()};Zn[ta]=!0;var oa=Object.create||function(e,t){var i;return null!==e?(ia[$n]=Kn(e),i=new ia,ia[$n]=null,i[ta]=e):i=aa(),void 0===t?i:Yn.f(i,t)},sa=tt,ca=oa,la=kt.f,da=sa("unscopables"),ua=Array.prototype;void 0===ua[da]&&la(ua,da,{configurable:!0,value:ca(null)});var ha=function(e){ua[da][e]=!0},pa=gr.includes,fa=ha;en({target:"Array",proto:!0,forced:n(function(){return!Array(1).includes()})},{includes:function(e){return pa(this,e,arguments.length>1?arguments[1]:void 0)}}),fa("includes");var ma,ga,va,_a={},ya=!n(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Ea=He,ba=B,wa=Fe,Ia=ya,Ta=pi("IE_PROTO"),Sa=Object,Aa=Sa.prototype,Ra=Ia?Sa.getPrototypeOf:function(e){var t=wa(e);if(Ea(t,Ta))return t[Ta];var i=t.constructor;return ba(i)&&t instanceof i?i.prototype:t instanceof Sa?Aa:null},ka=n,Ca=B,Da=H,Oa=Ra,La=Ji,Na=tt("iterator"),Pa=!1;[].keys&&("next"in(va=[].keys())?(ga=Oa(Oa(va)))!==Object.prototype&&(ma=ga):Pa=!0);var xa=!Da(ma)||ka(function(){var e={};return ma[Na].call(e)!==e});xa&&(ma={}),Ca(ma[Na])||La(ma,Na,function(){return this});var Ma={IteratorPrototype:ma,BUGGY_SAFARI_ITERATORS:Pa},Ua=kt.f,Fa=He,Ba=tt("toStringTag"),Va=function(e,t,i){e&&!i&&(e=e.prototype),e&&!Fa(e,Ba)&&Ua(e,Ba,{configurable:!0,value:t})},Ha=Ma.IteratorPrototype,ja=oa,za=g,Wa=Va,Ga=_a,qa=function(){return this},Ka=function(e,t,i,r){var n=t+" Iterator";return e.prototype=ja(Ha,{next:za(+!r,i)}),Wa(e,n,!1),Ga[n]=qa,e},Ya=b,Xa=ve,Za=H,Ja=function(e){return Za(e)||null===e},Qa=String,$a=TypeError,eo=function(e,t,i){try{return Ya(Xa(Object.getOwnPropertyDescriptor(e,t)[i]))}catch(r){}},to=H,io=P,ro=function(e){if(Ja(e))return e;throw new $a("Can't set "+Qa(e)+" as a prototype")},no=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=eo(Object.prototype,"__proto__","set"))(i,[]),t=i instanceof Array}catch(r){}return function(i,r){return io(i),ro(r),to(i)?(t?e(i,r):i.__proto__=r,i):i}}():void 0),ao=en,oo=l,so=B,co=Ka,lo=Ra,uo=no,ho=Va,po=Kt,fo=Ji,mo=_a,go=ei.PROPER,vo=ei.CONFIGURABLE,_o=Ma.IteratorPrototype,yo=Ma.BUGGY_SAFARI_ITERATORS,Eo=tt("iterator"),bo="keys",wo="values",Io="entries",To=function(){return this},So=function(e,t,i,r,n,a,o){co(i,t,r);var s,c,l,d=function(e){if(e===n&&m)return m;if(!yo&&e&&e in p)return p[e];switch(e){case bo:case wo:case Io:return function(){return new i(this,e)}}return function(){return new i(this)}},u=t+" Iterator",h=!1,p=e.prototype,f=p[Eo]||p["@@iterator"]||n&&p[n],m=!yo&&f||d(n),g="Array"===t&&p.entries||f;if(g&&(s=lo(g.call(new e)))!==Object.prototype&&s.next&&(lo(s)!==_o&&(uo?uo(s,_o):so(s[Eo])||fo(s,Eo,To)),ho(s,u,!0)),go&&n===wo&&f&&f.name!==wo&&(vo?po(p,"name",wo):(h=!0,m=function(){return oo(f,this)})),n)if(c={values:d(wo),keys:a?m:d(bo),entries:d(Io)},o)for(l in c)(yo||h||!(l in p))&&fo(p,l,c[l]);else ao({target:t,proto:!0,forced:yo||h},c);return p[Eo]!==m&&fo(p,Eo,m,{name:n}),mo[t]=m,c},Ao=function(e,t){return{value:e,done:t}},Ro=U,ko=ha,Co=_a,Do=ki,Oo=kt.f,Lo=So,No=Ao,Po=a,xo="Array Iterator",Mo=Do.set,Uo=Do.getterFor(xo),Fo=Lo(Array,"Array",function(e,t){Mo(this,{type:xo,target:Ro(e),index:0,kind:t})},function(){var e=Uo(this),t=e.target,i=e.index++;if(!t||i>=t.length)return e.target=null,No(void 0,!0);switch(e.kind){case"keys":return No(i,!1);case"values":return No(t[i],!1)}return No([i,t[i]],!1)},"values"),Bo=Co.Arguments=Co.Array;if(ko("keys"),ko("values"),ko("entries"),Po&&"values"!==Bo.name)try{Oo(Bo,"name",{value:"values"})}catch(VM){}var Vo=ve,Ho=Fe,jo=D,zo=ur,Wo=TypeError,Go="Reduce of empty array with no initial value",qo=function(e){return function(t,i,r,n){var a=Ho(t),o=jo(a),s=zo(a);if(Vo(i),0===s&&r<2)throw new Wo(Go);var c=e?s-1:0,l=e?-1:1;if(r<2)for(;;){if(c in o){n=o[c],c+=l;break}if(c+=l,e?c<0:s<=c)throw new Wo(Go)}for(;e?c>=0:s>c;c+=l)c in o&&(n=i(n,o[c],c,a));return n}},Ko={left:qo(!1),right:qo(!0)},Yo=n,Xo=function(e,t){var i=[][e];return!!i&&Yo(function(){i.call(null,t||function(){return 1},1)})},Zo=i,Jo=Y,Qo=S,$o=function(e){return Jo.slice(0,e.length)===e},es=$o("Bun/")?"BUN":$o("Cloudflare-Workers")?"CLOUDFLARE":$o("Deno/")?"DENO":$o("Node.js/")?"NODE":Zo.Bun&&"string"==typeof Bun.version?"BUN":Zo.Deno&&"object"==typeof Deno.version?"DENO":"process"===Qo(Zo.process)?"NODE":Zo.window&&Zo.document?"BROWSER":"REST",ts="NODE"===es,is=Ko.left;en({target:"Array",proto:!0,forced:!ts&&te>79&&te<83||!Xo("reduce")},{reduce:function(e){var t=arguments.length;return is(this,e,t,t>1?arguments[1]:void 0)}});var rs=Ko.right;en({target:"Array",proto:!0,forced:!ts&&te>79&&te<83||!Xo("reduceRight")},{reduceRight:function(e){return rs(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var ns=S,as=Array.isArray||function(e){return"Array"===ns(e)},os=en,ss=as,cs=b([].reverse),ls=[1,2];os({target:"Array",proto:!0,forced:String(ls)===String(ls.reverse())},{reverse:function(){return ss(this)&&(this.length=this.length),cs(this)}});var ds="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,us=Ji,hs=function(e,t,i){for(var r in t)us(e,r,t[r],i);return e},ps=G,fs=TypeError,ms=function(e,t){if(ps(t,e))return e;throw new fs("Incorrect invocation")},gs=ir,vs=lr,_s=RangeError,ys=function(e){if(void 0===e)return 0;var t=gs(e),i=vs(t);if(t!==i)throw new _s("Wrong length or index");return i},Es=Math.sign||function(e){var t=+e;return 0===t||t!=t?t:t<0?-1:1},bs=4503599627370496,ws=Es,Is=function(e){return e+bs-bs},Ts=Math.abs,Ss=function(e,t,i,r){var n=+e,a=Ts(n),o=ws(n);if(a<r)return o*Is(a/r/t)*r*t;var s=(1+t/2220446049250313e-31)*a,c=s-(s-a);return c>i||c!=c?Infinity*o:o*c},As=Math.fround||function(e){return Ss(e,1.1920928955078125e-7,34028234663852886e22,11754943508222875e-54)},Rs=Array,ks=Math.abs,Cs=Math.pow,Ds=Math.floor,Os=Math.log,Ls=Math.LN2,Ns={pack:function(e,t,i){var r,n,a,o=Rs(i),s=8*i-t-1,c=(1<<s)-1,l=c>>1,d=23===t?Cs(2,-24)-Cs(2,-77):0,u=e<0||0===e&&1/e<0?1:0,h=0;for((e=ks(e))!=e||Infinity===e?(n=e!=e?1:0,r=c):(r=Ds(Os(e)/Ls),e*(a=Cs(2,-r))<1&&(r--,a*=2),(e+=r+l>=1?d/a:d*Cs(2,1-l))*a>=2&&(r++,a/=2),r+l>=c?(n=0,r=c):r+l>=1?(n=(e*a-1)*Cs(2,t),r+=l):(n=e*Cs(2,l-1)*Cs(2,t),r=0));t>=8;)o[h++]=255&n,n/=256,t-=8;for(r=r<<t|n,s+=t;s>0;)o[h++]=255&r,r/=256,s-=8;return o[h-1]|=128*u,o},unpack:function(e,t){var i,r=e.length,n=8*r-t-1,a=(1<<n)-1,o=a>>1,s=n-7,c=r-1,l=e[c--],d=127&l;for(l>>=7;s>0;)d=256*d+e[c--],s-=8;for(i=d&(1<<-s)-1,d>>=-s,s+=t;s>0;)i=256*i+e[c--],s-=8;if(0===d)d=1-o;else{if(d===a)return i?NaN:l?-Infinity:Infinity;i+=Cs(2,t),d-=o}return(l?-1:1)*i*Cs(2,d-t)}},Ps=Fe,xs=or,Ms=ur,Us=function(e){for(var t=Ps(this),i=Ms(t),r=arguments.length,n=xs(r>1?arguments[1]:void 0,i),a=r>2?arguments[2]:void 0,o=void 0===a?i:xs(a,i);o>n;)t[n++]=e;return t},Fs=b([].slice),Bs=B,Vs=H,Hs=no,js=function(e,t,i){var r,n;return Hs&&Bs(r=t.constructor)&&r!==i&&Vs(n=r.prototype)&&n!==i.prototype&&Hs(e,n),e},zs=i,Ws=b,Gs=a,qs=ds,Ks=Kt,Ys=mn,Xs=hs,Zs=n,Js=ms,Qs=ir,$s=lr,ec=ys,tc=As,ic=Ns,rc=Ra,nc=no,ac=Us,oc=Fs,sc=js,cc=Ur,lc=Va,dc=ki,uc=ei.PROPER,hc=ei.CONFIGURABLE,pc="ArrayBuffer",fc="DataView",mc="prototype",gc="Wrong index",vc=dc.getterFor(pc),_c=dc.getterFor(fc),yc=dc.set,Ec=zs[pc],bc=Ec,wc=bc&&bc[mc],Ic=zs[fc],Tc=Ic&&Ic[mc],Sc=Object.prototype,Ac=zs.Array,Rc=zs.RangeError,kc=Ws(ac),Cc=Ws([].reverse),Dc=ic.pack,Oc=ic.unpack,Lc=function(e){return[255&e]},Nc=function(e){return[255&e,e>>8&255]},Pc=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},xc=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Mc=function(e){return Dc(tc(e),23,4)},Uc=function(e){return Dc(e,52,8)},Fc=function(e,t,i){Ys(e[mc],t,{configurable:!0,get:function(){return i(this)[t]}})},Bc=function(e,t,i,r){var n=_c(e),a=ec(i),o=!!r;if(a+t>n.byteLength)throw new Rc(gc);var s=n.bytes,c=a+n.byteOffset,l=oc(s,c,c+t);return o?l:Cc(l)},Vc=function(e,t,i,r,n,a){var o=_c(e),s=ec(i),c=r(+n),l=!!a;if(s+t>o.byteLength)throw new Rc(gc);for(var d=o.bytes,u=s+o.byteOffset,h=0;h<t;h++)d[u+h]=c[l?h:t-h-1]};if(qs){var Hc=uc&&Ec.name!==pc;Zs(function(){Ec(1)})&&Zs(function(){new Ec(-1)})&&!Zs(function(){return new Ec,new Ec(1.5),new Ec(NaN),1!==Ec.length||Hc&&!hc})?Hc&&hc&&Ks(Ec,"name",pc):((bc=function(e){return Js(this,wc),sc(new Ec(ec(e)),this,bc)})[mc]=wc,wc.constructor=bc,cc(bc,Ec)),nc&&rc(Tc)!==Sc&&nc(Tc,Sc);var jc=new Ic(new bc(2)),zc=Ws(Tc.setInt8);jc.setInt8(0,2147483648),jc.setInt8(1,2147483649),!jc.getInt8(0)&&jc.getInt8(1)||Xs(Tc,{setInt8:function(e,t){zc(this,e,t<<24>>24)},setUint8:function(e,t){zc(this,e,t<<24>>24)}},{unsafe:!0})}else wc=(bc=function(e){Js(this,wc);var t=ec(e);yc(this,{type:pc,bytes:kc(Ac(t),0),byteLength:t}),Gs||(this.byteLength=t,this.detached=!1)})[mc],Tc=(Ic=function(e,t,i){Js(this,Tc),Js(e,wc);var r=vc(e),n=r.byteLength,a=Qs(t);if(a<0||a>n)throw new Rc("Wrong offset");if(a+(i=void 0===i?n-a:$s(i))>n)throw new Rc("Wrong length");yc(this,{type:fc,buffer:e,byteLength:i,byteOffset:a,bytes:r.bytes}),Gs||(this.buffer=e,this.byteLength=i,this.byteOffset=a)})[mc],Gs&&(Fc(bc,"byteLength",vc),Fc(Ic,"buffer",_c),Fc(Ic,"byteLength",_c),Fc(Ic,"byteOffset",_c)),Xs(Tc,{getInt8:function(e){return Bc(this,1,e)[0]<<24>>24},getUint8:function(e){return Bc(this,1,e)[0]},getInt16:function(e){var t=Bc(this,2,e,arguments.length>1&&arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=Bc(this,2,e,arguments.length>1&&arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return xc(Bc(this,4,e,arguments.length>1&&arguments[1]))},getUint32:function(e){return xc(Bc(this,4,e,arguments.length>1&&arguments[1]))>>>0},getFloat32:function(e){return Oc(Bc(this,4,e,arguments.length>1&&arguments[1]),23)},getFloat64:function(e){return Oc(Bc(this,8,e,arguments.length>1&&arguments[1]),52)},setInt8:function(e,t){Vc(this,1,e,Lc,t)},setUint8:function(e,t){Vc(this,1,e,Lc,t)},setInt16:function(e,t){Vc(this,2,e,Nc,t,arguments.length>2&&arguments[2])},setUint16:function(e,t){Vc(this,2,e,Nc,t,arguments.length>2&&arguments[2])},setInt32:function(e,t){Vc(this,4,e,Pc,t,arguments.length>2&&arguments[2])},setUint32:function(e,t){Vc(this,4,e,Pc,t,arguments.length>2&&arguments[2])},setFloat32:function(e,t){Vc(this,4,e,Mc,t,arguments.length>2&&arguments[2])},setFloat64:function(e,t){Vc(this,8,e,Uc,t,arguments.length>2&&arguments[2])}});lc(bc,pc),lc(Ic,fc);var Wc={ArrayBuffer:bc,DataView:Ic},Gc=W,qc=mn,Kc=a,Yc=tt("species"),Xc=function(e){var t=Gc(e);Kc&&t&&!t[Yc]&&qc(t,Yc,{configurable:!0,get:function(){return this}})},Zc=Xc,Jc="ArrayBuffer",Qc=Wc[Jc];en({global:!0,constructor:!0,forced:i[Jc]!==Qc},{ArrayBuffer:Qc}),Zc(Jc);var $c=S,el=b,tl=function(e){if("Function"===$c(e))return el(e)},il=en,rl=tl,nl=n,al=Nt,ol=or,sl=lr,cl=Wc.ArrayBuffer,ll=Wc.DataView,dl=ll.prototype,ul=rl(cl.prototype.slice),hl=rl(dl.getUint8),pl=rl(dl.setUint8);il({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:nl(function(){return!new cl(2).slice(1,void 0).byteLength})},{slice:function(e,t){if(ul&&void 0===t)return ul(al(this),e);for(var i=al(this).byteLength,r=ol(e,i),n=ol(void 0===t?i:t,i),a=new cl(sl(n-r)),o=new ll(this),s=new ll(a),c=0;r<n;)pl(s,c++,hl(o,r++));return a}});var fl=i,ml=b,gl=n,vl=B,_l=ln,yl=si,El=function(){},bl=W("Reflect","construct"),wl=/^\s*(?:class|function)\b/,Il=ml(wl.exec),Tl=!wl.test(El),Sl=function(e){if(!vl(e))return!1;try{return bl(El,[],e),!0}catch(VM){return!1}},Al=function(e){if(!vl(e))return!1;switch(_l(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Tl||!!Il(wl,yl(e))}catch(VM){return!0}};Al.sham=!0;var Rl,kl,Cl,Dl,Ol=!bl||gl(function(){var e;return Sl(Sl.call)||!Sl(Object)||!Sl(function(){e=!0})||e})?Al:Sl,Ll=Ol,Nl=pe,Pl=TypeError,xl=function(e){if(Ll(e))return e;throw new Pl(Nl(e)+" is not a constructor")},Ml=Nt,Ul=xl,Fl=O,Bl=tt("species"),Vl=function(e,t){var i,r=Ml(e).constructor;return void 0===r||Fl(i=Ml(r)[Bl])?t:Ul(i)},Hl=o,jl=Function.prototype,zl=jl.apply,Wl=jl.call,Gl="object"==typeof Reflect&&Reflect.apply||(Hl?Wl.bind(zl):function(){return Wl.apply(zl,arguments)}),ql=ve,Kl=o,Yl=tl(tl.bind),Xl=function(e,t){return ql(e),void 0===t?e:Kl?Yl(e,t):function(){return e.apply(t,arguments)}},Zl=TypeError,Jl=function(e,t){if(e<t)throw new Zl("Not enough arguments");return e},Ql=/(?:ipad|iphone|ipod).*applewebkit/i.test(Y),$l=i,ed=Gl,td=Xl,id=B,rd=He,nd=n,ad=qn,od=Fs,sd=gt,cd=Jl,ld=Ql,dd=ts,ud=$l.setImmediate,hd=$l.clearImmediate,pd=$l.process,fd=$l.Dispatch,md=$l.Function,gd=$l.MessageChannel,vd=$l.String,_d=0,yd={},Ed="onreadystatechange";nd(function(){Rl=$l.location});var bd=function(e){if(rd(yd,e)){var t=yd[e];delete yd[e],t()}},wd=function(e){return function(){bd(e)}},Id=function(e){bd(e.data)},Td=function(e){$l.postMessage(vd(e),Rl.protocol+"//"+Rl.host)};ud&&hd||(ud=function(e){cd(arguments.length,1);var t=id(e)?e:md(e),i=od(arguments,1);return yd[++_d]=function(){ed(t,void 0,i)},kl(_d),_d},hd=function(e){delete yd[e]},dd?kl=function(e){pd.nextTick(wd(e))}:fd&&fd.now?kl=function(e){fd.now(wd(e))}:gd&&!ld?(Dl=(Cl=new gd).port2,Cl.port1.onmessage=Id,kl=td(Dl.postMessage,Dl)):$l.addEventListener&&id($l.postMessage)&&!$l.importScripts&&Rl&&"file:"!==Rl.protocol&&!nd(Td)?(kl=Td,$l.addEventListener("message",Id,!1)):kl=Ed in sd("script")?function(e){ad.appendChild(sd("script"))[Ed]=function(){ad.removeChild(this),bd(e)}}:function(e){setTimeout(wd(e),0)});var Sd={set:ud,clear:hd},Ad=i,Rd=a,kd=Object.getOwnPropertyDescriptor,Cd=function(e){if(!Rd)return Ad[e];var t=kd(Ad,e);return t&&t.value},Dd=function(){this.head=null,this.tail=null};Dd.prototype={add:function(e){var t={item:e,next:null},i=this.tail;i?i.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var Od,Ld,Nd,Pd,xd,Md=Dd,Ud=/ipad|iphone|ipod/i.test(Y)&&"undefined"!=typeof Pebble,Fd=/web0s(?!.*chrome)/i.test(Y),Bd=i,Vd=Cd,Hd=Xl,jd=Sd.set,zd=Md,Wd=Ql,Gd=Ud,qd=Fd,Kd=ts,Yd=Bd.MutationObserver||Bd.WebKitMutationObserver,Xd=Bd.document,Zd=Bd.process,Jd=Bd.Promise,Qd=Vd("queueMicrotask");if(!Qd){var $d=new zd,eu=function(){var e,t;for(Kd&&(e=Zd.domain)&&e.exit();t=$d.get();)try{t()}catch(VM){throw $d.head&&Od(),VM}e&&e.enter()};Wd||Kd||qd||!Yd||!Xd?!Gd&&Jd&&Jd.resolve?((Pd=Jd.resolve(void 0)).constructor=Jd,xd=Hd(Pd.then,Pd),Od=function(){xd(eu)}):Kd?Od=function(){Zd.nextTick(eu)}:(jd=Hd(jd,Bd),Od=function(){jd(eu)}):(Ld=!0,Nd=Xd.createTextNode(""),new Yd(eu).observe(Nd,{characterData:!0}),Od=function(){Nd.data=Ld=!Ld}),Qd=function(e){$d.head||Od(),$d.add(e)}}var tu=Qd,iu=function(e){try{return{error:!1,value:e()}}catch(VM){return{error:!0,value:VM}}},ru=i.Promise,nu=i,au=ru,ou=B,su=qr,cu=si,lu=tt,du=es,uu=te;au&&au.prototype;var hu=lu("species"),pu=!1,fu=ou(nu.PromiseRejectionEvent),mu=su("Promise",function(){var e=cu(au),t=e!==String(au);if(!t&&66===uu)return!0;if(!uu||uu<51||!/native code/.test(e)){var i=new au(function(e){e(1)}),r=function(e){e(function(){},function(){})};if((i.constructor={})[hu]=r,!(pu=i.then(function(){})instanceof r))return!0}return!(t||"BROWSER"!==du&&"DENO"!==du||fu)}),gu={CONSTRUCTOR:mu,REJECTION_EVENT:fu,SUBCLASSING:pu},vu={},_u=ve,yu=TypeError,Eu=function(e){var t,i;this.promise=new e(function(e,r){if(void 0!==t||void 0!==i)throw new yu("Bad Promise constructor");t=e,i=r}),this.resolve=_u(t),this.reject=_u(i)};vu.f=function(e){return new Eu(e)};var bu,wu,Iu,Tu,Su=en,Au=ts,Ru=i,ku=fl,Cu=l,Du=Ji,Ou=no,Lu=Va,Nu=Xc,Pu=ve,xu=B,Mu=H,Uu=ms,Fu=Vl,Bu=Sd.set,Vu=tu,Hu=function(e,t){try{1===arguments.length?console.error(e):console.error(e,t)}catch(VM){}},ju=iu,zu=Md,Wu=ki,Gu=ru,qu=vu,Ku="Promise",Yu=gu.CONSTRUCTOR,Xu=gu.REJECTION_EVENT,Zu=gu.SUBCLASSING,Ju=Wu.getterFor(Ku),Qu=Wu.set,$u=Gu&&Gu.prototype,eh=Gu,th=$u,ih=Ru.TypeError,rh=Ru.document,nh=Ru.process,ah=qu.f,oh=ah,sh=!!(rh&&rh.createEvent&&Ru.dispatchEvent),ch="unhandledrejection",lh=function(e){var t;return!(!Mu(e)||!xu(t=e.then))&&t},dh=function(e,t){var i,r,n,a=t.value,o=1===t.state,s=o?e.ok:e.fail,c=e.resolve,l=e.reject,d=e.domain;try{s?(o||(2===t.rejection&&mh(t),t.rejection=1),!0===s?i=a:(d&&d.enter(),i=s(a),d&&(d.exit(),n=!0)),i===e.promise?l(new ih("Promise-chain cycle")):(r=lh(i))?Cu(r,i,c,l):c(i)):l(a)}catch(VM){d&&!n&&d.exit(),l(VM)}},uh=function(e,t){e.notified||(e.notified=!0,Vu(function(){for(var i,r=e.reactions;i=r.get();)dh(i,e);e.notified=!1,t&&!e.rejection&&ph(e)}))},hh=function(e,t,i){var r,n;sh?((r=rh.createEvent("Event")).promise=t,r.reason=i,r.initEvent(e,!1,!0),Ru.dispatchEvent(r)):r={promise:t,reason:i},!Xu&&(n=Ru["on"+e])?n(r):e===ch&&Hu("Unhandled promise rejection",i)},ph=function(e){Cu(Bu,Ru,function(){var t,i=e.facade,r=e.value;if(fh(e)&&(t=ju(function(){Au?nh.emit("unhandledRejection",r,i):hh(ch,i,r)}),e.rejection=Au||fh(e)?2:1,t.error))throw t.value})},fh=function(e){return 1!==e.rejection&&!e.parent},mh=function(e){Cu(Bu,Ru,function(){var t=e.facade;Au?nh.emit("rejectionHandled",t):hh("rejectionhandled",t,e.value)})},gh=function(e,t,i){return function(r){e(t,r,i)}},vh=function(e,t,i){e.done||(e.done=!0,i&&(e=i),e.value=t,e.state=2,uh(e,!0))},_h=function(e,t,i){if(!e.done){e.done=!0,i&&(e=i);try{if(e.facade===t)throw new ih("Promise can't be resolved itself");var r=lh(t);r?Vu(function(){var i={done:!1};try{Cu(r,t,gh(_h,i,e),gh(vh,i,e))}catch(VM){vh(i,VM,e)}}):(e.value=t,e.state=1,uh(e,!1))}catch(VM){vh({done:!1},VM,e)}}};if(Yu&&(th=(eh=function(e){Uu(this,th),Pu(e),Cu(bu,this);var t=Ju(this);try{e(gh(_h,t),gh(vh,t))}catch(VM){vh(t,VM)}}).prototype,(bu=function(e){Qu(this,{type:Ku,done:!1,notified:!1,parent:!1,reactions:new zu,rejection:!1,state:0,value:null})}).prototype=Du(th,"then",function(e,t){var i=Ju(this),r=ah(Fu(this,eh));return i.parent=!0,r.ok=!xu(e)||e,r.fail=xu(t)&&t,r.domain=Au?nh.domain:void 0,0===i.state?i.reactions.add(r):Vu(function(){dh(r,i)}),r.promise}),wu=function(){var e=new bu,t=Ju(e);this.promise=e,this.resolve=gh(_h,t),this.reject=gh(vh,t)},qu.f=ah=function(e){return e===eh||e===Iu?new wu(e):oh(e)},xu(Gu)&&$u!==Object.prototype)){Tu=$u.then,Zu||Du($u,"then",function(e,t){var i=this;return new eh(function(e,t){Cu(Tu,i,e,t)}).then(e,t)},{unsafe:!0});try{delete $u.constructor}catch(VM){}Ou&&Ou($u,th)}Su({global:!0,constructor:!0,wrap:!0,forced:Yu},{Promise:eh}),Iu=ku.Promise,Lu(eh,Ku,!1),Nu(Ku);var yh=_a,Eh=tt("iterator"),bh=Array.prototype,wh=function(e){return void 0!==e&&(yh.Array===e||bh[Eh]===e)},Ih=ln,Th=Ee,Sh=O,Ah=_a,Rh=tt("iterator"),kh=function(e){if(!Sh(e))return Th(e,Rh)||Th(e,"@@iterator")||Ah[Ih(e)]},Ch=l,Dh=ve,Oh=Nt,Lh=pe,Nh=kh,Ph=TypeError,xh=function(e,t){var i=arguments.length<2?Nh(e):t;if(Dh(i))return Oh(Ch(i,e));throw new Ph(Lh(e)+" is not iterable")},Mh=l,Uh=Nt,Fh=Ee,Bh=function(e,t,i){var r,n;Uh(e);try{if(!(r=Fh(e,"return"))){if("throw"===t)throw i;return i}r=Mh(r,e)}catch(VM){n=!0,r=VM}if("throw"===t)throw i;if(n)throw r;return Uh(r),i},Vh=Xl,Hh=l,jh=Nt,zh=pe,Wh=wh,Gh=ur,qh=G,Kh=xh,Yh=kh,Xh=Bh,Zh=TypeError,Jh=function(e,t){this.stopped=e,this.result=t},Qh=Jh.prototype,$h=function(e,t,i){var r,n,a,o,s,c,l,d=i&&i.that,u=!(!i||!i.AS_ENTRIES),h=!(!i||!i.IS_RECORD),p=!(!i||!i.IS_ITERATOR),f=!(!i||!i.INTERRUPTED),m=Vh(t,d),g=function(e){return r&&Xh(r,"normal"),new Jh(!0,e)},v=function(e){return u?(jh(e),f?m(e[0],e[1],g):m(e[0],e[1])):f?m(e,g):m(e)};if(h)r=e.iterator;else if(p)r=e;else{if(!(n=Yh(e)))throw new Zh(zh(e)+" is not iterable");if(Wh(n)){for(a=0,o=Gh(e);o>a;a++)if((s=v(e[a]))&&qh(Qh,s))return s;return new Jh(!1)}r=Kh(e,n)}for(c=h?e.next:r.next;!(l=Hh(c,r)).done;){try{s=v(l.value)}catch(VM){Xh(r,"throw",VM)}if("object"==typeof s&&s&&qh(Qh,s))return s}return new Jh(!1)},ep=tt("iterator"),tp=!1;try{var ip=0,rp={next:function(){return{done:!!ip++}},return:function(){tp=!0}};rp[ep]=function(){return this},Array.from(rp,function(){throw 2})}catch(VM){}var np=function(e,t){try{if(!t&&!tp)return!1}catch(VM){return!1}var i=!1;try{var r={};r[ep]=function(){return{next:function(){return{done:i=!0}}}},e(r)}catch(VM){}return i},ap=ru,op=gu.CONSTRUCTOR||!np(function(e){ap.all(e).then(void 0,function(){})}),sp=l,cp=ve,lp=vu,dp=iu,up=$h;en({target:"Promise",stat:!0,forced:op},{all:function(e){var t=this,i=lp.f(t),r=i.resolve,n=i.reject,a=dp(function(){var i=cp(t.resolve),a=[],o=0,s=1;up(e,function(e){var c=o++,l=!1;s++,sp(i,t,e).then(function(e){l||(l=!0,a[c]=e,--s||r(a))},n)}),--s||r(a)});return a.error&&n(a.value),i.promise}});var hp=en,pp=gu.CONSTRUCTOR,fp=ru,mp=W,gp=B,vp=Ji,_p=fp&&fp.prototype;if(hp({target:"Promise",proto:!0,forced:pp,real:!0},{catch:function(e){return this.then(void 0,e)}}),gp(fp)){var yp=mp("Promise").prototype.catch;_p.catch!==yp&&vp(_p,"catch",yp,{unsafe:!0})}var Ep=l,bp=ve,wp=vu,Ip=iu,Tp=$h;en({target:"Promise",stat:!0,forced:op},{race:function(e){var t=this,i=wp.f(t),r=i.reject,n=Ip(function(){var n=bp(t.resolve);Tp(e,function(e){Ep(n,t,e).then(i.resolve,r)})});return n.error&&r(n.value),i.promise}});var Sp=vu;en({target:"Promise",stat:!0,forced:gu.CONSTRUCTOR},{reject:function(e){var t=Sp.f(this);return(0,t.reject)(e),t.promise}});var Ap=Nt,Rp=H,kp=vu,Cp=function(e,t){if(Ap(e),Rp(t)&&t.constructor===e)return t;var i=kp.f(e);return(0,i.resolve)(t),i.promise},Dp=en,Op=gu.CONSTRUCTOR,Lp=Cp;W("Promise"),Dp({target:"Promise",stat:!0,forced:Op},{resolve:function(e){return Lp(this,e)}});var Np=en,Pp=ru,xp=n,Mp=W,Up=B,Fp=Vl,Bp=Cp,Vp=Ji,Hp=Pp&&Pp.prototype;if(Np({target:"Promise",proto:!0,real:!0,forced:!!Pp&&xp(function(){Hp.finally.call({then:function(){}},function(){})})},{finally:function(e){var t=Fp(this,Mp("Promise")),i=Up(e);return this.then(i?function(i){return Bp(t,e()).then(function(){return i})}:e,i?function(i){return Bp(t,e()).then(function(){throw i})}:e)}}),Up(Pp)){var jp=Mp("Promise").prototype.finally;Hp.finally!==jp&&Vp(Hp,"finally",jp,{unsafe:!0})}var zp=H,Wp=S,Gp=tt("match"),qp=function(e){var t;return zp(e)&&(void 0!==(t=e[Gp])?!!t:"RegExp"===Wp(e))},Kp=n,Yp=i.RegExp,Xp=!Kp(function(){var e=!0;try{Yp(".","d")}catch(VM){e=!1}var t={},i="",r=e?"dgimsy":"gimsy",n=function(e,r){Object.defineProperty(t,e,{get:function(){return i+=r,!0}})},a={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var o in e&&(a.hasIndices="d"),a)n(o,a[o]);return Object.getOwnPropertyDescriptor(Yp.prototype,"flags").get.call(t)!==r||i!==r}),Zp={correct:Xp},Jp=Nt,Qp=function(){var e=Jp(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},$p=l,ef=He,tf=G,rf=Zp,nf=Qp,af=RegExp.prototype,of=rf.correct?function(e){return e.flags}:function(e){return rf.correct||!tf(af,e)||ef(e,"flags")?e.flags:$p(nf,e)},sf=n,cf=i.RegExp,lf=sf(function(){var e=cf("a","y");return e.lastIndex=2,null!==e.exec("abcd")}),df=lf||sf(function(){return!cf("a","y").sticky}),uf={BROKEN_CARET:lf||sf(function(){var e=cf("^r","gy");return e.lastIndex=2,null!==e.exec("str")}),MISSED_STICKY:df,UNSUPPORTED_Y:lf},hf=kt.f,pf=n,ff=i.RegExp,mf=pf(function(){var e=ff(".","s");return!(e.dotAll&&e.test("\n")&&"s"===e.flags)}),gf=n,vf=i.RegExp,_f=gf(function(){var e=vf("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}),yf=a,Ef=i,bf=b,wf=qr,If=js,Tf=Kt,Sf=oa,Af=Qi.f,Rf=G,kf=qp,Cf=hn,Df=of,Of=uf,Lf=function(e,t,i){i in e||hf(e,i,{configurable:!0,get:function(){return t[i]},set:function(e){t[i]=e}})},Nf=Ji,Pf=n,xf=He,Mf=ki.enforce,Uf=Xc,Ff=mf,Bf=_f,Vf=tt("match"),Hf=Ef.RegExp,jf=Hf.prototype,zf=Ef.SyntaxError,Wf=bf(jf.exec),Gf=bf("".charAt),qf=bf("".replace),Kf=bf("".indexOf),Yf=bf("".slice),Xf=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Zf=/a/g,Jf=/a/g,Qf=new Hf(Zf)!==Zf,$f=Of.MISSED_STICKY,em=Of.UNSUPPORTED_Y,tm=yf&&(!Qf||$f||Ff||Bf||Pf(function(){return Jf[Vf]=!1,Hf(Zf)!==Zf||Hf(Jf)===Jf||"/a/i"!==String(Hf(Zf,"i"))}));if(wf("RegExp",tm)){for(var im=function(e,t){var i,r,n,a,o,s,c=Rf(jf,this),l=kf(e),d=void 0===t,u=[],h=e;if(!c&&l&&d&&e.constructor===im)return e;if((l||Rf(jf,e))&&(e=e.source,d&&(t=Df(h))),e=void 0===e?"":Cf(e),t=void 0===t?"":Cf(t),h=e,Ff&&"dotAll"in Zf&&(r=!!t&&Kf(t,"s")>-1)&&(t=qf(t,/s/g,"")),i=t,$f&&"sticky"in Zf&&(n=!!t&&Kf(t,"y")>-1)&&em&&(t=qf(t,/y/g,"")),Bf&&(a=function(e){for(var t,i=e.length,r=0,n="",a=[],o=Sf(null),s=!1,c=!1,l=0,d="";r<=i;r++){if("\\"===(t=Gf(e,r)))t+=Gf(e,++r);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:if(n+=t,"?:"===Yf(e,r+1,r+3))continue;Wf(Xf,Yf(e,r+1))&&(r+=2,c=!0),l++;continue;case">"===t&&c:if(""===d||xf(o,d))throw new zf("Invalid capture group name");o[d]=!0,a[a.length]=[d,l],c=!1,d="";continue}c?d+=t:n+=t}return[n,a]}(e),e=a[0],u=a[1]),o=If(Hf(e,t),c?this:jf,im),(r||n||u.length)&&(s=Mf(o),r&&(s.dotAll=!0,s.raw=im(function(e){for(var t,i=e.length,r=0,n="",a=!1;r<=i;r++)"\\"!==(t=Gf(e,r))?a||"."!==t?("["===t?a=!0:"]"===t&&(a=!1),n+=t):n+="[\\s\\S]":n+=t+Gf(e,++r);return n}(e),i)),n&&(s.sticky=!0),u.length&&(s.groups=u)),e!==h)try{Tf(o,"source",""===h?"(?:)":h)}catch(VM){}return o},rm=Af(Hf),nm=0;rm.length>nm;)Lf(im,Hf,rm[nm++]);jf.constructor=im,im.prototype=jf,Nf(Ef,"RegExp",im,{constructor:!0})}Uf("RegExp");var am=l,om=b,sm=hn,cm=Qp,lm=uf,dm=oa,um=ki.get,hm=mf,pm=_f,fm=xe("native-string-replace",String.prototype.replace),mm=RegExp.prototype.exec,gm=mm,vm=om("".charAt),_m=om("".indexOf),ym=om("".replace),Em=om("".slice),bm=function(){var e=/a/,t=/b*/g;return am(mm,e,"a"),am(mm,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),wm=lm.BROKEN_CARET,Im=void 0!==/()??/.exec("")[1];(bm||Im||wm||hm||pm)&&(gm=function(e){var t,i,r,n,a,o,s,c=this,l=um(c),d=sm(e),u=l.raw;if(u)return u.lastIndex=c.lastIndex,t=am(gm,u,d),c.lastIndex=u.lastIndex,t;var h=l.groups,p=wm&&c.sticky,f=am(cm,c),m=c.source,g=0,v=d;if(p&&(f=ym(f,"y",""),-1===_m(f,"g")&&(f+="g"),v=Em(d,c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==vm(d,c.lastIndex-1))&&(m="(?: "+m+")",v=" "+v,g++),i=new RegExp("^(?:"+m+")",f)),Im&&(i=new RegExp("^"+m+"$(?!\\s)",f)),bm&&(r=c.lastIndex),n=am(mm,p?i:c,v),p?n?(n.input=Em(n.input,g),n[0]=Em(n[0],g),n.index=c.lastIndex,c.lastIndex+=n[0].length):c.lastIndex=0:bm&&n&&(c.lastIndex=c.global?n.index+n[0].length:r),Im&&n&&n.length>1&&am(fm,n[0],i,function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(n[a]=void 0)}),n&&h)for(n.groups=o=dm(null),a=0;a<h.length;a++)o[(s=h[a])[0]]=n[s[1]];return n});var Tm=gm;en({target:"RegExp",proto:!0,forced:/./.exec!==Tm},{exec:Tm});var Sm=mn,Am=Zp,Rm=Qp;a&&!Am.correct&&(Sm(RegExp.prototype,"flags",{configurable:!0,get:Rm}),Am.correct=!0);var km=ir,Cm=hn,Dm=P,Om=RangeError,Lm=b,Nm=lr,Pm=hn,xm=P,Mm=Lm(function(e){var t=Cm(Dm(this)),i="",r=km(e);if(r<0||Infinity===r)throw new Om("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(i+=t);return i}),Um=Lm("".slice),Fm=Math.ceil,Bm=function(e){return function(t,i,r){var n,a,o=Pm(xm(t)),s=Nm(i),c=o.length,l=void 0===r?" ":Pm(r);return s<=c||""===l?o:((a=Mm(l,Fm((n=s-c)/l.length))).length>n&&(a=Um(a,0,n)),e?o+a:a+o)}},Vm={start:Bm(!1),end:Bm(!0)},Hm=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(Y),jm=Vm.start;en({target:"String",proto:!0,forced:Hm},{padStart:function(e){return jm(this,e,arguments.length>1?arguments[1]:void 0)}});var zm=l,Wm=Ji,Gm=Tm,qm=n,Km=tt,Ym=Kt,Xm=Km("species"),Zm=RegExp.prototype,Jm=b,Qm=ir,$m=hn,eg=P,tg=Jm("".charAt),ig=Jm("".charCodeAt),rg=Jm("".slice),ng=function(e){return function(t,i){var r,n,a=$m(eg(t)),o=Qm(i),s=a.length;return o<0||o>=s?e?"":void 0:(r=ig(a,o))<55296||r>56319||o+1===s||(n=ig(a,o+1))<56320||n>57343?e?tg(a,o):r:e?rg(a,o,o+2):n-56320+(r-55296<<10)+65536}},ag={codeAt:ng(!1),charAt:ng(!0)},og=ag.charAt,sg=b,cg=Fe,lg=Math.floor,dg=sg("".charAt),ug=sg("".replace),hg=sg("".slice),pg=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,fg=/\$([$&'`]|\d{1,2})/g,mg=function(e,t,i,r,n,a){var o=i+e.length,s=r.length,c=fg;return void 0!==n&&(n=cg(n),c=pg),ug(a,c,function(a,c){var l;switch(dg(c,0)){case"$":return"$";case"&":return e;case"`":return hg(t,0,i);case"'":return hg(t,o);case"<":l=n[hg(c,1,-1)];break;default:var d=+c;if(0===d)return a;if(d>s){var u=lg(d/10);return 0===u?a:u<=s?void 0===r[u-1]?dg(c,1):r[u-1]+dg(c,1):a}l=r[d-1]}return void 0===l?"":l})},gg=l,vg=Nt,_g=B,yg=S,Eg=Tm,bg=TypeError,wg=Gl,Ig=l,Tg=b,Sg=function(e,t,i,r){var n=Km(e),a=!qm(function(){var t={};return t[n]=function(){return 7},7!==""[e](t)}),o=a&&!qm(function(){var t=!1,i=/a/;if("split"===e){var r={};r[Xm]=function(){return i},(i={constructor:r,flags:""})[n]=/./[n]}return i.exec=function(){return t=!0,null},i[n](""),!t});if(!a||!o||i){var s=/./[n],c=t(n,""[e],function(e,t,i,r,n){var o=t.exec;return o===Gm||o===Zm.exec?a&&!n?{done:!0,value:zm(s,t,i,r)}:{done:!0,value:zm(e,i,t,r)}:{done:!1}});Wm(String.prototype,e,c[0]),Wm(Zm,n,c[1])}r&&Ym(Zm[n],"sham",!0)},Ag=n,Rg=Nt,kg=B,Cg=H,Dg=ir,Og=lr,Lg=hn,Ng=P,Pg=function(e,t,i){return t+(i?og(e,t).length:1)},xg=Ee,Mg=mg,Ug=of,Fg=function(e,t){var i=e.exec;if(_g(i)){var r=gg(i,e,t);return null!==r&&vg(r),r}if("RegExp"===yg(e))return gg(Eg,e,t);throw new bg("RegExp#exec called on incompatible receiver")},Bg=tt("replace"),Vg=Math.max,Hg=Math.min,jg=Tg([].concat),zg=Tg([].push),Wg=Tg("".indexOf),Gg=Tg("".slice),qg=function(e){return void 0===e?e:String(e)},Kg="$0"==="a".replace(/./,"$0"),Yg=!!/./[Bg]&&""===/./[Bg]("a","$0");Sg("replace",function(e,t,i){var r=Yg?"$":"$0";return[function(e,i){var r=Ng(this),n=Cg(e)?xg(e,Bg):void 0;return n?Ig(n,e,r,i):Ig(t,Lg(r),e,i)},function(e,n){var a=Rg(this),o=Lg(e);if("string"==typeof n&&-1===Wg(n,r)&&-1===Wg(n,"$<")){var s=i(t,a,o,n);if(s.done)return s.value}var c=kg(n);c||(n=Lg(n));var l,d=Lg(Ug(a)),u=-1!==Wg(d,"g");u&&(l=-1!==Wg(d,"u"),a.lastIndex=0);for(var h,p=[];null!==(h=Fg(a,o))&&(zg(p,h),u);){""===Lg(h[0])&&(a.lastIndex=Pg(o,Og(a.lastIndex),l))}for(var f="",m=0,g=0;g<p.length;g++){for(var v,_=Lg((h=p[g])[0]),y=Vg(Hg(Dg(h.index),o.length),0),E=[],b=1;b<h.length;b++)zg(E,qg(h[b]));var w=h.groups;if(c){var I=jg([_],E,y,o);void 0!==w&&zg(I,w),v=Lg(wg(n,void 0,I))}else v=Mg(_,o,y,E,w,n);y>=m&&(f+=Gg(o,m,y)+v,m=y+_.length)}return f+Gg(o,m)}]},!!Ag(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})||!Kg||Yg);var Xg="\t\n\v\f\r                　\u2028\u2029\ufeff",Zg=P,Jg=hn,Qg=Xg,$g=b("".replace),ev=RegExp("^["+Qg+"]+"),tv=RegExp("(^|[^"+Qg+"])["+Qg+"]+$"),iv=function(e){return function(t){var i=Jg(Zg(t));return 1&e&&(i=$g(i,ev,"")),2&e&&(i=$g(i,tv,"$1")),i}},rv={start:iv(1),end:iv(2),trim:iv(3)},nv=ei.PROPER,av=n,ov=Xg,sv=rv.trim;en({target:"String",proto:!0,forced:function(e){return av(function(){return!!ov[e]()||"​᠎"!=="​᠎"[e]()||nv&&ov[e].name!==e})}("trim")},{trim:function(){return sv(this)}});var cv,lv,dv,uv={exports:{}},hv=ds,pv=a,fv=i,mv=B,gv=H,vv=He,_v=ln,yv=pe,Ev=Kt,bv=Ji,wv=mn,Iv=G,Tv=Ra,Sv=no,Av=tt,Rv=qe,kv=ki.enforce,Cv=ki.get,Dv=fv.Int8Array,Ov=Dv&&Dv.prototype,Lv=fv.Uint8ClampedArray,Nv=Lv&&Lv.prototype,Pv=Dv&&Tv(Dv),xv=Ov&&Tv(Ov),Mv=Object.prototype,Uv=fv.TypeError,Fv=Av("toStringTag"),Bv=Rv("TYPED_ARRAY_TAG"),Vv="TypedArrayConstructor",Hv=hv&&!!Sv&&"Opera"!==_v(fv.opera),jv=!1,zv={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Wv={BigInt64Array:8,BigUint64Array:8},Gv=function(e){var t=Tv(e);if(gv(t)){var i=Cv(t);return i&&vv(i,Vv)?i[Vv]:Gv(t)}},qv=function(e){if(!gv(e))return!1;var t=_v(e);return vv(zv,t)||vv(Wv,t)};for(cv in zv)(dv=(lv=fv[cv])&&lv.prototype)?kv(dv)[Vv]=lv:Hv=!1;for(cv in Wv)(dv=(lv=fv[cv])&&lv.prototype)&&(kv(dv)[Vv]=lv);if((!Hv||!mv(Pv)||Pv===Function.prototype)&&(Pv=function(){throw new Uv("Incorrect invocation")},Hv))for(cv in zv)fv[cv]&&Sv(fv[cv],Pv);if((!Hv||!xv||xv===Mv)&&(xv=Pv.prototype,Hv))for(cv in zv)fv[cv]&&Sv(fv[cv].prototype,xv);if(Hv&&Tv(Nv)!==xv&&Sv(Nv,xv),pv&&!vv(xv,Fv))for(cv in jv=!0,wv(xv,Fv,{configurable:!0,get:function(){return gv(this)?this[Bv]:void 0}}),zv)fv[cv]&&Ev(fv[cv],Bv,cv);var Kv={NATIVE_ARRAY_BUFFER_VIEWS:Hv,TYPED_ARRAY_TAG:jv&&Bv,aTypedArray:function(e){if(qv(e))return e;throw new Uv("Target is not a typed array")},aTypedArrayConstructor:function(e){if(mv(e)&&(!Sv||Iv(Pv,e)))return e;throw new Uv(yv(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,i,r){if(pv){if(i)for(var n in zv){var a=fv[n];if(a&&vv(a.prototype,e))try{delete a.prototype[e]}catch(VM){try{a.prototype[e]=t}catch(o){}}}xv[e]&&!i||bv(xv,e,i?t:Hv&&Ov[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,i){var r,n;if(pv){if(Sv){if(i)for(r in zv)if((n=fv[r])&&vv(n,e))try{delete n[e]}catch(VM){}if(Pv[e]&&!i)return;try{return bv(Pv,e,i?t:Hv&&Pv[e]||t)}catch(VM){}}for(r in zv)!(n=fv[r])||n[e]&&!i||bv(n,e,t)}},getTypedArrayConstructor:Gv,isView:function(e){if(!gv(e))return!1;var t=_v(e);return"DataView"===t||vv(zv,t)||vv(Wv,t)},isTypedArray:qv,TypedArray:Pv,TypedArrayPrototype:xv},Yv=i,Xv=n,Zv=np,Jv=Kv.NATIVE_ARRAY_BUFFER_VIEWS,Qv=Yv.ArrayBuffer,$v=Yv.Int8Array,e_=!Jv||!Xv(function(){$v(1)})||!Xv(function(){new $v(-1)})||!Zv(function(e){new $v,new $v(null),new $v(1.5),new $v(e)},!0)||Xv(function(){return 1!==new $v(new Qv(2),1,void 0).length}),t_=H,i_=Math.floor,r_=Number.isInteger||function(e){return!t_(e)&&isFinite(e)&&i_(e)===e},n_=ir,a_=RangeError,o_=function(e){var t=n_(e);if(t<0)throw new a_("The argument can't be less than 0");return t},s_=RangeError,c_=function(e,t){var i=o_(e);if(i%t)throw new s_("Wrong offset");return i},l_=Math.round,d_=ln,u_=lt,h_=TypeError,p_=function(e){var t=u_(e,"number");if("number"==typeof t)throw new h_("Can't convert number to bigint");return BigInt(t)},f_=Xl,m_=l,g_=xl,v_=Fe,__=ur,y_=xh,E_=kh,b_=wh,w_=function(e){var t=d_(e);return"BigInt64Array"===t||"BigUint64Array"===t},I_=Kv.aTypedArrayConstructor,T_=p_,S_=function(e){var t,i,r,n,a,o,s,c,l=g_(this),d=v_(e),u=arguments.length,h=u>1?arguments[1]:void 0,p=void 0!==h,f=E_(d);if(f&&!b_(f))for(c=(s=y_(d,f)).next,d=[];!(o=m_(c,s)).done;)d.push(o.value);for(p&&u>2&&(h=f_(h,arguments[2])),i=__(d),r=new(I_(l))(i),n=w_(r),t=0;i>t;t++)a=p?h(d[t],t):d[t],r[t]=n?T_(a):+a;return r},A_=as,R_=Ol,k_=H,C_=tt("species"),D_=Array,O_=function(e){var t;return A_(e)&&(t=e.constructor,(R_(t)&&(t===D_||A_(t.prototype))||k_(t)&&null===(t=t[C_]))&&(t=void 0)),void 0===t?D_:t},L_=Xl,N_=D,P_=Fe,x_=ur,M_=function(e,t){return new(O_(e))(0===t?0:t)},U_=b([].push),F_=function(e){var t=1===e,i=2===e,r=3===e,n=4===e,a=6===e,o=7===e,s=5===e||a;return function(c,l,d,u){for(var h,p,f=P_(c),m=N_(f),g=x_(m),v=L_(l,d),_=0,y=u||M_,E=t?y(c,g):i||o?y(c,0):void 0;g>_;_++)if((s||_ in m)&&(p=v(h=m[_],_,f),e))if(t)E[_]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return _;case 2:U_(E,h)}else switch(e){case 4:return!1;case 7:U_(E,h)}return a?-1:r||n?n:E}},B_={forEach:F_(0),map:F_(1),filter:F_(2),some:F_(3),every:F_(4),find:F_(5),findIndex:F_(6),filterReject:F_(7)},V_=ur,H_=en,j_=i,z_=l,W_=a,G_=e_,q_=Kv,K_=Wc,Y_=ms,X_=g,Z_=Kt,J_=r_,Q_=lr,$_=ys,ey=c_,ty=function(e){var t=l_(e);return t<0?0:t>255?255:255&t},iy=ht,ry=He,ny=ln,ay=H,oy=ue,sy=oa,cy=G,ly=no,dy=Qi.f,uy=S_,hy=B_.forEach,py=Xc,fy=mn,my=kt,gy=r,vy=function(e,t,i){for(var r=0,n=arguments.length>2?i:V_(t),a=new e(n);n>r;)a[r]=t[r++];return a},_y=js,yy=ki.get,Ey=ki.set,by=ki.enforce,wy=my.f,Iy=gy.f,Ty=j_.RangeError,Sy=K_.ArrayBuffer,Ay=Sy.prototype,Ry=K_.DataView,ky=q_.NATIVE_ARRAY_BUFFER_VIEWS,Cy=q_.TYPED_ARRAY_TAG,Dy=q_.TypedArray,Oy=q_.TypedArrayPrototype,Ly=q_.isTypedArray,Ny="BYTES_PER_ELEMENT",Py="Wrong length",xy=function(e,t){fy(e,t,{configurable:!0,get:function(){return yy(this)[t]}})},My=function(e){var t;return cy(Ay,e)||"ArrayBuffer"===(t=ny(e))||"SharedArrayBuffer"===t},Uy=function(e,t){return Ly(e)&&!oy(t)&&t in e&&J_(+t)&&t>=0},Fy=function(e,t){return t=iy(t),Uy(e,t)?X_(2,e[t]):Iy(e,t)},By=function(e,t,i){return t=iy(t),!(Uy(e,t)&&ay(i)&&ry(i,"value"))||ry(i,"get")||ry(i,"set")||i.configurable||ry(i,"writable")&&!i.writable||ry(i,"enumerable")&&!i.enumerable?wy(e,t,i):(e[t]=i.value,e)};W_?(ky||(gy.f=Fy,my.f=By,xy(Oy,"buffer"),xy(Oy,"byteOffset"),xy(Oy,"byteLength"),xy(Oy,"length")),H_({target:"Object",stat:!0,forced:!ky},{getOwnPropertyDescriptor:Fy,defineProperty:By}),uv.exports=function(e,t,i){var r=e.match(/\d+/)[0]/8,n=e+(i?"Clamped":"")+"Array",a="get"+e,o="set"+e,s=j_[n],c=s,l=c&&c.prototype,d={},u=function(e,t){wy(e,t,{get:function(){return function(e,t){var i=yy(e);return i.view[a](t*r+i.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var a=yy(e);a.view[o](t*r+a.byteOffset,i?ty(n):n,!0)}(this,t,e)},enumerable:!0})};ky?G_&&(c=t(function(e,t,i,n){return Y_(e,l),_y(ay(t)?My(t)?void 0!==n?new s(t,ey(i,r),n):void 0!==i?new s(t,ey(i,r)):new s(t):Ly(t)?vy(c,t):z_(uy,c,t):new s($_(t)),e,c)}),ly&&ly(c,Dy),hy(dy(s),function(e){e in c||Z_(c,e,s[e])}),c.prototype=l):(c=t(function(e,t,i,n){Y_(e,l);var a,o,s,d=0,h=0;if(ay(t)){if(!My(t))return Ly(t)?vy(c,t):z_(uy,c,t);a=t,h=ey(i,r);var p=t.byteLength;if(void 0===n){if(p%r)throw new Ty(Py);if((o=p-h)<0)throw new Ty(Py)}else if((o=Q_(n)*r)+h>p)throw new Ty(Py);s=o/r}else s=$_(t),a=new Sy(o=s*r);for(Ey(e,{buffer:a,byteOffset:h,byteLength:o,length:s,view:new Ry(a)});d<s;)u(e,d++)}),ly&&ly(c,Dy),l=c.prototype=sy(Oy)),l.constructor!==c&&Z_(l,"constructor",c),by(l).TypedArrayConstructor=c,Cy&&Z_(l,Cy,n);var h=c!==s;d[n]=c,H_({global:!0,constructor:!0,forced:h,sham:!ky},d),Ny in c||Z_(c,Ny,r),Ny in l||Z_(l,Ny,r),py(n)}):uv.exports=function(){};var Vy=uv.exports;Vy("Float32",function(e){return function(t,i,r){return e(this,t,i,r)}}),Vy("Int32",function(e){return function(t,i,r){return e(this,t,i,r)}}),Vy("Uint8",function(e){return function(t,i,r){return e(this,t,i,r)}}),Vy("Uint16",function(e){return function(t,i,r){return e(this,t,i,r)}}),Vy("Uint32",function(e){return function(t,i,r){return e(this,t,i,r)}});var Hy=Us,jy=p_,zy=ln,Wy=l,Gy=n,qy=Kv.aTypedArray,Ky=Kv.exportTypedArrayMethod,Yy=b("".slice);Ky("fill",function(e){var t=arguments.length;qy(this);var i="Big"===Yy(zy(this),0,3)?jy(e):+e;return Wy(Hy,this,i,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)},Gy(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e})),(0,Kv.exportTypedArrayStaticMethod)("from",S_,e_);var Xy=i,Zy=l,Jy=Kv,Qy=ur,$y=c_,eE=Fe,tE=n,iE=Xy.RangeError,rE=Xy.Int8Array,nE=rE&&rE.prototype,aE=nE&&nE.set,oE=Jy.aTypedArray,sE=Jy.exportTypedArrayMethod,cE=!tE(function(){var e=new Uint8ClampedArray(2);return Zy(aE,e,{length:1,0:3},1),3!==e[1]}),lE=cE&&Jy.NATIVE_ARRAY_BUFFER_VIEWS&&tE(function(){var e=new rE(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]});sE("set",function(e){oE(this);var t=$y(arguments.length>1?arguments[1]:void 0,1),i=eE(e);if(cE)return Zy(aE,this,i,t);var r=this.length,n=Qy(i),a=0;if(n+t>r)throw new iE("Wrong length");for(;a<n;)this[t+a]=i[a++]},!cE||lE);var dE=Fs,uE=Math.floor,hE=function(e,t){var i=e.length;if(i<8)for(var r,n,a=1;a<i;){for(n=a,r=e[a];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==a++&&(e[n]=r)}else for(var o=uE(i/2),s=hE(dE(e,0,o),t),c=hE(dE(e,o),t),l=s.length,d=c.length,u=0,h=0;u<l||h<d;)e[u+h]=u<l&&h<d?t(s[u],c[h])<=0?s[u++]:c[h++]:u<l?s[u++]:c[h++];return e},pE=hE,fE=Y.match(/firefox\/(\d+)/i),mE=!!fE&&+fE[1],gE=/MSIE|Trident/.test(Y),vE=Y.match(/AppleWebKit\/(\d+)\./),_E=!!vE&&+vE[1],yE=tl,EE=n,bE=ve,wE=pE,IE=mE,TE=gE,SE=te,AE=_E,RE=Kv.aTypedArray,kE=Kv.exportTypedArrayMethod,CE=i.Uint16Array,DE=CE&&yE(CE.prototype.sort),OE=!(!DE||EE(function(){DE(new CE(2),null)})&&EE(function(){DE(new CE(2),{})})),LE=!!DE&&!EE(function(){if(SE)return SE<74;if(IE)return IE<67;if(TE)return!0;if(AE)return AE<602;var e,t,i=new CE(516),r=Array(516);for(e=0;e<516;e++)t=e%4,i[e]=515-e,r[e]=e-2*t+3;for(DE(i,function(e,t){return(e/4|0)-(t/4|0)}),e=0;e<516;e++)if(i[e]!==r[e])return!0});kE("sort",function(e){return void 0!==e&&bE(e),LE?DE(this,e):wE(RE(this),function(e){return function(t,i){return void 0!==e?+e(t,i)||0:i!=i?-1:t!=t?1:0===t&&0===i?1/t>0&&1/i<0?1:-1:t>i}}(e))},!LE||OE);var NE=en,PE=l,xE=b,ME=P,UE=B,FE=H,BE=qp,VE=hn,HE=Ee,jE=of,zE=mg,WE=tt("replace"),GE=TypeError,qE=xE("".indexOf);xE("".replace);var KE=xE("".slice),YE=Math.max;NE({target:"String",proto:!0},{replaceAll:function(e,t){var i,r,n,a,o,s,c,l,d,u=ME(this),h=0,p="";if(FE(e)){if(BE(e)&&(i=VE(ME(jE(e))),!~qE(i,"g")))throw new GE("`.replaceAll` does not allow non-global regexes");if(r=HE(e,WE))return PE(r,e,u,t)}for(n=VE(u),a=VE(e),(o=UE(t))||(t=VE(t)),s=a.length,c=YE(1,s),l=qE(n,a);-1!==l;)d=o?VE(t(a,l,n)):zE(a,n,l,[],void 0,t),p+=KE(n,h,l)+d,h=l+s,l=l+c>n.length?-1:qE(n,a,l+c);return h<n.length&&(p+=KE(n,h)),p}});var XE={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},ZE=gt("span").classList,JE=ZE&&ZE.constructor&&ZE.constructor.prototype,QE=JE===Object.prototype?void 0:JE,$E=B_.forEach,eb=Xo("forEach")?[].forEach:function(e){return $E(this,e,arguments.length>1?arguments[1]:void 0)},tb=i,ib=XE,rb=QE,nb=eb,ab=Kt,ob=function(e){if(e&&e.forEach!==nb)try{ab(e,"forEach",nb)}catch(VM){e.forEach=nb}};for(var sb in ib)ib[sb]&&ob(tb[sb]&&tb[sb].prototype);ob(rb);var cb=i,lb=XE,db=QE,ub=Fo,hb=Kt,pb=Va,fb=tt("iterator"),mb=ub.values,gb=function(e,t){if(e){if(e[fb]!==mb)try{hb(e,fb,mb)}catch(VM){e[fb]=mb}if(pb(e,t,!0),lb[t])for(var i in ub)if(e[i]!==ub[i])try{hb(e,i,ub[i])}catch(VM){e[i]=ub[i]}}};for(var vb in lb)gb(cb[vb]&&cb[vb].prototype,vb);gb(db,"DOMTokenList");var _b=Sd.clear;en({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==_b},{clearImmediate:_b});var yb=i,Eb=Gl,bb=B,wb=es,Ib=Y,Tb=Fs,Sb=Jl,Ab=yb.Function,Rb=/MSIE .\./.test(Ib)||"BUN"===wb&&function(){var e=yb.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),kb=en,Cb=i,Db=Sd.set,Ob=function(e,t){var i=t?2:1;return Rb?function(r,n){var a=Sb(arguments.length,1)>i,o=bb(r)?r:Ab(r),s=a?Tb(arguments,i):[],c=a?function(){Eb(o,this,s)}:o;return t?e(c,n):e(c)}:e},Lb=Cb.setImmediate?Ob(Db,!1):Db;kb({global:!0,bind:!0,enumerable:!0,forced:Cb.setImmediate!==Lb},{setImmediate:Lb});var Nb=ag.charAt,Pb=hn,xb=ki,Mb=So,Ub=Ao,Fb="String Iterator",Bb=xb.set,Vb=xb.getterFor(Fb);Mb(String,"String",function(e){Bb(this,{type:Fb,string:Pb(e),index:0})},function(){var e,t=Vb(this),i=t.string,r=t.index;return r>=i.length?Ub(void 0,!0):(e=Nb(i,r),t.index+=e.length,Ub(e,!1))});var Hb=n,jb=a,zb=tt("iterator"),Wb=!Hb(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,i=new URLSearchParams("a=1&a=2&b=3"),r="";return e.pathname="c%20d",t.forEach(function(e,i){t.delete("b"),r+=i+e}),i.delete("a",2),i.delete("b",void 0),!t.size&&!jb||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[zb]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://тест").host||"#%D0%B1"!==new URL("https://a#б").hash||"a1c3"!==r||"x"!==new URL("https://x",void 0).host}),Gb=a,qb=b,Kb=l,Yb=n,Xb=Fn,Zb=Ar,Jb=d,Qb=Fe,$b=D,ew=Object.assign,tw=Object.defineProperty,iw=qb([].concat),rw=!ew||Yb(function(){if(Gb&&1!==ew({b:1},ew(tw({},"a",{enumerable:!0,get:function(){tw(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},i=Symbol("assign detection"),r="abcdefghijklmnopqrst";return e[i]=7,r.split("").forEach(function(e){t[e]=e}),7!==ew({},e)[i]||Xb(ew({},t)).join("")!==r})?function(e,t){for(var i=Qb(e),r=arguments.length,n=1,a=Zb.f,o=Jb.f;r>n;)for(var s,c=$b(arguments[n++]),l=a?iw(Xb(c),a(c)):Xb(c),d=l.length,u=0;d>u;)s=l[u++],Gb&&!Kb(o,c,s)||(i[s]=c[s]);return i}:ew,nw=Nt,aw=Bh,ow=a,sw=kt,cw=g,lw=Xl,dw=l,uw=Fe,hw=function(e,t,i,r){try{return r?t(nw(i)[0],i[1]):t(i)}catch(VM){aw(e,"throw",VM)}},pw=wh,fw=Ol,mw=ur,gw=function(e,t,i){ow?sw.f(e,t,cw(0,i)):e[t]=i},vw=xh,_w=kh,yw=Array,Ew=b,bw=2147483647,ww=/[^\0-\u007E]/,Iw=/[.\u3002\uFF0E\uFF61]/g,Tw="Overflow: input needs wider integers to process",Sw=RangeError,Aw=Ew(Iw.exec),Rw=Math.floor,kw=String.fromCharCode,Cw=Ew("".charCodeAt),Dw=Ew([].join),Ow=Ew([].push),Lw=Ew("".replace),Nw=Ew("".split),Pw=Ew("".toLowerCase),xw=function(e){return e+22+75*(e<26)},Mw=function(e,t,i){var r=0;for(e=i?Rw(e/700):e>>1,e+=Rw(e/t);e>455;)e=Rw(e/35),r+=36;return Rw(r+36*e/(e+38))},Uw=function(e){var t=[];e=function(e){for(var t=[],i=0,r=e.length;i<r;){var n=Cw(e,i++);if(n>=55296&&n<=56319&&i<r){var a=Cw(e,i++);56320==(64512&a)?Ow(t,((1023&n)<<10)+(1023&a)+65536):(Ow(t,n),i--)}else Ow(t,n)}return t}(e);var i,r,n=e.length,a=128,o=0,s=72;for(i=0;i<e.length;i++)(r=e[i])<128&&Ow(t,kw(r));var c=t.length,l=c;for(c&&Ow(t,"-");l<n;){var d=bw;for(i=0;i<e.length;i++)(r=e[i])>=a&&r<d&&(d=r);var u=l+1;if(d-a>Rw((bw-o)/u))throw new Sw(Tw);for(o+=(d-a)*u,a=d,i=0;i<e.length;i++){if((r=e[i])<a&&++o>bw)throw new Sw(Tw);if(r===a){for(var h=o,p=36;;){var f=p<=s?1:p>=s+26?26:p-s;if(h<f)break;var m=h-f,g=36-f;Ow(t,kw(xw(f+m%g))),h=Rw(m/g),p+=36}Ow(t,kw(xw(h))),s=Mw(o,u,l===c),o=0,l++}}o++,a++}return Dw(t,"")},Fw=en,Bw=b,Vw=or,Hw=RangeError,jw=String.fromCharCode,zw=String.fromCodePoint,Ww=Bw([].join);Fw({target:"String",stat:!0,arity:1,forced:!!zw&&1!==zw.length},{fromCodePoint:function(e){for(var t,i=[],r=arguments.length,n=0;r>n;){if(t=+arguments[n++],Vw(t,1114111)!==t)throw new Hw(t+" is not a valid code point");i[n]=t<65536?jw(t):jw(55296+((t-=65536)>>10),t%1024+56320)}return Ww(i,"")}});var Gw=en,qw=i,Kw=Cd,Yw=W,Xw=l,Zw=b,Jw=a,Qw=Wb,$w=Ji,eI=mn,tI=hs,iI=Va,rI=Ka,nI=ki,aI=ms,oI=B,sI=He,cI=Xl,lI=ln,dI=Nt,uI=H,hI=hn,pI=oa,fI=g,mI=xh,gI=kh,vI=Ao,_I=Jl,yI=pE,EI=tt("iterator"),bI="URLSearchParams",wI=bI+"Iterator",II=nI.set,TI=nI.getterFor(bI),SI=nI.getterFor(wI),AI=Kw("fetch"),RI=Kw("Request"),kI=Kw("Headers"),CI=RI&&RI.prototype,DI=kI&&kI.prototype,OI=qw.TypeError,LI=qw.encodeURIComponent,NI=String.fromCharCode,PI=Yw("String","fromCodePoint"),xI=parseInt,MI=Zw("".charAt),UI=Zw([].join),FI=Zw([].push),BI=Zw("".replace),VI=Zw([].shift),HI=Zw([].splice),jI=Zw("".split),zI=Zw("".slice),WI=Zw(/./.exec),GI=/\+/g,qI=/^[0-9a-f]+$/i,KI=function(e,t){var i=zI(e,t,t+2);return WI(qI,i)?xI(i,16):NaN},YI=function(e){for(var t=0,i=128;i>0&&0!==(e&i);i>>=1)t++;return t},XI=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},ZI=function(e){for(var t=(e=BI(e,GI," ")).length,i="",r=0;r<t;){var n=MI(e,r);if("%"===n){if("%"===MI(e,r+1)||r+3>t){i+="%",r++;continue}var a=KI(e,r+1);if(a!=a){i+=n,r++;continue}r+=2;var o=YI(a);if(0===o)n=NI(a);else{if(1===o||o>4){i+="�",r++;continue}for(var s=[a],c=1;c<o&&!(++r+3>t||"%"!==MI(e,r));){var l=KI(e,r+1);if(l!=l){r+=3;break}if(l>191||l<128)break;FI(s,l),r+=2,c++}if(s.length!==o){i+="�";continue}var d=XI(s);null===d?i+="�":n=PI(d)}}i+=n,r++}return i},JI=/[!'()~]|%20/g,QI={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},$I=function(e){return QI[e]},eT=function(e){return BI(LI(e),JI,$I)},tT=rI(function(e,t){II(this,{type:wI,target:TI(e).entries,index:0,kind:t})},bI,function(){var e=SI(this),t=e.target,i=e.index++;if(!t||i>=t.length)return e.target=null,vI(void 0,!0);var r=t[i];switch(e.kind){case"keys":return vI(r.key,!1);case"values":return vI(r.value,!1)}return vI([r.key,r.value],!1)},!0),iT=function(e){this.entries=[],this.url=null,void 0!==e&&(uI(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===MI(e,0)?zI(e,1):e:hI(e)))};iT.prototype={type:bI,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,i,r,n,a,o,s,c=this.entries,l=gI(e);if(l)for(i=(t=mI(e,l)).next;!(r=Xw(i,t)).done;){if(a=(n=mI(dI(r.value))).next,(o=Xw(a,n)).done||(s=Xw(a,n)).done||!Xw(a,n).done)throw new OI("Expected sequence with length 2");FI(c,{key:hI(o.value),value:hI(s.value)})}else for(var d in e)sI(e,d)&&FI(c,{key:d,value:hI(e[d])})},parseQuery:function(e){if(e)for(var t,i,r=this.entries,n=jI(e,"&"),a=0;a<n.length;)(t=n[a++]).length&&(i=jI(t,"="),FI(r,{key:ZI(VI(i)),value:ZI(UI(i,"="))}))},serialize:function(){for(var e,t=this.entries,i=[],r=0;r<t.length;)e=t[r++],FI(i,eT(e.key)+"="+eT(e.value));return UI(i,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var rT=function(){aI(this,nT);var e=II(this,new iT(arguments.length>0?arguments[0]:void 0));Jw||(this.size=e.entries.length)},nT=rT.prototype;if(tI(nT,{append:function(e,t){var i=TI(this);_I(arguments.length,2),FI(i.entries,{key:hI(e),value:hI(t)}),Jw||this.size++,i.updateURL()},delete:function(e){for(var t=TI(this),i=_I(arguments.length,1),r=t.entries,n=hI(e),a=i<2?void 0:arguments[1],o=void 0===a?a:hI(a),s=0;s<r.length;){var c=r[s];if(c.key!==n||void 0!==o&&c.value!==o)s++;else if(HI(r,s,1),void 0!==o)break}Jw||(this.size=r.length),t.updateURL()},get:function(e){var t=TI(this).entries;_I(arguments.length,1);for(var i=hI(e),r=0;r<t.length;r++)if(t[r].key===i)return t[r].value;return null},getAll:function(e){var t=TI(this).entries;_I(arguments.length,1);for(var i=hI(e),r=[],n=0;n<t.length;n++)t[n].key===i&&FI(r,t[n].value);return r},has:function(e){for(var t=TI(this).entries,i=_I(arguments.length,1),r=hI(e),n=i<2?void 0:arguments[1],a=void 0===n?n:hI(n),o=0;o<t.length;){var s=t[o++];if(s.key===r&&(void 0===a||s.value===a))return!0}return!1},set:function(e,t){var i=TI(this);_I(arguments.length,1);for(var r,n=i.entries,a=!1,o=hI(e),s=hI(t),c=0;c<n.length;c++)(r=n[c]).key===o&&(a?HI(n,c--,1):(a=!0,r.value=s));a||FI(n,{key:o,value:s}),Jw||(this.size=n.length),i.updateURL()},sort:function(){var e=TI(this);yI(e.entries,function(e,t){return e.key>t.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,i=TI(this).entries,r=cI(e,arguments.length>1?arguments[1]:void 0),n=0;n<i.length;)r((t=i[n++]).value,t.key,this)},keys:function(){return new tT(this,"keys")},values:function(){return new tT(this,"values")},entries:function(){return new tT(this,"entries")}},{enumerable:!0}),$w(nT,EI,nT.entries,{name:"entries"}),$w(nT,"toString",function(){return TI(this).serialize()},{enumerable:!0}),Jw&&eI(nT,"size",{get:function(){return TI(this).entries.length},configurable:!0,enumerable:!0}),iI(rT,bI),Gw({global:!0,constructor:!0,forced:!Qw},{URLSearchParams:rT}),!Qw&&oI(kI)){var aT=Zw(DI.has),oT=Zw(DI.set),sT=function(e){if(uI(e)){var t,i=e.body;if(lI(i)===bI)return t=e.headers?new kI(e.headers):new kI,aT(t,"content-type")||oT(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),pI(e,{body:fI(0,hI(i)),headers:fI(0,t)})}return e};if(oI(AI)&&Gw({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return AI(e,arguments.length>1?sT(arguments[1]):{})}}),oI(RI)){var cT=function(e){return aI(this,CI),new RI(e,arguments.length>1?sT(arguments[1]):{})};CI.constructor=cT,cT.prototype=CI,Gw({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:cT})}}var lT,dT=en,uT=a,hT=Wb,pT=i,fT=Xl,mT=b,gT=Ji,vT=mn,_T=ms,yT=He,ET=rw,bT=function(e){var t=uw(e),i=fw(this),r=arguments.length,n=r>1?arguments[1]:void 0,a=void 0!==n;a&&(n=lw(n,r>2?arguments[2]:void 0));var o,s,c,l,d,u,h=_w(t),p=0;if(!h||this===yw&&pw(h))for(o=mw(t),s=i?new this(o):yw(o);o>p;p++)u=a?n(t[p],p):t[p],gw(s,p,u);else for(s=i?new this:[],d=(l=vw(t,h)).next;!(c=dw(d,l)).done;p++)u=a?hw(l,n,[c.value,p],!0):c.value,gw(s,p,u);return s.length=p,s},wT=Fs,IT=ag.codeAt,TT=function(e){var t,i,r=[],n=Nw(Lw(Pw(e),Iw,"."),".");for(t=0;t<n.length;t++)i=n[t],Ow(r,Aw(ww,i)?"xn--"+Uw(i):i);return Dw(r,".")},ST=hn,AT=Va,RT=Jl,kT={URLSearchParams:rT,getState:TI},CT=ki,DT=CT.set,OT=CT.getterFor("URL"),LT=kT.URLSearchParams,NT=kT.getState,PT=pT.URL,xT=pT.TypeError,MT=pT.parseInt,UT=Math.floor,FT=Math.pow,BT=mT("".charAt),VT=mT(/./.exec),HT=mT([].join),jT=mT(1.1.toString),zT=mT([].pop),WT=mT([].push),GT=mT("".replace),qT=mT([].shift),KT=mT("".split),YT=mT("".slice),XT=mT("".toLowerCase),ZT=mT([].unshift),JT="Invalid scheme",QT="Invalid host",$T="Invalid port",eS=/[a-z]/i,tS=/[\d+-.a-z]/i,iS=/\d/,rS=/^0x/i,nS=/^[0-7]+$/,aS=/^\d+$/,oS=/^[\da-f]+$/i,sS=/[\0\t\n\r #%/:<>?@[\\\]^|]/,cS=/[\0\t\n\r #/:<>?@[\\\]^|]/,lS=/^[\u0000-\u0020]+/,dS=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,uS=/[\t\n\r]/g,hS=function(e){var t,i,r,n;if("number"==typeof e){for(t=[],i=0;i<4;i++)ZT(t,e%256),e=UT(e/256);return HT(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,i=1,r=null,n=0,a=0;a<8;a++)0!==e[a]?(n>i&&(t=r,i=n),r=null,n=0):(null===r&&(r=a),++n);return n>i?r:t}(e),i=0;i<8;i++)n&&0===e[i]||(n&&(n=!1),r===i?(t+=i?":":"::",n=!0):(t+=jT(e[i],16),i<7&&(t+=":")));return"["+t+"]"}return e},pS={},fS=ET({},pS,{" ":1,'"':1,"<":1,">":1,"`":1}),mS=ET({},fS,{"#":1,"?":1,"{":1,"}":1}),gS=ET({},mS,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),vS=function(e,t){var i=IT(e,0);return i>32&&i<127&&!yT(t,e)?e:encodeURIComponent(e)},_S={ftp:21,file:null,http:80,https:443,ws:80,wss:443},yS=function(e,t){var i;return 2===e.length&&VT(eS,BT(e,0))&&(":"===(i=BT(e,1))||!t&&"|"===i)},ES=function(e){var t;return e.length>1&&yS(YT(e,0,2))&&(2===e.length||"/"===(t=BT(e,2))||"\\"===t||"?"===t||"#"===t)},bS=function(e){return"."===e||"%2e"===XT(e)},wS=function(e){return".."===(e=XT(e))||"%2e."===e||".%2e"===e||"%2e%2e"===e},IS={},TS={},SS={},AS={},RS={},kS={},CS={},DS={},OS={},LS={},NS={},PS={},xS={},MS={},US={},FS={},BS={},VS={},HS={},jS={},zS={},WS=function(e,t,i){var r,n,a,o=ST(e);if(t){if(n=this.parse(o))throw new xT(n);this.searchParams=null}else{if(void 0!==i&&(r=new WS(i,!0)),n=this.parse(o,null,r))throw new xT(n);(a=NT(new LT)).bindURL(this),this.searchParams=a}};WS.prototype={type:"URL",parse:function(e,t,i){var r,n,a,o,s=this,c=t||IS,l=0,d="",u=!1,h=!1,p=!1;for(e=ST(e),t||(s.scheme="",s.username="",s.password="",s.host=null,s.port=null,s.path=[],s.query=null,s.fragment=null,s.cannotBeABaseURL=!1,e=GT(e,lS,""),e=GT(e,dS,"$1")),e=GT(e,uS,""),r=bT(e);l<=r.length;){switch(n=r[l],c){case IS:if(!n||!VT(eS,n)){if(t)return JT;c=SS;continue}d+=XT(n),c=TS;break;case TS:if(n&&(VT(tS,n)||"+"===n||"-"===n||"."===n))d+=XT(n);else{if(":"!==n){if(t)return JT;d="",c=SS,l=0;continue}if(t&&(s.isSpecial()!==yT(_S,d)||"file"===d&&(s.includesCredentials()||null!==s.port)||"file"===s.scheme&&!s.host))return;if(s.scheme=d,t)return void(s.isSpecial()&&_S[s.scheme]===s.port&&(s.port=null));d="","file"===s.scheme?c=MS:s.isSpecial()&&i&&i.scheme===s.scheme?c=AS:s.isSpecial()?c=DS:"/"===r[l+1]?(c=RS,l++):(s.cannotBeABaseURL=!0,WT(s.path,""),c=HS)}break;case SS:if(!i||i.cannotBeABaseURL&&"#"!==n)return JT;if(i.cannotBeABaseURL&&"#"===n){s.scheme=i.scheme,s.path=wT(i.path),s.query=i.query,s.fragment="",s.cannotBeABaseURL=!0,c=zS;break}c="file"===i.scheme?MS:kS;continue;case AS:if("/"!==n||"/"!==r[l+1]){c=kS;continue}c=OS,l++;break;case RS:if("/"===n){c=LS;break}c=VS;continue;case kS:if(s.scheme=i.scheme,n===lT)s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,s.path=wT(i.path),s.query=i.query;else if("/"===n||"\\"===n&&s.isSpecial())c=CS;else if("?"===n)s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,s.path=wT(i.path),s.query="",c=jS;else{if("#"!==n){s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,s.path=wT(i.path),s.path.length--,c=VS;continue}s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,s.path=wT(i.path),s.query=i.query,s.fragment="",c=zS}break;case CS:if(!s.isSpecial()||"/"!==n&&"\\"!==n){if("/"!==n){s.username=i.username,s.password=i.password,s.host=i.host,s.port=i.port,c=VS;continue}c=LS}else c=OS;break;case DS:if(c=OS,"/"!==n||"/"!==BT(d,l+1))continue;l++;break;case OS:if("/"!==n&&"\\"!==n){c=LS;continue}break;case LS:if("@"===n){u&&(d="%40"+d),u=!0,a=bT(d);for(var f=0;f<a.length;f++){var m=a[f];if(":"!==m||p){var g=vS(m,gS);p?s.password+=g:s.username+=g}else p=!0}d=""}else if(n===lT||"/"===n||"?"===n||"#"===n||"\\"===n&&s.isSpecial()){if(u&&""===d)return"Invalid authority";l-=bT(d).length+1,d="",c=NS}else d+=n;break;case NS:case PS:if(t&&"file"===s.scheme){c=FS;continue}if(":"!==n||h){if(n===lT||"/"===n||"?"===n||"#"===n||"\\"===n&&s.isSpecial()){if(s.isSpecial()&&""===d)return QT;if(t&&""===d&&(s.includesCredentials()||null!==s.port))return;if(o=s.parseHost(d))return o;if(d="",c=BS,t)return;continue}"["===n?h=!0:"]"===n&&(h=!1),d+=n}else{if(""===d)return QT;if(o=s.parseHost(d))return o;if(d="",c=xS,t===PS)return}break;case xS:if(!VT(iS,n)){if(n===lT||"/"===n||"?"===n||"#"===n||"\\"===n&&s.isSpecial()||t){if(""!==d){var v=MT(d,10);if(v>65535)return $T;s.port=s.isSpecial()&&v===_S[s.scheme]?null:v,d=""}if(t)return;c=BS;continue}return $T}d+=n;break;case MS:if(s.scheme="file","/"===n||"\\"===n)c=US;else{if(!i||"file"!==i.scheme){c=VS;continue}switch(n){case lT:s.host=i.host,s.path=wT(i.path),s.query=i.query;break;case"?":s.host=i.host,s.path=wT(i.path),s.query="",c=jS;break;case"#":s.host=i.host,s.path=wT(i.path),s.query=i.query,s.fragment="",c=zS;break;default:ES(HT(wT(r,l),""))||(s.host=i.host,s.path=wT(i.path),s.shortenPath()),c=VS;continue}}break;case US:if("/"===n||"\\"===n){c=FS;break}i&&"file"===i.scheme&&!ES(HT(wT(r,l),""))&&(yS(i.path[0],!0)?WT(s.path,i.path[0]):s.host=i.host),c=VS;continue;case FS:if(n===lT||"/"===n||"\\"===n||"?"===n||"#"===n){if(!t&&yS(d))c=VS;else if(""===d){if(s.host="",t)return;c=BS}else{if(o=s.parseHost(d))return o;if("localhost"===s.host&&(s.host=""),t)return;d="",c=BS}continue}d+=n;break;case BS:if(s.isSpecial()){if(c=VS,"/"!==n&&"\\"!==n)continue}else if(t||"?"!==n)if(t||"#"!==n){if(n!==lT&&(c=VS,"/"!==n))continue}else s.fragment="",c=zS;else s.query="",c=jS;break;case VS:if(n===lT||"/"===n||"\\"===n&&s.isSpecial()||!t&&("?"===n||"#"===n)){if(wS(d)?(s.shortenPath(),"/"===n||"\\"===n&&s.isSpecial()||WT(s.path,"")):bS(d)?"/"===n||"\\"===n&&s.isSpecial()||WT(s.path,""):("file"===s.scheme&&!s.path.length&&yS(d)&&(s.host&&(s.host=""),d=BT(d,0)+":"),WT(s.path,d)),d="","file"===s.scheme&&(n===lT||"?"===n||"#"===n))for(;s.path.length>1&&""===s.path[0];)qT(s.path);"?"===n?(s.query="",c=jS):"#"===n&&(s.fragment="",c=zS)}else d+=vS(n,mS);break;case HS:"?"===n?(s.query="",c=jS):"#"===n?(s.fragment="",c=zS):n!==lT&&(s.path[0]+=vS(n,pS));break;case jS:t||"#"!==n?n!==lT&&("'"===n&&s.isSpecial()?s.query+="%27":s.query+="#"===n?"%23":vS(n,pS)):(s.fragment="",c=zS);break;case zS:n!==lT&&(s.fragment+=vS(n,fS))}l++}},parseHost:function(e){var t,i,r;if("["===BT(e,0)){if("]"!==BT(e,e.length-1))return QT;if(t=function(e){var t,i,r,n,a,o,s,c=[0,0,0,0,0,0,0,0],l=0,d=null,u=0,h=function(){return BT(e,u)};if(":"===h()){if(":"!==BT(e,1))return;u+=2,d=++l}for(;h();){if(8===l)return;if(":"!==h()){for(t=i=0;i<4&&VT(oS,h());)t=16*t+MT(h(),16),u++,i++;if("."===h()){if(0===i)return;if(u-=i,l>6)return;for(r=0;h();){if(n=null,r>0){if(!("."===h()&&r<4))return;u++}if(!VT(iS,h()))return;for(;VT(iS,h());){if(a=MT(h(),10),null===n)n=a;else{if(0===n)return;n=10*n+a}if(n>255)return;u++}c[l]=256*c[l]+n,2!==++r&&4!==r||l++}if(4!==r)return;break}if(":"===h()){if(u++,!h())return}else if(h())return;c[l++]=t}else{if(null!==d)return;u++,d=++l}}if(null!==d)for(o=l-d,l=7;0!==l&&o>0;)s=c[l],c[l--]=c[d+o-1],c[d+--o]=s;else if(8!==l)return;return c}(YT(e,1,-1)),!t)return QT;this.host=t}else if(this.isSpecial()){if(e=TT(e),VT(sS,e))return QT;if(t=function(e){var t,i,r,n,a,o,s,c=KT(e,".");if(c.length&&""===c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(i=[],r=0;r<t;r++){if(""===(n=c[r]))return e;if(a=10,n.length>1&&"0"===BT(n,0)&&(a=VT(rS,n)?16:8,n=YT(n,8===a?1:2)),""===n)o=0;else{if(!VT(10===a?aS:8===a?nS:oS,n))return e;o=MT(n,a)}WT(i,o)}for(r=0;r<t;r++)if(o=i[r],r===t-1){if(o>=FT(256,5-t))return null}else if(o>255)return null;for(s=zT(i),r=0;r<i.length;r++)s+=i[r]*FT(256,3-r);return s}(e),null===t)return QT;this.host=t}else{if(VT(cS,e))return QT;for(t="",i=bT(e),r=0;r<i.length;r++)t+=vS(i[r],pS);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return yT(_S,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&yS(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,i=e.username,r=e.password,n=e.host,a=e.port,o=e.path,s=e.query,c=e.fragment,l=t+":";return null!==n?(l+="//",e.includesCredentials()&&(l+=i+(r?":"+r:"")+"@"),l+=hS(n),null!==a&&(l+=":"+a)):"file"===t&&(l+="//"),l+=e.cannotBeABaseURL?o[0]:o.length?"/"+HT(o,"/"):"",null!==s&&(l+="?"+s),null!==c&&(l+="#"+c),l},setHref:function(e){var t=this.parse(e);if(t)throw new xT(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new GS(e.path[0]).origin}catch(VM){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+hS(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(ST(e)+":",IS)},getUsername:function(){return this.username},setUsername:function(e){var t=bT(ST(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var i=0;i<t.length;i++)this.username+=vS(t[i],gS)}},getPassword:function(){return this.password},setPassword:function(e){var t=bT(ST(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var i=0;i<t.length;i++)this.password+=vS(t[i],gS)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?hS(e):hS(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,NS)},getHostname:function(){var e=this.host;return null===e?"":hS(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,PS)},getPort:function(){var e=this.port;return null===e?"":ST(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=ST(e))?this.port=null:this.parse(e,xS))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+HT(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,BS))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=ST(e))?this.query=null:("?"===BT(e,0)&&(e=YT(e,1)),this.query="",this.parse(e,jS)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=ST(e))?("#"===BT(e,0)&&(e=YT(e,1)),this.fragment="",this.parse(e,zS)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var GS=function(e){var t=_T(this,qS),i=RT(arguments.length,1)>1?arguments[1]:void 0,r=DT(t,new WS(e,!1,i));uT||(t.href=r.serialize(),t.origin=r.getOrigin(),t.protocol=r.getProtocol(),t.username=r.getUsername(),t.password=r.getPassword(),t.host=r.getHost(),t.hostname=r.getHostname(),t.port=r.getPort(),t.pathname=r.getPathname(),t.search=r.getSearch(),t.searchParams=r.getSearchParams(),t.hash=r.getHash())},qS=GS.prototype,KS=function(e,t){return{get:function(){return OT(this)[e]()},set:t&&function(e){return OT(this)[t](e)},configurable:!0,enumerable:!0}};if(uT&&(vT(qS,"href",KS("serialize","setHref")),vT(qS,"origin",KS("getOrigin")),vT(qS,"protocol",KS("getProtocol","setProtocol")),vT(qS,"username",KS("getUsername","setUsername")),vT(qS,"password",KS("getPassword","setPassword")),vT(qS,"host",KS("getHost","setHost")),vT(qS,"hostname",KS("getHostname","setHostname")),vT(qS,"port",KS("getPort","setPort")),vT(qS,"pathname",KS("getPathname","setPathname")),vT(qS,"search",KS("getSearch","setSearch")),vT(qS,"searchParams",KS("getSearchParams")),vT(qS,"hash",KS("getHash","setHash"))),gT(qS,"toJSON",function(){return OT(this).serialize()},{enumerable:!0}),gT(qS,"toString",function(){return OT(this).serialize()},{enumerable:!0}),PT){var YS=PT.createObjectURL,XS=PT.revokeObjectURL;YS&&gT(GS,"createObjectURL",fT(YS,PT)),XS&&gT(GS,"revokeObjectURL",fT(XS,PT))}AT(GS,"URL"),dT({global:!0,constructor:!0,forced:!hT,sham:!uT},{URL:GS});var ZS=l;en({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return ZS(URL.prototype.toString,this)}});var JS,QS,$S=Object.create,eA=Object.defineProperty,tA=Object.defineProperties,iA=Object.getOwnPropertyDescriptor,rA=Object.getOwnPropertyDescriptors,nA=Object.getOwnPropertyNames,aA=Object.getOwnPropertySymbols,oA=Object.getPrototypeOf,sA=Object.prototype.hasOwnProperty,cA=Object.prototype.propertyIsEnumerable,lA=(e,t,i)=>t in e?eA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,dA=(e,t)=>{for(var i in t||(t={}))sA.call(t,i)&&lA(e,i,t[i]);if(aA)for(var i of aA(t))cA.call(t,i)&&lA(e,i,t[i]);return e},uA=(e,t)=>tA(e,rA(t)),hA=(JS=function(e){if("undefined"!=typeof require)return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')},"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(JS,{get:(e,t)=>("undefined"!=typeof require?require:e)[t]}):JS),pA=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),fA=(e,t)=>{for(var i in t)eA(e,i,{get:t[i],enumerable:!0})},mA=(e,t,i)=>(i=null!=e?$S(oA(e)):{},((e,t,i,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of nA(t))!sA.call(e,n)&&n!==i&&eA(e,n,{get:()=>t[n],enumerable:!(r=iA(t,n))||r.enumerable});return e})(!t&&e&&e.__esModule?i:eA(i,"default",{value:e,enumerable:!0}),e)),gA=(e,t,i,r)=>{for(var n,a=r>1?void 0:r?iA(t,i):t,o=e.length-1;o>=0;o--)(n=e[o])&&(a=(r?n(t,i,a):n(a))||a);return r&&a&&eA(t,i,a),a},vA=(e,t,i)=>lA(e,"symbol"!=typeof t?t+"":t,i),_A=pA((e,t)=>{!function(i){"object"==typeof e&&void 0!==t?t.exports=i():"function"==typeof define&&define.amd?define([],i):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=i()}(function(){return function e(t,i,r){function n(o,s){if(!i[o]){if(!t[o]){var c="function"==typeof hA&&hA;if(!s&&c)return c(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[o]={exports:{}};t[o][0].call(d.exports,function(e){return n(t[o][1][e]||e)},d,d.exports,e,t,i,r)}return i[o].exports}for(var a="function"==typeof hA&&hA,o=0;o<r.length;o++)n(r[o]);return n}({1:[function(e,t,i){var r=e("./utils"),n=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e){for(var t,i,n,o,s,c,l,d=[],u=0,h=e.length,p=h,f="string"!==r.getTypeOf(e);u<e.length;)p=h-u,n=f?(t=e[u++],i=u<h?e[u++]:0,u<h?e[u++]:0):(t=e.charCodeAt(u++),i=u<h?e.charCodeAt(u++):0,u<h?e.charCodeAt(u++):0),o=t>>2,s=(3&t)<<4|i>>4,c=1<p?(15&i)<<2|n>>6:64,l=2<p?63&n:64,d.push(a.charAt(o)+a.charAt(s)+a.charAt(c)+a.charAt(l));return d.join("")},i.decode=function(e){var t,i,r,o,s,c,l=0,d=0,u="data:";if(e.substr(0,5)===u)throw new Error("Invalid base64 input, it looks like a data url.");var h,p=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&p--,e.charAt(e.length-2)===a.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=n.uint8array?new Uint8Array(0|p):new Array(0|p);l<e.length;)t=a.indexOf(e.charAt(l++))<<2|(o=a.indexOf(e.charAt(l++)))>>4,i=(15&o)<<4|(s=a.indexOf(e.charAt(l++)))>>2,r=(3&s)<<6|(c=a.indexOf(e.charAt(l++))),h[d++]=t,64!==s&&(h[d++]=i),64!==c&&(h[d++]=r);return h}},{"./support":30,"./utils":32}],2:[function(e,t,i){var r=e("./external"),n=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,i,r,n){this.compressedSize=e,this.uncompressedSize=t,this.crc32=i,this.compression=r,this.compressedContent=n}s.prototype={getContentWorker:function(){var e=new n(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new n(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,i){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,i){var r=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,i){var r=e("./utils"),n=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,i){var r=n,a=0+i;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t[o])];return-1^e}(0|t,e,e.length):function(e,t,i){var r=n,a=0+i;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,t,i){var r;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,i){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=e("pako"),a=e("./utils"),o=e("./stream/GenericWorker"),s=r?"uint8array":"array";function c(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}i.magic="\b\0",a.inherits(c,o),c.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},c.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},i.compressWorker=function(e){return new c("Deflate",e)},i.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,i){function r(e,t){var i,r="";for(i=0;i<t;i++)r+=String.fromCharCode(255&e),e>>>=8;return r}function n(e,t,i,n,o,d){var u,h,p=e.file,f=e.compression,m=d!==s.utf8encode,g=a.transformTo("string",d(p.name)),v=a.transformTo("string",s.utf8encode(p.name)),_=p.comment,y=a.transformTo("string",d(_)),E=a.transformTo("string",s.utf8encode(_)),b=v.length!==p.name.length,w=E.length!==_.length,I="",T="",S="",A=p.dir,R=p.date,k={crc32:0,compressedSize:0,uncompressedSize:0};t&&!i||(k.crc32=e.crc32,k.compressedSize=e.compressedSize,k.uncompressedSize=e.uncompressedSize);var C=0;t&&(C|=8),m||!b&&!w||(C|=2048);var D,O,L,N=0,P=0;A&&(N|=16),"UNIX"===o?(P=798,N|=(D=p.unixPermissions,O=A,L=D,D||(L=O?16893:33204),(65535&L)<<16)):(P=20,N|=function(e){return 63&(e||0)}(p.dosPermissions)),u=R.getUTCHours(),u<<=6,u|=R.getUTCMinutes(),u<<=5,u|=R.getUTCSeconds()/2,h=R.getUTCFullYear()-1980,h<<=4,h|=R.getUTCMonth()+1,h<<=5,h|=R.getUTCDate(),b&&(T=r(1,1)+r(c(g),4)+v,I+="up"+r(T.length,2)+T),w&&(S=r(1,1)+r(c(y),4)+E,I+="uc"+r(S.length,2)+S);var x="";return x+="\n\0",x+=r(C,2),x+=f.magic,x+=r(u,2),x+=r(h,2),x+=r(k.crc32,4),x+=r(k.compressedSize,4),x+=r(k.uncompressedSize,4),x+=r(g.length,2),x+=r(I.length,2),{fileRecord:l.LOCAL_FILE_HEADER+x+g+I,dirRecord:l.CENTRAL_FILE_HEADER+r(P,2)+x+r(y.length,2)+"\0\0\0\0"+r(N,4)+r(n,4)+g+I+y}}var a=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),c=e("../crc32"),l=e("../signature");function d(e,t,i,r){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=i,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(d,o),d.prototype.push=function(e){var t=e.meta.percent||0,i=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:i?(t+100*(i-r-1))/i:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var i=n(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t,i=this.streamFiles&&!e.file.dir,a=n(e,i,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(a.dirRecord),i)this.push({data:(t=e,l.DATA_DESCRIPTOR+r(t.crc32,4)+r(t.compressedSize,4)+r(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:a.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var i,n,o,s,c,d,u=this.bytesWritten-e,h=(i=this.dirRecords.length,n=u,o=e,s=this.zipComment,c=this.encodeFileName,d=a.transformTo("string",c(s)),l.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(i,2)+r(i,2)+r(n,4)+r(o,4)+r(d.length,2)+d);this.push({data:h,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},d.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var i=0;i<t.length;i++)try{t[i].error(e)}catch(r){}return!0},d.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,i){var r=e("../compressions"),n=e("./ZipFileWorker");i.generateWorker=function(e,t,i){var a=new n(t.streamFiles,i,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,i){o++;var n=function(e,t){var i=e||t,n=r[i];if(!n)throw new Error(i+" is not a valid compression method !");return n}(i.options.compression,t.compression),s=i.options.compressionOptions||t.compressionOptions||{},c=i.dir,l=i.date;i._compressWorker(n,s).withStreamInfo("file",{name:e,dir:c,date:l,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(a)}),a.entriesCount=o}catch(s){a.error(s)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,i){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,i){var r=e("./utils"),n=e("./external"),a=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),c=e("./nodejsUtils");function l(e){return new n.Promise(function(t,i){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",function(e){i(e)}).on("end",function(){r.streamInfo.crc32!==e.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var i=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(e)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var i=new o(t);return i.load(e),i}).then(function(e){var i=[n.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var a=0;a<r.length;a++)i.push(l(r[a]));return n.Promise.all(i)}).then(function(e){for(var n=e.shift(),a=n.files,o=0;o<a.length;o++){var s=a[o],c=s.fileNameStr,l=r.resolve(s.fileNameStr);i.file(l,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(i.file(l).unsafeOriginalName=c)}return n.zipComment.length&&(i.comment=n.zipComment),i})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,i){var r=e("../utils"),n=e("../stream/GenericWorker");function a(e,t){n.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(a,n),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},a.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,i){var r=e("readable-stream").Readable;function n(e,t,i){r.call(this,t),this._helper=e;var n=this;e.on("data",function(e,t){n.push(e)||n._helper.pause(),i&&i(t)}).on("error",function(e){n.emit("error",e)}).on("end",function(){n.push(null)})}e("../utils").inherits(n,r),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(e,t,i){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,i){function r(e,t,i){var r,n=a.getTypeOf(t),s=a.extend(i||{},c);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(r=f(e))&&g.call(this,r,!0);var u="string"===n&&!1===s.binary&&!1===s.base64;i&&void 0!==i.binary||(s.binary=!u),(t instanceof l&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",n="string");var v;v=t instanceof l||t instanceof o?t:h.isNode&&h.isStream(t)?new p(e,t):a.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var _=new d(e,v,s);this.files[e]=_}var n=e("./utf8"),a=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),c=e("./defaults"),l=e("./compressedObject"),d=e("./zipObject"),u=e("./generate"),h=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),f=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:c.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function v(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,i,r;for(t in this.files)r=this.files[t],(i=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(i,r)},filter:function(e){var t=[];return this.forEach(function(i,r){e(i,r)&&t.push(r)}),t},file:function(e,t,i){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,i),this;if(v(e)){var n=e;return this.filter(function(e,t){return!t.dir&&n.test(e)})}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(e){if(!e)return this;if(v(e))return this.filter(function(t,i){return i.dir&&e.test(t)});var t=this.root+e,i=g.call(this,t),r=this.clone();return r.root=i.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var i=this.filter(function(t,i){return i.name.slice(0,e.length)===e}),r=0;r<i.length;r++)delete this.files[i[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,i={};try{if((i=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),"binarystring"===i.type&&(i.type="string"),!i.type)throw new Error("No output type specified.");a.checkSupport(i.type),"darwin"!==i.platform&&"freebsd"!==i.platform&&"linux"!==i.platform&&"sunos"!==i.platform||(i.platform="UNIX"),"win32"===i.platform&&(i.platform="DOS");var r=i.comment||this.comment||"";t=u.generateWorker(this,i,r)}catch(c){(t=new o("error")).error(c)}return new s(t,i.type||"string",i.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,i){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,i){var r=e("./DataReader");function n(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(n,r),n.prototype.byteAt=function(e){return this.data[this.zero+e]},n.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),i=e.charCodeAt(1),r=e.charCodeAt(2),n=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===i&&this.data[a+2]===r&&this.data[a+3]===n)return a-this.zero;return-1},n.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),r=e.charCodeAt(2),n=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&i===a[1]&&r===a[2]&&n===a[3]},n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],18:[function(e,t,i){var r=e("../utils");function n(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,i=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)i=(i<<8)+this.byteAt(t);return this.index+=e,i},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=n},{"../utils":32}],19:[function(e,t,i){var r=e("./Uint8ArrayReader");function n(e){r.call(this,e)}e("../utils").inherits(n,r),n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,i){var r=e("./DataReader");function n(e){r.call(this,e)}e("../utils").inherits(n,r),n.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},n.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},n.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],21:[function(e,t,i){var r=e("./ArrayReader");function n(e){r.call(this,e)}e("../utils").inherits(n,r),n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,i){var r=e("../utils"),n=e("../support"),a=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),c=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||n.uint8array?"nodebuffer"===t?new s(e):n.uint8array?new c(r.transformTo("uint8array",e)):new a(r.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,i){var r=e("./GenericWorker"),n=e("../utils");function a(e){r.call(this,"ConvertWorker to "+e),this.destType=e}n.inherits(a,r),a.prototype.processChunk=function(e){this.push({data:n.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,i){var r=e("./GenericWorker"),n=e("../crc32");function a(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,r),a.prototype.processChunk=function(e){this.streamInfo.crc32=n(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,i){var r=e("../utils"),n=e("./GenericWorker");function a(e){n.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(a,n),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}n.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,i){var r=e("../utils"),n=e("./GenericWorker");function a(e){n.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}r.inherits(a,n),a.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,i){function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var i=0;i<this._listeners[e].length;i++)this._listeners[e][i].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,i){var r=e("../utils"),n=e("./ConvertWorker"),a=e("./GenericWorker"),o=e("../base64"),s=e("../support"),c=e("../external"),l=null;if(s.nodestream)try{l=e("../nodejs/NodejsStreamOutputAdapter")}catch(u){}function d(e,t,i){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=i,r.checkSupport(o),this._worker=e.pipe(new n(o)),e.lock()}catch(s){this._worker=new a("error"),this._worker.error(s)}}d.prototype={accumulate:function(e){return function(e,t){return new c.Promise(function(i,n){var a=[],s=e._internalType,c=e._outputType,l=e._mimeType;e.on("data",function(e,i){a.push(e),t&&t(i)}).on("error",function(e){a=[],n(e)}).on("end",function(){try{var e=function(e,t,i){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),i);case"base64":return o.encode(t);default:return r.transformTo(e,t)}}(c,function(e,t){var i,r=0,n=null,a=0;for(i=0;i<t.length;i++)a+=t[i].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(n=new Uint8Array(a),i=0;i<t.length;i++)n.set(t[i],r),r+=t[i].length;return n;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,a),l);i(e)}catch(t){n(t)}a=[]}).resume()})}(this,e)},on:function(e,t){var i=this;return"data"===e?this._worker.on(e,function(e){t.call(i,e.data,e.meta)}):this._worker.on(e,function(){r.delay(t,arguments,i)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new l(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer="undefined"!=typeof Buffer,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var r=new ArrayBuffer(0);try{i.blob=0===new Blob([r],{type:"application/zip"}).size}catch(a){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(r),i.blob=0===n.getBlob("application/zip").size}catch(DA){i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch(a){i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,i){for(var r=e("./utils"),n=e("./support"),a=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),c=0;c<256;c++)s[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function l(){o.call(this,"utf-8 decode"),this.leftOver=null}function d(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,i.utf8encode=function(e){return n.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,i,r,a,o,s=e.length,c=0;for(a=0;a<s;a++)55296==(64512&(i=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(r-56320),a++),c+=i<128?1:i<2048?2:i<65536?3:4;for(t=n.uint8array?new Uint8Array(c):new Array(c),a=o=0;o<c;a++)55296==(64512&(i=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(r-56320),a++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t}(e)},i.utf8decode=function(e){return n.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,i,n,a,o=e.length,c=new Array(2*o);for(t=i=0;t<o;)if((n=e[t++])<128)c[i++]=n;else if(4<(a=s[n]))c[i++]=65533,t+=a-1;else{for(n&=2===a?31:3===a?15:7;1<a&&t<o;)n=n<<6|63&e[t++],a--;1<a?c[i++]=65533:n<65536?c[i++]=n:(n-=65536,c[i++]=55296|n>>10&1023,c[i++]=56320|1023&n)}return c.length!==i&&(c.subarray?c=c.subarray(0,i):c.length=i),r.applyFromCharCode(c)}(e=r.transformTo(n.uint8array?"uint8array":"array",e))},r.inherits(l,o),l.prototype.processChunk=function(e){var t=r.transformTo(n.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+s[e[i]]>t?i:t}(t),c=t;o!==t.length&&(n.uint8array?(c=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(c=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:i.utf8decode(c),meta:e.meta})},l.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=l,r.inherits(d,o),d.prototype.processChunk=function(e){this.push({data:i.utf8encode(e.data),meta:e.meta})},i.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,i){var r=e("./support"),n=e("./base64"),a=e("./nodejsUtils"),o=e("./external");function s(e){return e}function c(e,t){for(var i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t}e("setimmediate"),i.newBlob=function(e,t){i.checkSupport("blob");try{return new Blob([e],{type:t})}catch(n){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(a){throw new Error("Bug : can't construct the Blob.")}}};var l={stringifyByChunk:function(e,t,i){var r=[],n=0,a=e.length;if(a<=i)return String.fromCharCode.apply(null,e);for(;n<a;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+i,a)))):r.push(String.fromCharCode.apply(null,e.subarray(n,Math.min(n+i,a)))),n+=i;return r.join("")},stringifyByChar:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,r=i.getTypeOf(e),n=!0;if("uint8array"===r?n=l.applyCanBeUsed.uint8array:"nodebuffer"===r&&(n=l.applyCanBeUsed.nodebuffer),n)for(;1<t;)try{return l.stringifyByChunk(e,r,t)}catch(a){t=Math.floor(t/2)}return l.stringifyByChar(e)}function u(e,t){for(var i=0;i<e.length;i++)t[i]=e[i];return t}i.applyFromCharCode=d;var h={};h.string={string:s,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:function(e){return c(e,a.allocBuffer(e.length))}},h.array={string:d,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},h.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a.newBufferFrom(e)}},h.nodebuffer={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:s},i.transformTo=function(e,t){if(t=t||"",!e)return t;i.checkSupport(e);var r=i.getTypeOf(t);return h[r][e](t)},i.resolve=function(e){for(var t=e.split("/"),i=[],r=0;r<t.length;r++){var n=t[r];"."===n||""===n&&0!==r&&r!==t.length-1||(".."===n?i.pop():i.push(n))}return i.join("/")},i.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&a.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(e){var t,i,r="";for(i=0;i<(e||"").length;i++)r+="\\x"+((t=e.charCodeAt(i))<16?"0":"")+t.toString(16).toUpperCase();return r},i.delay=function(e,t,i){setImmediate(function(){e.apply(i||null,t||[])})},i.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.prototype=new i},i.extend=function(){var e,t,i={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===i[t]&&(i[t]=arguments[e][t]);return i},i.prepareContent=function(e,t,a,s,l){return o.Promise.resolve(t).then(function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise(function(t,i){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){i(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(t){var d,u=i.getTypeOf(t);return u?("arraybuffer"===u?t=i.transformTo("uint8array",t):"string"===u&&(l?t=n.decode(t):a&&!0!==s&&(t=c(d=t,r.uint8array?new Uint8Array(d.length):new Array(d.length)))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,i){var r=e("./reader/readerFor"),n=e("./utils"),a=e("./signature"),o=e("./zipEntry"),s=e("./support");function c(e){this.files=[],this.loadOptions=e}c.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(t)+", expected "+n.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(i),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",i=n.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,i,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),i=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var r=t-i;if(0<r)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,i){var r=e("./reader/readerFor"),n=e("./utils"),a=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),c=e("./compressions"),l=e("./support");function d(e,t){this.options=e,this.loadOptions=t}d.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in c)if(Object.prototype.hasOwnProperty.call(c,t)&&c[t].magic===e)return c[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,i,r,n=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<n;)t=e.readInt(2),i=e.readInt(2),r=e.readData(i),this.extraFields[t]={id:t,length:i,value:r};e.setIndex(n)},handleUTF8:function(){var e=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var i=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var a=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,i){function r(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}}var n=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),c=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,i="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(i=e.toLowerCase())||"text"===i;"binarystring"!==i&&"text"!==i||(i="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!r&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&r&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(s){(t=new c("error")).error(s)}return new n(t,i,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(i,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof c?this._data:new a(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<l.length;u++)r.prototype[l[u]]=d;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,i){(function(e){var i,r,n=e.MutationObserver||e.WebKitMutationObserver;if(n){var a=0,o=new n(d),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),i=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var c=new e.MessageChannel;c.port1.onmessage=d,i=function(){c.port2.postMessage(0)}}var l=[];function d(){var e,t;r=!0;for(var i=l.length;i;){for(t=l,l=[],e=-1;++e<i;)t[e]();i=l.length}r=!1}t.exports=function(e){1!==l.push(e)||r||i()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,i){var r=e("immediate");function n(){}var a={},o=["REJECTED"],s=["FULFILLED"],c=["PENDING"];function l(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,e!==n&&p(this,e)}function d(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function u(e,t,i){r(function(){var r;try{r=t(i)}catch(NO){return a.reject(e,NO)}r===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,r)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function p(e,t){var i=!1;function r(t){i||(i=!0,a.reject(e,t))}function n(t){i||(i=!0,a.resolve(e,t))}var o=f(function(){t(n,r)});"error"===o.status&&r(o.value)}function f(e,t){var i={};try{i.value=e(t),i.status="success"}catch(r){i.status="error",i.value=r}return i}(t.exports=l).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(i){return t.resolve(e()).then(function(){return i})},function(i){return t.resolve(e()).then(function(){throw i})})},l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var i=new this.constructor(n);return this.state!==c?u(i,this.state===s?e:t,this.outcome):this.queue.push(new d(i,e,t)),i},d.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){a.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},a.resolve=function(e,t){var i=f(h,t);if("error"===i.status)return a.reject(e,i.value);var r=i.value;if(r)p(e,r);else{e.state=s,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var i=-1,r=e.queue.length;++i<r;)e.queue[i].callRejected(t);return e},l.resolve=function(e){return e instanceof this?e:a.resolve(new this(n),e)},l.reject=function(e){var t=new this(n);return a.reject(t,e)},l.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,r=!1;if(!i)return this.resolve([]);for(var o=new Array(i),s=0,c=-1,l=new this(n);++c<i;)d(e[c],c);return l;function d(e,n){t.resolve(e).then(function(e){o[n]=e,++s!==i||r||(r=!0,a.resolve(l,o))},function(e){r||(r=!0,a.reject(l,e))})}},l.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t,i=e.length,r=!1;if(!i)return this.resolve([]);for(var o=-1,s=new this(n);++o<i;)t=e[o],this.resolve(t).then(function(e){r||(r=!0,a.resolve(s,e))},function(e){r||(r=!0,a.reject(s,e))});return s}},{immediate:36}],38:[function(e,t,i){var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,i){var r=e("./zlib/deflate"),n=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),c=Object.prototype.toString;function l(e){if(!(this instanceof l))return new l(e);this.options=n.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var i=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==i)throw new Error(o[i]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var d;if(d="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===c.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(i=r.deflateSetDictionary(this.strm,d)))throw new Error(o[i]);this._dict_set=!0}}function d(e,t){var i=new l(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}l.prototype.push=function(e,t){var i,o,s=this.strm,l=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===c.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new n.Buf8(l),s.next_out=0,s.avail_out=l),1!==(i=r.deflate(s,o))&&0!==i)return this.onEnd(i),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(n.shrinkBuf(s.output,s.next_out))):this.onData(n.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==i);return 4===o?(i=r.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,0===i):2!==o||(this.onEnd(0),!(s.avail_out=0))},l.prototype.onData=function(e){this.chunks.push(e)},l.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=l,i.deflate=d,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,d(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,i){var r=e("./zlib/inflate"),n=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),c=e("./zlib/zstream"),l=e("./zlib/gzheader"),d=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var i=r.inflateInit2(this.strm,t.windowBits);if(i!==o.Z_OK)throw new Error(s[i]);this.header=new l,r.inflateGetHeader(this.strm,this.header)}function h(e,t){var i=new u(t);if(i.push(e,!0),i.err)throw i.msg||s[i.err];return i.result}u.prototype.push=function(e,t){var i,s,c,l,u,h,p=this.strm,f=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?p.input=a.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?p.input=new Uint8Array(e):p.input=e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new n.Buf8(f),p.next_out=0,p.avail_out=f),(i=r.inflate(p,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(h="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===d.call(m)?new Uint8Array(m):m,i=r.inflateSetDictionary(this.strm,h)),i===o.Z_BUF_ERROR&&!0===g&&(i=o.Z_OK,g=!1),i!==o.Z_STREAM_END&&i!==o.Z_OK)return this.onEnd(i),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&i!==o.Z_STREAM_END&&(0!==p.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(c=a.utf8border(p.output,p.next_out),l=p.next_out-c,u=a.buf2string(p.output,c),p.next_out=l,p.avail_out=f-l,l&&n.arraySet(p.output,p.output,c,l,0),this.onData(u)):this.onData(n.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(g=!0)}while((0<p.avail_in||0===p.avail_out)&&i!==o.Z_STREAM_END);return i===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(i=r.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(p.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=u,i.inflate=h,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},i.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,i){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,i,r,n){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+r),n);else for(var a=0;a<r;a++)e[n+a]=t[i+a]},flattenChunks:function(e){var t,i,r,n,a,o;for(t=r=0,i=e.length;t<i;t++)r+=e[t].length;for(o=new Uint8Array(r),t=n=0,i=e.length;t<i;t++)a=e[t],o.set(a,n),n+=a.length;return o}},a={arraySet:function(e,t,i,r,n){for(var a=0;a<r;a++)e[n+a]=t[i+a]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,n)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(r)},{}],42:[function(e,t,i){var r=e("./common"),n=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(l){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(l){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function c(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&n))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var i="",o=0;o<t;o++)i+=String.fromCharCode(e[o]);return i}o[254]=o[254]=1,i.string2buf=function(e){var t,i,n,a,o,s=e.length,c=0;for(a=0;a<s;a++)55296==(64512&(i=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=e.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),c+=i<128?1:i<2048?2:i<65536?3:4;for(t=new r.Buf8(c),a=o=0;o<c;a++)55296==(64512&(i=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(n=e.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t},i.buf2binstring=function(e){return c(e,e.length)},i.binstring2buf=function(e){for(var t=new r.Buf8(e.length),i=0,n=t.length;i<n;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,r,n,a,s=t||e.length,l=new Array(2*s);for(i=r=0;i<s;)if((n=e[i++])<128)l[r++]=n;else if(4<(a=o[n]))l[r++]=65533,i+=a-1;else{for(n&=2===a?31:3===a?15:7;1<a&&i<s;)n=n<<6|63&e[i++],a--;1<a?l[r++]=65533:n<65536?l[r++]=n:(n-=65536,l[r++]=55296|n>>10&1023,l[r++]=56320|1023&n)}return c(l,r)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+o[e[i]]>t?i:t}},{"./common":41}],43:[function(e,t,i){t.exports=function(e,t,i,r){for(var n=65535&e,a=e>>>16&65535,o=0;0!==i;){for(i-=o=2e3<i?2e3:i;a=a+(n=n+t[r++]|0)|0,--o;);n%=65521,a%=65521}return n|a<<16}},{}],44:[function(e,t,i){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,i){var r=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,n){var a=r,o=n+i;e^=-1;for(var s=n;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,i){var r,n=e("../utils/common"),a=e("./trees"),o=e("./adler32"),s=e("./crc32"),c=e("./messages"),l=-2,d=258,u=262,h=113;function p(e,t){return e.msg=c[t],t}function f(e){return(e<<1)-(4<e?9:0)}function m(e){for(var t=e.length;0<=--t;)e[t]=0}function g(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(n.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function v(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,g(e.strm)}function _(e,t){e.pending_buf[e.pending++]=t}function y(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function E(e,t){var i,r,n=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-u?e.strstart-(e.w_size-u):0,l=e.window,h=e.w_mask,p=e.prev,f=e.strstart+d,m=l[a+o-1],g=l[a+o];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do{if(l[(i=t)+o]===g&&l[i+o-1]===m&&l[i]===l[a]&&l[++i]===l[a+1]){a+=2,i++;do{}while(l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&a<f);if(r=d-(f-a),a=f-d,o<r){if(e.match_start=t,s<=(o=r))break;m=l[a+o-1],g=l[a+o]}}}while((t=p[t&h])>c&&0!=--n);return o<=e.lookahead?o:e.lookahead}function b(e){var t,i,r,a,c,l,d,h,p,f,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-u)){for(n.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=i=e.hash_size;r=e.head[--t],e.head[t]=m<=r?r-m:0,--i;);for(t=i=m;r=e.prev[--t],e.prev[t]=m<=r?r-m:0,--i;);a+=m}if(0===e.strm.avail_in)break;if(l=e.strm,d=e.window,h=e.strstart+e.lookahead,f=void 0,(p=a)<(f=l.avail_in)&&(f=p),i=0===f?0:(l.avail_in-=f,n.arraySet(d,l.input,l.next_in,f,h),1===l.state.wrap?l.adler=o(l.adler,d,f,h):2===l.state.wrap&&(l.adler=s(l.adler,d,f,h)),l.next_in+=f,l.total_in+=f,f),e.lookahead+=i,e.lookahead+e.insert>=3)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+3-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<u&&0!==e.strm.avail_in)}function w(e,t){for(var i,r;;){if(e.lookahead<u){if(b(e),e.lookahead<u&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-u&&(e.match_length=E(e,i)),e.match_length>=3)if(r=a._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}function I(e,t){for(var i,r,n;;){if(e.lookahead<u){if(b(e),e.lookahead<u&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-u&&(e.match_length=E(e,i),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(n=e.strstart+e.lookahead-3,r=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(v(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=a._tr_tally(e,0,e.window[e.strstart-1]))&&v(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}function T(e,t,i,r,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=n}function S(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(1146),this.dyn_dtree=new n.Buf16(122),this.bl_tree=new n.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(16),this.heap=new n.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function A(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:h,e.adler=2===t.wrap?0:1,t.last_flush=0,a._tr_init(t),0):p(e,l)}function R(e){var t,i=A(e);return 0===i&&((t=e.state).window_size=2*t.w_size,m(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),i}function k(e,t,i,r,a,o){if(!e)return l;var s=1;if(-1===t&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),a<1||9<a||8!==i||r<8||15<r||t<0||9<t||o<0||4<o)return p(e,l);8===r&&(r=9);var c=new S;return(e.state=c).strm=e,c.wrap=s,c.gzhead=null,c.w_bits=r,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new n.Buf8(2*c.w_size),c.head=new n.Buf16(c.hash_size),c.prev=new n.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new n.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=o,c.method=i,R(e)}r=[new T(0,0,0,0,function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(b(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+i;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,v(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-u&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(v(e,!1),e.strm.avail_out),1)}),new T(4,4,8,4,w),new T(4,5,16,8,w),new T(4,6,32,32,w),new T(4,4,16,16,I),new T(8,16,32,32,I),new T(8,16,128,128,I),new T(8,32,128,256,I),new T(32,128,258,1024,I),new T(32,258,258,4096,I)],i.deflateInit=function(e,t){return k(e,t,8,15,8,0)},i.deflateInit2=k,i.deflateReset=R,i.deflateResetKeep=A,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?l:(e.state.gzhead=t,0):l},i.deflate=function(e,t){var i,n,o,c;if(!e||!e.state||5<t||t<0)return e?p(e,l):l;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return p(e,0===e.avail_out?-5:l);if(n.strm=e,i=n.last_flush,n.last_flush=t,42===n.status)if(2===n.wrap)e.adler=0,_(n,31),_(n,139),_(n,8),n.gzhead?(_(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),_(n,255&n.gzhead.time),_(n,n.gzhead.time>>8&255),_(n,n.gzhead.time>>16&255),_(n,n.gzhead.time>>24&255),_(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),_(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(_(n,255&n.gzhead.extra.length),_(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=s(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(_(n,0),_(n,0),_(n,0),_(n,0),_(n,0),_(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),_(n,3),n.status=h);else{var u=8+(n.w_bits-8<<4)<<8;u|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(u|=32),u+=31-u%31,n.status=h,y(n,u),0!==n.strstart&&(y(n,e.adler>>>16),y(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(o=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),g(e),o=n.pending,n.pending!==n.pending_buf_size));)_(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),g(e),o=n.pending,n.pending===n.pending_buf_size)){c=1;break}c=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,_(n,c)}while(0!==c);n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),0===c&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),g(e),o=n.pending,n.pending===n.pending_buf_size)){c=1;break}c=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,_(n,c)}while(0!==c);n.gzhead.hcrc&&n.pending>o&&(e.adler=s(e.adler,n.pending_buf,n.pending-o,o)),0===c&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&g(e),n.pending+2<=n.pending_buf_size&&(_(n,255&e.adler),_(n,e.adler>>8&255),e.adler=0,n.status=h)):n.status=h),0!==n.pending){if(g(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&f(t)<=f(i)&&4!==t)return p(e,-5);if(666===n.status&&0!==e.avail_in)return p(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&666!==n.status){var E=2===n.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&(b(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var i,r,n,o,s=e.window;;){if(e.lookahead<=d){if(b(e),e.lookahead<=d&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(r=s[n=e.strstart-1])===s[++n]&&r===s[++n]&&r===s[++n]){o=e.strstart+d;do{}while(r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&r===s[++n]&&n<o);e.match_length=d-(o-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=a._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(v(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(v(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(v(e,!1),0===e.strm.avail_out)?1:2}(n,t):r[n.level].func(n,t);if(3!==E&&4!==E||(n.status=666),1===E||3===E)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===E&&(1===t?a._tr_align(n):5!==t&&(a._tr_stored_block(n,0,0,!1),3===t&&(m(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),g(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(_(n,255&e.adler),_(n,e.adler>>8&255),_(n,e.adler>>16&255),_(n,e.adler>>24&255),_(n,255&e.total_in),_(n,e.total_in>>8&255),_(n,e.total_in>>16&255),_(n,e.total_in>>24&255)):(y(n,e.adler>>>16),y(n,65535&e.adler)),g(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?0:1)},i.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==h&&666!==t?p(e,l):(e.state=null,t===h?p(e,-3):0):l},i.deflateSetDictionary=function(e,t){var i,r,a,s,c,d,u,h,p=t.length;if(!e||!e.state||2===(s=(i=e.state).wrap)||1===s&&42!==i.status||i.lookahead)return l;for(1===s&&(e.adler=o(e.adler,t,p,0)),i.wrap=0,p>=i.w_size&&(0===s&&(m(i.head),i.strstart=0,i.block_start=0,i.insert=0),h=new n.Buf8(i.w_size),n.arraySet(h,t,p-i.w_size,i.w_size,0),t=h,p=i.w_size),c=e.avail_in,d=e.next_in,u=e.input,e.avail_in=p,e.next_in=0,e.input=t,b(i);i.lookahead>=3;){for(r=i.strstart,a=i.lookahead-2;i.ins_h=(i.ins_h<<i.hash_shift^i.window[r+3-1])&i.hash_mask,i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++,--a;);i.strstart=r,i.lookahead=2,b(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=d,e.input=u,e.avail_in=c,i.wrap=s,0},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,i){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,i){t.exports=function(e,t){var i,r,n,a,o,s,c,l,d,u,h,p,f,m,g,v,_,y,E,b,w,I,T,S,A;i=e.state,r=e.next_in,S=e.input,n=r+(e.avail_in-5),a=e.next_out,A=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),c=i.dmax,l=i.wsize,d=i.whave,u=i.wnext,h=i.window,p=i.hold,f=i.bits,m=i.lencode,g=i.distcode,v=(1<<i.lenbits)-1,_=(1<<i.distbits)-1;e:do{f<15&&(p+=S[r++]<<f,f+=8,p+=S[r++]<<f,f+=8),y=m[p&v];t:for(;;){if(p>>>=E=y>>>24,f-=E,0==(E=y>>>16&255))A[a++]=65535&y;else{if(!(16&E)){if(!(64&E)){y=m[(65535&y)+(p&(1<<E)-1)];continue t}if(32&E){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}b=65535&y,(E&=15)&&(f<E&&(p+=S[r++]<<f,f+=8),b+=p&(1<<E)-1,p>>>=E,f-=E),f<15&&(p+=S[r++]<<f,f+=8,p+=S[r++]<<f,f+=8),y=g[p&_];i:for(;;){if(p>>>=E=y>>>24,f-=E,!(16&(E=y>>>16&255))){if(!(64&E)){y=g[(65535&y)+(p&(1<<E)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(w=65535&y,f<(E&=15)&&(p+=S[r++]<<f,(f+=8)<E&&(p+=S[r++]<<f,f+=8)),c<(w+=p&(1<<E)-1)){e.msg="invalid distance too far back",i.mode=30;break e}if(p>>>=E,f-=E,(E=a-o)<w){if(d<(E=w-E)&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(T=h,(I=0)===u){if(I+=l-E,E<b){for(b-=E;A[a++]=h[I++],--E;);I=a-w,T=A}}else if(u<E){if(I+=l+u-E,(E-=u)<b){for(b-=E;A[a++]=h[I++],--E;);if(I=0,u<b){for(b-=E=u;A[a++]=h[I++],--E;);I=a-w,T=A}}}else if(I+=u-E,E<b){for(b-=E;A[a++]=h[I++],--E;);I=a-w,T=A}for(;2<b;)A[a++]=T[I++],A[a++]=T[I++],A[a++]=T[I++],b-=3;b&&(A[a++]=T[I++],1<b&&(A[a++]=T[I++]))}else{for(I=a-w;A[a++]=A[I++],A[a++]=A[I++],A[a++]=A[I++],2<(b-=3););b&&(A[a++]=A[I++],1<b&&(A[a++]=A[I++]))}break}}break}}while(r<n&&a<s);r-=b=f>>3,p&=(1<<(f-=b<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=a<s?s-a+257:257-(a-s),i.hold=p,i.bits=f}},{}],49:[function(e,t,i){var r=e("../utils/common"),n=e("./adler32"),a=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),c=-2;function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function d(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):c}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,u(e)):c}function p(e,t){var i,r;return e&&e.state?(r=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?c:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,h(e))):c}function f(e,t){var i,r;return e?(r=new d,(e.state=r).window=null,0!==(i=p(e,t))&&(e.state=null),i):c}var m,g,v=!0;function _(e){if(v){var t;for(m=new r.Buf32(512),g=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,g,0,e.work,{bits:5}),v=!1}e.lencode=m,e.lenbits=9,e.distcode=g,e.distbits=5}function y(e,t,i,n){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),n>=o.wsize?(r.arraySet(o.window,t,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(n<(a=o.wsize-o.wnext)&&(a=n),r.arraySet(o.window,t,i-n,a,o.wnext),(n-=a)?(r.arraySet(o.window,t,i-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}i.inflateReset=h,i.inflateReset2=p,i.inflateResetKeep=u,i.inflateInit=function(e){return f(e,15)},i.inflateInit2=f,i.inflate=function(e,t){var i,d,u,h,p,f,m,g,v,E,b,w,I,T,S,A,R,k,C,D,O,L,N,P,x=0,M=new r.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return c;12===(i=e.state).mode&&(i.mode=13),p=e.next_out,u=e.output,m=e.avail_out,h=e.next_in,d=e.input,f=e.avail_in,g=i.hold,v=i.bits,E=f,b=m,L=0;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;v<16;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if(2&i.wrap&&35615===g){M[i.check=0]=255&g,M[1]=g>>>8&255,i.check=a(i.check,M,2,0),v=g=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",i.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",i.mode=30;break}if(v-=4,O=8+(15&(g>>>=4)),0===i.wbits)i.wbits=O;else if(O>i.wbits){e.msg="invalid window size",i.mode=30;break}i.dmax=1<<O,e.adler=i.check=1,i.mode=512&g?10:12,v=g=0;break;case 2:for(;v<16;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if(i.flags=g,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=g>>8&1),512&i.flags&&(M[0]=255&g,M[1]=g>>>8&255,i.check=a(i.check,M,2,0)),v=g=0,i.mode=3;case 3:for(;v<32;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}i.head&&(i.head.time=g),512&i.flags&&(M[0]=255&g,M[1]=g>>>8&255,M[2]=g>>>16&255,M[3]=g>>>24&255,i.check=a(i.check,M,4,0)),v=g=0,i.mode=4;case 4:for(;v<16;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}i.head&&(i.head.xflags=255&g,i.head.os=g>>8),512&i.flags&&(M[0]=255&g,M[1]=g>>>8&255,i.check=a(i.check,M,2,0)),v=g=0,i.mode=5;case 5:if(1024&i.flags){for(;v<16;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}i.length=g,i.head&&(i.head.extra_len=g),512&i.flags&&(M[0]=255&g,M[1]=g>>>8&255,i.check=a(i.check,M,2,0)),v=g=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(f<(w=i.length)&&(w=f),w&&(i.head&&(O=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),r.arraySet(i.head.extra,d,h,w,O)),512&i.flags&&(i.check=a(i.check,d,w,h)),f-=w,h+=w,i.length-=w),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===f)break e;for(w=0;O=d[h+w++],i.head&&O&&i.length<65536&&(i.head.name+=String.fromCharCode(O)),O&&w<f;);if(512&i.flags&&(i.check=a(i.check,d,w,h)),f-=w,h+=w,O)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===f)break e;for(w=0;O=d[h+w++],i.head&&O&&i.length<65536&&(i.head.comment+=String.fromCharCode(O)),O&&w<f;);if(512&i.flags&&(i.check=a(i.check,d,w,h)),f-=w,h+=w,O)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;v<16;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if(g!==(65535&i.check)){e.msg="header crc mismatch",i.mode=30;break}v=g=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=12;break;case 10:for(;v<32;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}e.adler=i.check=l(g),v=g=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=p,e.avail_out=m,e.next_in=h,e.avail_in=f,i.hold=g,i.bits=v,2;e.adler=i.check=1,i.mode=12;case 12:if(5===t||6===t)break e;case 13:if(i.last){g>>>=7&v,v-=7&v,i.mode=27;break}for(;v<3;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}switch(i.last=1&g,v-=1,3&(g>>>=1)){case 0:i.mode=14;break;case 1:if(_(i),i.mode=20,6!==t)break;g>>>=2,v-=2;break e;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=30}g>>>=2,v-=2;break;case 14:for(g>>>=7&v,v-=7&v;v<32;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&g,v=g=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(w=i.length){if(f<w&&(w=f),m<w&&(w=m),0===w)break e;r.arraySet(u,d,h,w,p),f-=w,h+=w,m-=w,p+=w,i.length-=w;break}i.mode=12;break;case 17:for(;v<14;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if(i.nlen=257+(31&g),g>>>=5,v-=5,i.ndist=1+(31&g),g>>>=5,v-=5,i.ncode=4+(15&g),g>>>=4,v-=4,286<i.nlen||30<i.ndist){e.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;v<3;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}i.lens[U[i.have++]]=7&g,g>>>=3,v-=3}for(;i.have<19;)i.lens[U[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,N={bits:i.lenbits},L=s(0,i.lens,0,19,i.lencode,0,i.work,N),i.lenbits=N.bits,L){e.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;A=(x=i.lencode[g&(1<<i.lenbits)-1])>>>16&255,R=65535&x,!((S=x>>>24)<=v);){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if(R<16)g>>>=S,v-=S,i.lens[i.have++]=R;else{if(16===R){for(P=S+2;v<P;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if(g>>>=S,v-=S,0===i.have){e.msg="invalid bit length repeat",i.mode=30;break}O=i.lens[i.have-1],w=3+(3&g),g>>>=2,v-=2}else if(17===R){for(P=S+3;v<P;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}v-=S,O=0,w=3+(7&(g>>>=S)),g>>>=3,v-=3}else{for(P=S+7;v<P;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}v-=S,O=0,w=11+(127&(g>>>=S)),g>>>=7,v-=7}if(i.have+w>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=30;break}for(;w--;)i.lens[i.have++]=O}}if(30===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,N={bits:i.lenbits},L=s(1,i.lens,0,i.nlen,i.lencode,0,i.work,N),i.lenbits=N.bits,L){e.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,N={bits:i.distbits},L=s(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,N),i.distbits=N.bits,L){e.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(6<=f&&258<=m){e.next_out=p,e.avail_out=m,e.next_in=h,e.avail_in=f,i.hold=g,i.bits=v,o(e,b),p=e.next_out,u=e.output,m=e.avail_out,h=e.next_in,d=e.input,f=e.avail_in,g=i.hold,v=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;A=(x=i.lencode[g&(1<<i.lenbits)-1])>>>16&255,R=65535&x,!((S=x>>>24)<=v);){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if(A&&!(240&A)){for(k=S,C=A,D=R;A=(x=i.lencode[D+((g&(1<<k+C)-1)>>k)])>>>16&255,R=65535&x,!(k+(S=x>>>24)<=v);){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}g>>>=k,v-=k,i.back+=k}if(g>>>=S,v-=S,i.back+=S,i.length=R,0===A){i.mode=26;break}if(32&A){i.back=-1,i.mode=12;break}if(64&A){e.msg="invalid literal/length code",i.mode=30;break}i.extra=15&A,i.mode=22;case 22:if(i.extra){for(P=i.extra;v<P;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}i.length+=g&(1<<i.extra)-1,g>>>=i.extra,v-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;A=(x=i.distcode[g&(1<<i.distbits)-1])>>>16&255,R=65535&x,!((S=x>>>24)<=v);){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if(!(240&A)){for(k=S,C=A,D=R;A=(x=i.distcode[D+((g&(1<<k+C)-1)>>k)])>>>16&255,R=65535&x,!(k+(S=x>>>24)<=v);){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}g>>>=k,v-=k,i.back+=k}if(g>>>=S,v-=S,i.back+=S,64&A){e.msg="invalid distance code",i.mode=30;break}i.offset=R,i.extra=15&A,i.mode=24;case 24:if(i.extra){for(P=i.extra;v<P;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}i.offset+=g&(1<<i.extra)-1,g>>>=i.extra,v-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===m)break e;if(w=b-m,i.offset>w){if((w=i.offset-w)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=30;break}I=w>i.wnext?(w-=i.wnext,i.wsize-w):i.wnext-w,w>i.length&&(w=i.length),T=i.window}else T=u,I=p-i.offset,w=i.length;for(m<w&&(w=m),m-=w,i.length-=w;u[p++]=T[I++],--w;);0===i.length&&(i.mode=21);break;case 26:if(0===m)break e;u[p++]=i.length,m--,i.mode=21;break;case 27:if(i.wrap){for(;v<32;){if(0===f)break e;f--,g|=d[h++]<<v,v+=8}if(b-=m,e.total_out+=b,i.total+=b,b&&(e.adler=i.check=i.flags?a(i.check,u,b,p-b):n(i.check,u,b,p-b)),b=m,(i.flags?g:l(g))!==i.check){e.msg="incorrect data check",i.mode=30;break}v=g=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;v<32;){if(0===f)break e;f--,g+=d[h++]<<v,v+=8}if(g!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=30;break}v=g=0}i.mode=29;case 29:L=1;break e;case 30:L=-3;break e;case 31:return-4;default:return c}return e.next_out=p,e.avail_out=m,e.next_in=h,e.avail_in=f,i.hold=g,i.bits=v,(i.wsize||b!==e.avail_out&&i.mode<30&&(i.mode<27||4!==t))&&y(e,e.output,e.next_out,b-e.avail_out)?(i.mode=31,-4):(E-=e.avail_in,b-=e.avail_out,e.total_in+=E,e.total_out+=b,i.total+=b,i.wrap&&b&&(e.adler=i.check=i.flags?a(i.check,u,b,e.next_out-b):n(i.check,u,b,e.next_out-b)),e.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0==E&&0===b||4===t)&&0===L&&(L=-5),L)},i.inflateEnd=function(e){if(!e||!e.state)return c;var t=e.state;return t.window&&(t.window=null),e.state=null,0},i.inflateGetHeader=function(e,t){var i;return e&&e.state&&2&(i=e.state).wrap?((i.head=t).done=!1,0):c},i.inflateSetDictionary=function(e,t){var i,r=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?c:11===i.mode&&n(1,t,r,0)!==i.check?-3:y(e,t,r,r)?(i.mode=31,-4):(i.havedict=1,0):c},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,i){var r=e("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,c,l,d,u,h){var p,f,m,g,v,_,y,E,b,w=h.bits,I=0,T=0,S=0,A=0,R=0,k=0,C=0,D=0,O=0,L=0,N=null,P=0,x=new r.Buf16(16),M=new r.Buf16(16),U=null,F=0;for(I=0;I<=15;I++)x[I]=0;for(T=0;T<c;T++)x[t[i+T]]++;for(R=w,A=15;1<=A&&0===x[A];A--);if(A<R&&(R=A),0===A)return l[d++]=20971520,l[d++]=20971520,h.bits=1,0;for(S=1;S<A&&0===x[S];S++);for(R<S&&(R=S),I=D=1;I<=15;I++)if(D<<=1,(D-=x[I])<0)return-1;if(0<D&&(0===e||1!==A))return-1;for(M[1]=0,I=1;I<15;I++)M[I+1]=M[I]+x[I];for(T=0;T<c;T++)0!==t[i+T]&&(u[M[t[i+T]]++]=T);if(_=0===e?(N=U=u,19):1===e?(N=n,P-=257,U=a,F-=257,256):(N=o,U=s,-1),I=S,v=d,C=T=L=0,m=-1,g=(O=1<<(k=R))-1,1===e&&852<O||2===e&&592<O)return 1;for(;;){for(y=I-C,b=u[T]<_?(E=0,u[T]):u[T]>_?(E=U[F+u[T]],N[P+u[T]]):(E=96,0),p=1<<I-C,S=f=1<<k;l[v+(L>>C)+(f-=p)]=y<<24|E<<16|b,0!==f;);for(p=1<<I-1;L&p;)p>>=1;if(0!==p?(L&=p-1,L+=p):L=0,T++,0==--x[I]){if(I===A)break;I=t[i+u[T]]}if(R<I&&(L&g)!==m){for(0===C&&(C=R),v+=S,D=1<<(k=I-C);k+C<A&&!((D-=x[k+C])<=0);)k++,D<<=1;if(O+=1<<k,1===e&&852<O||2===e&&592<O)return 1;l[m=L&g]=R<<24|k<<16|v-d}}return 0!==L&&(l[v+L]=I-C<<24|64<<16),h.bits=R,0}},{"../utils/common":41}],51:[function(e,t,i){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,i){var r=e("../utils/common");function n(e){for(var t=e.length;0<=--t;)e[t]=0}var a=256,o=286,s=30,c=15,l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],d=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],p=new Array(576);n(p);var f=new Array(60);n(f);var m=new Array(512);n(m);var g=new Array(256);n(g);var v=new Array(29);n(v);var _,y,E,b=new Array(s);function w(e,t,i,r,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=n,this.has_stree=e&&e.length}function I(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function T(e){return e<256?m[e]:m[256+(e>>>7)]}function S(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function A(e,t,i){e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,S(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function R(e,t,i){A(e,i[2*t],i[2*t+1])}function k(e,t){for(var i=0;i|=1&e,e>>>=1,i<<=1,0<--t;);return i>>>1}function C(e,t,i){var r,n,a=new Array(16),o=0;for(r=1;r<=c;r++)a[r]=o=o+i[r-1]<<1;for(n=0;n<=t;n++){var s=e[2*n+1];0!==s&&(e[2*n]=k(a[s]++,s))}}function D(e){var t;for(t=0;t<o;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function O(e){8<e.bi_valid?S(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function L(e,t,i,r){var n=2*t,a=2*i;return e[n]<e[a]||e[n]===e[a]&&r[t]<=r[i]}function N(e,t,i){for(var r=e.heap[i],n=i<<1;n<=e.heap_len&&(n<e.heap_len&&L(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!L(t,r,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=r}function P(e,t,i){var r,n,o,s,c=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],n=e.pending_buf[e.l_buf+c],c++,0===r?R(e,n,t):(R(e,(o=g[n])+a+1,t),0!==(s=l[o])&&A(e,n-=v[o],s),R(e,o=T(--r),i),0!==(s=d[o])&&A(e,r-=b[o],s)),c<e.last_lit;);R(e,256,t)}function x(e,t){var i,r,n,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,d=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<l;i++)0!==a[2*i]?(e.heap[++e.heap_len]=d=i,e.depth[i]=0):a[2*i+1]=0;for(;e.heap_len<2;)a[2*(n=e.heap[++e.heap_len]=d<2?++d:0)]=1,e.depth[n]=0,e.opt_len--,s&&(e.static_len-=o[2*n+1]);for(t.max_code=d,i=e.heap_len>>1;1<=i;i--)N(e,a,i);for(n=l;i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],N(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=r,a[2*n]=a[2*i]+a[2*r],e.depth[n]=(e.depth[i]>=e.depth[r]?e.depth[i]:e.depth[r])+1,a[2*i+1]=a[2*r+1]=n,e.heap[1]=n++,N(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,r,n,a,o,s,l=t.dyn_tree,d=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(a=0;a<=c;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<573;i++)m<(a=l[2*l[2*(r=e.heap[i])+1]+1]+1)&&(a=m,g++),l[2*r+1]=a,d<r||(e.bl_count[a]++,o=0,f<=r&&(o=p[r-f]),s=l[2*r],e.opt_len+=s*(a+o),h&&(e.static_len+=s*(u[2*r+1]+o)));if(0!==g){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,g-=2}while(0<g);for(a=m;0!==a;a--)for(r=e.bl_count[a];0!==r;)d<(n=e.heap[--i])||(l[2*n+1]!==a&&(e.opt_len+=(a-l[2*n+1])*l[2*n],l[2*n+1]=a),r--)}}(e,t),C(a,d,e.bl_count)}function M(e,t,i){var r,n,a=-1,o=t[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(i+1)+1]=65535,r=0;r<=i;r++)n=o,o=t[2*(r+1)+1],++s<c&&n===o||(s<l?e.bl_tree[2*n]+=s:0!==n?(n!==a&&e.bl_tree[2*n]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=n,l=(s=0)===o?(c=138,3):n===o?(c=6,3):(c=7,4))}function U(e,t,i){var r,n,a=-1,o=t[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),r=0;r<=i;r++)if(n=o,o=t[2*(r+1)+1],!(++s<c&&n===o)){if(s<l)for(;R(e,n,e.bl_tree),0!=--s;);else 0!==n?(n!==a&&(R(e,n,e.bl_tree),s--),R(e,16,e.bl_tree),A(e,s-3,2)):s<=10?(R(e,17,e.bl_tree),A(e,s-3,3)):(R(e,18,e.bl_tree),A(e,s-11,7));a=n,l=(s=0)===o?(c=138,3):n===o?(c=6,3):(c=7,4)}}n(b);var F=!1;function B(e,t,i,n){var a,o,s;A(e,0+(n?1:0),3),o=t,s=i,O(a=e),S(a,s),S(a,~s),r.arraySet(a.pending_buf,a.window,o,s,a.pending),a.pending+=s}i._tr_init=function(e){F||(function(){var e,t,i,r,n,a=new Array(16);for(r=i=0;r<28;r++)for(v[r]=i,e=0;e<1<<l[r];e++)g[i++]=r;for(g[i-1]=r,r=n=0;r<16;r++)for(b[r]=n,e=0;e<1<<d[r];e++)m[n++]=r;for(n>>=7;r<s;r++)for(b[r]=n<<7,e=0;e<1<<d[r]-7;e++)m[256+n++]=r;for(t=0;t<=c;t++)a[t]=0;for(e=0;e<=143;)p[2*e+1]=8,e++,a[8]++;for(;e<=255;)p[2*e+1]=9,e++,a[9]++;for(;e<=279;)p[2*e+1]=7,e++,a[7]++;for(;e<=287;)p[2*e+1]=8,e++,a[8]++;for(C(p,287,a),e=0;e<s;e++)f[2*e+1]=5,f[2*e]=k(e,5);_=new w(p,l,257,o,c),y=new w(f,d,0,s,c),E=new w(new Array(0),u,0,19,7)}(),F=!0),e.l_desc=new I(e.dyn_ltree,_),e.d_desc=new I(e.dyn_dtree,y),e.bl_desc=new I(e.bl_tree,E),e.bi_buf=0,e.bi_valid=0,D(e)},i._tr_stored_block=B,i._tr_flush_block=function(e,t,i,r){var n,o,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),x(e,e.l_desc),x(e,e.d_desc),s=function(e){var t;for(M(e,e.dyn_ltree,e.l_desc.max_code),M(e,e.dyn_dtree,e.d_desc.max_code),x(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*h[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=n&&(n=o)):n=o=i+5,i+4<=n&&-1!==t?B(e,t,i,r):4===e.strategy||o===n?(A(e,2+(r?1:0),3),P(e,p,f)):(A(e,4+(r?1:0),3),function(e,t,i,r){var n;for(A(e,t-257,5),A(e,i-1,5),A(e,r-4,4),n=0;n<r;n++)A(e,e.bl_tree[2*h[n]+1],3);U(e,e.dyn_ltree,t-1),U(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),P(e,e.dyn_ltree,e.dyn_dtree)),D(e),r&&O(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(g[i]+a+1)]++,e.dyn_dtree[2*T(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){var t;A(e,2,3),R(e,256,p),16===(t=e).bi_valid?(S(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,i){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){(function(e){!function(e){if(!e.setImmediate){var t,i,r,n,a=1,o={},s=!1,c=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,t="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){u(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?(n="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",h,!1):e.attachEvent("onmessage",h),function(t){e.postMessage(n+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){u(e.data)},function(e){r.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(i=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){u(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):function(e){setTimeout(u,0,e)},l.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var i=new Array(arguments.length-1),r=0;r<i.length;r++)i[r]=arguments[r+1];var n={callback:e,args:i};return o[a]=n,t(a),a++},l.clearImmediate=d}function d(e){delete o[e]}function u(e){if(s)setTimeout(u,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(undefined,i)}}(t)}finally{d(e),s=!1}}}}function h(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(n)&&u(+t.data.slice(n.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)})}),yA=pA((e,t)=>{var i=Object.prototype.hasOwnProperty,r="~";function n(){}function a(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function o(e,t,i,n,o){if("function"!=typeof i)throw new TypeError("The listener must be a function");var s=new a(i,n||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function c(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),c.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)i.call(e,t)&&n.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},c.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var n=0,a=i.length,o=new Array(a);n<a;n++)o[n]=i[n].fn;return o},c.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},c.prototype.emit=function(e,t,i,n,a,o){var s=r?r+e:e;if(!this._events[s])return!1;var c,l,d=this._events[s],u=arguments.length;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,t),!0;case 3:return d.fn.call(d.context,t,i),!0;case 4:return d.fn.call(d.context,t,i,n),!0;case 5:return d.fn.call(d.context,t,i,n,a),!0;case 6:return d.fn.call(d.context,t,i,n,a,o),!0}for(l=1,c=new Array(u-1);l<u;l++)c[l-1]=arguments[l];d.fn.apply(d.context,c)}else{var h,p=d.length;for(l=0;l<p;l++)switch(d[l].once&&this.removeListener(e,d[l].fn,void 0,!0),u){case 1:d[l].fn.call(d[l].context);break;case 2:d[l].fn.call(d[l].context,t);break;case 3:d[l].fn.call(d[l].context,t,i);break;case 4:d[l].fn.call(d[l].context,t,i,n);break;default:if(!c)for(h=1,c=new Array(u-1);h<u;h++)c[h-1]=arguments[h];d[l].fn.apply(d[l].context,c)}}return!0},c.prototype.on=function(e,t,i){return o(this,e,t,i,!1)},c.prototype.once=function(e,t,i){return o(this,e,t,i,!0)},c.prototype.removeListener=function(e,t,i,n){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn===t&&(!n||o.once)&&(!i||o.context===i)&&s(this,a);else{for(var c=0,l=[],d=o.length;c<d;c++)(o[c].fn!==t||n&&!o[c].once||i&&o[c].context!==i)&&l.push(o[c]);l.length?this._events[a]=1===l.length?l[0]:l:s(this,a)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,void 0!==t&&(t.exports=c)}),EA=pA((e,t)=>{var i=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(i).forEach(function(e){i[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})}),bA=pA(e=>{var t=function(e){return String(Number(e))===e?Number(e):e},i=function(e,i,r){var n=e.name&&e.names;e.push&&!i[e.push]?i[e.push]=[]:n&&!i[e.name]&&(i[e.name]={});var a=e.push?{}:n?i[e.name]:i;(function(e,i,r,n){if(n&&!r)i[n]=t(e[1]);else for(var a=0;a<r.length;a+=1)null!=e[a+1]&&(i[r[a]]=t(e[a+1]))})(r.match(e.reg),a,e.names,e.name),e.push&&i[e.push].push(a)},r=EA(),n=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},a=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(n).forEach(function(e){var t=e[0],n=e.slice(2);"m"===t&&(a.push({rtp:[],fmtp:[]}),o=a[a.length-1]);for(var s=0;s<(r[t]||[]).length;s+=1){var c=r[t][s];if(c.reg.test(n))return i(c,o,n)}}),t.media=a,t};var a=function(e,i){var r=i.split(/=(.+)/,2);return 2===r.length?e[r[0]]=t(r[1]):1===r.length&&i.length>1&&(e[r[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(a,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var i=[],r=e.split(" ").map(t),n=0;n<r.length;n+=3)i.push({component:r[n],ip:r[n+1],port:r[n+2]});return i},e.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})})},e.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var i,r=!1;return"~"!==e[0]?i=t(e):(i=t(e.substring(1,e.length)),r=!0),{scid:i,paused:r}})})}}),wA=pA((e,t)=>{var i=EA(),r=/%[sdv%]/g,n=function(e){var t=1,i=arguments,n=i.length;return e.replace(r,function(e){if(t>=n)return e;var r=i[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(r);case"%d":return Number(r);case"%v":return""}})},a=function(e,t,i){var r=[e+"="+(t.format instanceof Function?t.format(t.push?i:i[t.name]):t.format)];if(t.names)for(var a=0;a<t.names.length;a+=1){var o=t.names[a];t.name?r.push(i[t.name][o]):r.push(i[t.names[a]])}else r.push(i[t.name]);return n.apply(null,r)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],s=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var r=t.outerOrder||o,n=t.innerOrder||s,c=[];return r.forEach(function(t){i[t].forEach(function(i){i.name in e&&null!=e[i.name]?c.push(a(t,i,e)):i.push in e&&null!=e[i.push]&&e[i.push].forEach(function(e){c.push(a(t,i,e))})})}),e.media.forEach(function(e){c.push(a("m",i.m[0],e)),n.forEach(function(t){i[t].forEach(function(i){i.name in e&&null!=e[i.name]?c.push(a(t,i,e)):i.push in e&&null!=e[i.push]&&e[i.push].forEach(function(e){c.push(a(t,i,e))})})})}),c.join("\r\n")+"\r\n"}}),IA=pA(e=>{var t=bA(),i=wA(),r=EA();e.grammar=r,e.write=i,e.parse=t.parse,e.parseParams=t.parseParams,e.parseFmtpConfig=t.parseFmtpConfig,e.parsePayloads=t.parsePayloads,e.parseRemoteCandidates=t.parseRemoteCandidates,e.parseImageAttributes=t.parseImageAttributes,e.parseSimulcastStreamList=t.parseSimulcastStreamList}),TA=((QS=TA||{}).ROOM_DESTROY="1",QS.JOIN_START="21",QS.JOIN_SCHEDULE_SUCCESS="22",QS.JOIN_SIGNAL_CONNECTION_START="23",QS.JOIN_SIGNAL_CONNECTION_END="24",QS.JOIN_SEND_CMD="25",QS.JOIN_RECEIVED_CMD_RES="26",QS.JOIN_SUCCESS="27",QS.JOIN_FAILED="28",QS.LEAVE_START="51",QS.LEAVE_SEND_CMD="52",QS.LEAVE_SUCCESS="53",QS.PUBLISH_START="61",QS.SEND_FIRST_VIDEO_FRAME="62",QS.PUBLISH_FAILED="63",QS.SUBSCRIBE_START="81",QS.SUBSCRIBE_SUCCESS="82",QS.SUBSCRIBE_FAILED="84",QS.UNSUBSCRIBE_SUCCESS="83",QS.LOCAL_TRACK_CAPTURE_START="101",QS.LOCAL_TRACK_CAPTURE_SUCCESS="102",QS.LOCAL_TRACK_CAPTURE_FAILED="103",QS.LOCAL_TRACK_PUBLISHED="104",QS.LOCAL_TRACK_UNPUBLISHED="105",QS.LOCAL_TRACK_REPLACED="106",QS.SWITCH_DEVICE_SUCCESS="107",QS.TRACK_MUTED="108",QS.TRACK_UNMUTED="109",QS.REMOTE_TRACK_SUBSCRIBED="110",QS.REMOTE_TRACK_UNSUBSCRIBED="111",QS.LOCAL_TRACK_RECAPTURE="112",QS.LOCAL_AUDIO_STARTED="113",QS.LOCAL_AUDIO_STOPPED="114",QS.REMOTE_AUDIO_STARTED="115",QS.REMOTE_AUDIO_STOPPED="116",QS.PLAY_TRACK_START="151",QS.PLAYER_STATE_CHANGED="152",QS.VIDEO_LOADED_DATA="153",QS.AUTOPLAY_DIALOG_CLICK_CONFIRM="154",QS.AUDIO_CONTEXT_LONG_SUSPENDED="155",QS.REMOTE_VIDEO_PLAY_START="156",QS.REMOTE_VIDEO_PLAY_FINISH="157",QS.SIGNAL_CONNECTION_STATE_CHANGED="201",QS.PEER_CONNECTION_STATE_CHANGED="202",QS.SINGLE_CONNECTION_STAT="203",QS.SPC_RECONNECTED="204",QS.HEARTBEAT_REPORT="251",QS.RECEIVED_PUBLISHED_USER_LIST="252",QS.REMOTE_PUBLISH_STATE_CHANGED="253",QS.AUDIO_LEVEL_INTERVAL="260",QS.NETWORK_QUALITY="261",QS.VIDEO_CODEC_IMPLEMENTATION_CHANGED="262",QS.QUALITY_LIMITATION_CHANGED="263",QS.LOG="264",QS.AUDIO_PROCESSOR_DEBUG="265",QS.SSO_SWITCH="266",QS.SEI_MESSAGE="267",QS.USER_PAUSE_IN_PIP="268",QS.USER_RESUME_IN_PIP="269",QS.ENTER_PICTURE_IN_PICTURE="270",QS.LEAVE_PICTURE_IN_PICTURE="271",QS.SWITCH_ROOM_START="401",QS.SWITCH_ROOM_SUCCESS="407",QS.SWITCH_ROOM_FAILED="408",QS);function SA(e){return AA((t,i)=>async function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];let a=await t.apply(this,r);return await e.call(this,...r),a})}function AA(e){return function(t,i,r){return r.value=e(r.value,i),r}}var RA=new WeakMap;function kA(e,t){return AA((i,r)=>function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];let o=RA.get(this);o||(o=new Map,RA.set(this,o));let s=t(...n),c=o.get(s);if(!c||c<=0){i.apply(this,n);let t=setTimeout(()=>{var e;null==(e=RA.get(this))||e.delete(s)},e);o.set(s,t)}else{clearTimeout(c);let t=window.setTimeout(()=>{var e;i.apply(this,n),null==(e=RA.get(this))||e.delete(s)},e);o.set(s,t)}})}var CA,DA,OA=((CA=OA||{})[CA.none=0]="none",CA[CA.horizontal=1]="horizontal",CA[CA.vertical=2]="vertical",CA),LA="5.0.0",NA="undefined"!=typeof importScripts,PA="undefined"!=typeof registerProcessor,xA="https://".concat("web.sdk.qcloud.com","/trtc/webrtc/doc"),MA="https://cloud.tencent.com/document/product/647/85386",UA="https://trtc.io/document/56025",FA="jssdk_log",BA="qcloud",VA=((DA=VA||{})[DA.TRACE=0]="TRACE",DA[DA.DEBUG=1]="DEBUG",DA[DA.INFO=2]="INFO",DA[DA.WARN=3]="WARN",DA[DA.ERROR=4]="ERROR",DA[DA.NONE=5]="NONE",DA),HA={unknown:0,wifi:1,"4g":2,"3g":3,"2g":4,wired:5,"5g":6},jA={width:640,height:480,frameRate:15,bitrate:500},zA="canvas",WA="audio",GA="video",qA="screen",KA="big",YA="mute",XA="unmute",ZA="ended",JA="playing",QA="pause",$A="error",eR="loadstart",tR="loadeddata",iR="loadedmetadata",rR="audioinput",nR="videoinput",aR="enterpictureinpicture",oR="leavepictureinpicture",sR="fullscreenchange",cR="resize",lR="player-error",dR="load-worklet",uR="getUserMedia-retry",hR="default",pR=2e3,fR=["width","height","frameRate","facingMode","sampleRate","sampleSize","channelCount","deviceId","min","max"],mR={alpha:!0,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0,powerPreference:"low-power"};function gR(e){let{frame:t,onDump:i}=e;return null==i||i(),t}function vR(e){let{frame:t,onDump:i}=e;return null==i||i(),t}function _R(e){let{frame:t,onDump:i}=e;return null==i||i(),t}function yR(e){let{frame:t,onDump:i}=e;return null==i||i(),t}var ER="Log",bR="Network",wR="Dump",IR="Dump (PCM)",TR="Dump (Opus)",SR="Dumping",AR="End",RR="Upload Log",kR="Export Log",CR="Hide",DR="goBottom",OR="backTop",LR="Clear Log",NR="Uplink",PR="Downlink",xR="No Data",MR="Basic",UR="Duration",FR="Video",BR="Audio",VR="Screen",HR={"play() error: NotAllowedError:":{tips:e=>e.includes("main <video>")||e.includes("main <audio>")?"Remote stream auto play is restricted and playback fails":"Local stream playback failure, generally only occurs in Android WeChat devices, no need to handle",color:"red",class:"red"},"updateStream() try to recover local stream":{tips:"Device acquisition exception, automatic recovery is in progress"},"updateStream() recover local stream successfully":{tips:"Device acquisition exception, automatic recovery is successful"},"updateStream() failed to recover local stream":{tips:"Device acquisition exception, automatic recovery failed"},"main stream - video track is muted":{tips:"Indicates that the received video data is not enough for playback. This is usually caused by network reasons. When enough data is received for playback, the state will change to unmuted."},"main stream - audio track is muted":{tips:"Indicates that the received audio data is not enough for playback. This is usually caused by network reasons. When enough data is received for playback, the state will change to unmuted."},"auxiliary stream - video track is muted":{tips:"Indicates that the received screen sharing data is not enough for playback. This is usually caused by network reasons. When enough data is received for playback, the state will change to unmuted."},"main stream - video track is unable to provide media output":{tips:"Indicates that the received video data is not enough for playback. This is usually caused by network reasons. When enough data is received for playback, the state will change to unmuted."},"main stream - audio track is unable to provide media output":{tips:"Indicates that the received audio data is not enough for playback. This is usually caused by network reasons. When enough data is received for playback, the state will change to unmuted."},"auxiliary stream - video track is unable to provide media output":{tips:"Indicates that the received screen sharing data is not enough for playback. This is usually caused by network reasons. When enough data is received for playback, the state will change to unmuted."},"main stream - video track is unmuted":{tips:"Received enough playback video data"},"main stream - audio track is unmuted":{tips:"Received enough playback audio data"},"auxiliary stream - video track is unmuted":{tips:"Received enough playback screen sharing data"},"main stream - audio player track is ended":{tips:"Remote audio track stopped"},"main stream - video player track is ended":{tips:"Remote video track stopped"},"auxiliary stream - video player track is ended":{tips:"Received enough playback screen sharing data"},"stream - video track is muted":{tips:"Camera capture is paused, usually due to the device being occupied by other applications or the browser media permission being revoked. The client needs to re-capture.",color:"orange"},"stream - video track is unable to provide media output":{tips:"The camera acquisition is paused, usually because the device is occupied by other applications or the browser media permissions are revoked, and the customer needs to re-acquire. SDK v4.11.4+ will automatically resume acquisition without customer intervention",color:"orange"},"video track is unable to provide media output":{tips:e=>e.includes("↓")?"The remote track is temporarily unable to decode data, which may be caused by network fluctuations":"The camera acquisition is paused, usually because the device is occupied by other applications or the browser media permissions are revoked. The SDK will automatically resume the acquisition.",color:"orange"},"stream - video player track is ended":{tips:"The camera acquisition stops, usually because the device is unplugged. In this case, the SDK will automatically resume acquisition, and the access side does not need to handle it. It may also be caused by the device being occupied by other applications or the browser media permissions being reclaimed. It is recommended to remind the user to re-acquire on the page."},"video player track is ended":{tips:"The camera acquisition stops, usually because the device is unplugged. In this case, the SDK will automatically resume acquisition, and the access side does not need to handle it. It may also be caused by the device being occupied by other applications or the browser media permissions being reclaimed. It is recommended to remind the user to re-acquire on the page."},"stream - audio track is muted":{tips:"Microphone capture is paused, usually due to the device being occupied by other applications or the browser media permission being revoked. The client needs to re-capture.",color:"orange"},"audio track is unable to provide media output":{tips:e=>e.includes("↓")?"The remote track is temporarily unable to decode data, which may be caused by network fluctuations":"Microphone acquisition is paused, usually because the device is occupied by other applications or the browser media permissions are revoked. The SDK will automatically resume the acquisition.",color:"orange"},"stream - audio track is unable to provide media output":{tips:"The microphone acquisition is paused, usually because the device is occupied by other applications or the browser media permissions are revoked. The SDK will automatically resume the acquisition.",color:"orange"},"stream - audio player track is ended":{tips:"The microphone acquisition stops, usually because the device is unplugged. In this case, the SDK will automatically resume acquisition, and the access side does not need to handle it. It may also be caused by the device being occupied by other applications or the browser media permissions being reclaimed. It is recommended to remind the user to re-acquire on the page."},"audio player track is ended":{tips:"The microphone acquisition stops, usually because the device is unplugged. In this case, the SDK will automatically resume acquisition, and the access side does not need to handle it. It may also be caused by the device being occupied by other applications or the browser media permissions being reclaimed. It is recommended to remind the user to re-acquire on the page."},"is adding audio track to current published local stream":{tips:"add audio track",color:"orange"},"is removing audio track from current published local stream":{tips:"remove audio track",color:"orange"},"is removing video track from current published local stream":{tips:"remove video track",color:"orange"},"is adding video track to current published local stream":{tips:"add video track",color:"orange"},"is replacing audio track to current published local main stream":{tips:"replace audio track",color:"orange"},"is replacing video track to current published local main stream":{tips:"replace video track",color:"orange"},"downlink network quality change":{tips:"Downstream network quality change: 1: excellent, 2: good, 3: average, 4: poor, 5: extremely poor"},"uplink network quality change":{tips:"Upstream network quality change: 1: excellent, 2: good, 3: average, 4: poor, 5: extremely poor"},"localStream mute video":{tips:"mute upstream video stream",color:"orange"},"localStream unmute video":{tips:"unmute upstream video stream",color:"orange"},"localStream mute audio":{tips:"mute upstream audio stream",color:"orange"},"localStream unmute audio":{tips:"unmute upstream audio stream",color:"orange"},"black detected":{tips:"Detect black screen, which means fps = 0. It is usually caused by network, and the network will be recovered after a while. If the network is normal but has not been restored, it is an abnormal situation."},'main stream start to play with options: {"muted":true}':{tips:"Play the remote stream in silent mode. Generally, the remote stream does not need to be played in silent mode. You need to confirm whether the parameters passed in the client stream.play API call are correct.",color:"orange"},"main stream - audio player is starting playing":{tips:"Remote stream audio playback success",color:"#0dd90d",class:"success"},"main stream - video player is starting playing":{tips:"Remote stream video playback success",color:"#0dd90d",class:"success"},"video player is playing":{tips:"Local video playback success",color:"#0dd90d",class:"success"},"audio player is playing":{tips:"Local audio playback success",color:"#0dd90d",class:"success"},"stream - video player is starting playing":{tips:"Local video playback success",color:"#0dd90d",class:"success"},"stream - audio player is starting playing":{tips:"Local audio playback success",color:"#0dd90d",class:"success"},"switch camera success":{tips:"Switch camera success",color:"#0dd90d",class:"success"},"switch microphone success":{tips:"Switch microphone success",color:"#0dd90d",class:"success"},gotStream:{tips:"Local stream capture success"},"local stream is published successfully":{tips:"Publish success",color:"#0dd90d",class:"success"},"encoderImplementation change to OpenH264":{tips:"Use software encoding"},"encoderImplementation change to ExternalEncoder":{tips:"Use hardware encoding"},"getUserMedia with constraints":{tips:"Start media (camera/microphone) capture"},"getDisplayMedia with constraints":{tips:"Start screen sharing capture"},"client-banned":{tips:"Kicked out of the room",color:"red",class:"red",textColor:"#fff"},user_timeout:{tips:"The backend is too long without receiving SDK heartbeat, which is usually caused by the JS thread being blocked for a long time. If the reproduction probability is high, the application browser Performance tool analyzes where the JS thread is blocked.",color:"red",class:"red",textColor:"#fff"},"schedule failed":{tips:"Signaling request failed, does not affect the normal room entry process, SDK will connect to the default signaling domain."},"updateStream() video flag is true, but no camera detected, set video to false":{tips:"When trying to resume camera acquisition, the camera acquisition is not resumed because it is detected that there is no camera.",color:"orange",class:"orange",textColor:"#fff"},"qualityLimitationReason change to bandwidth":{tips:"bandwidth estimation is not enough to limit the quality of the encoding, which may cause the code rate, frame rate, and resolution to be lowered.",color:"orange",class:"orange",textColor:"#fff"},"qualityLimitationReason change to cpu":{tips:"cpu load is too high to limit the quality of the encoding, which may cause the code rate, frame rate, and resolution to be lowered.",color:"orange",class:"orange",textColor:"#fff"},"visibility change: hidden":{tips:"User page switched to backend, in mobile devices, this will cause the device to pause the capture, and it will be restored when the user switches backend to the frontend.",color:"orange",class:"orange",textColor:"#fff"},"visibility change: visible":{tips:"User page switched to frontend",color:"orange",class:"orange",textColor:"#fff"},"main stream - audio player is paused":{tips:"The remote stream audio playback is paused, which usually has two possibilities:\n        1. The business side passes in the div tag container for playing audio and video to be removed by the business side from the DOM.\n        2. If the user is in Chrome 70 and below, when the div container is moved, the playback will be paused.",color:"orange",class:"orange",textColor:"#fff"},"main stream - video player is paused":{tips:"The remote stream video playback is paused, which usually has two possibilities:\n 1. The business side passes in the div tag container for playing audio and video to be removed by the business side from the DOM.\n 2. If the user is in Chrome 70 and below, when the div container is moved, the playback will be paused.",color:"orange",class:"orange",textColor:"#fff"},'"displaySurface":"window"':{tips:"Screen sharing captures the application window",color:"blue",class:"blue",textColor:"#fff"},'"displaySurface":"monitor"':{tips:"Screen sharing captures the entire screen",color:"blue",class:"blue",textColor:"#fff"},'"displaySurface":"browser"':{tips:"Screen sharing captures a certain tab page",color:"blue",class:"blue",textColor:"#fff"},updateMediaSettings:{tips:"The resolution and frame rate below are the actual resolution and frame rate captured",color:"blue",class:"blue",textColor:"#fff"},"main stream start to play with":{tips:"Call remoteStream.play interface",color:"blue",class:"blue",textColor:"#fff"},"stream start to play with":{tips:"Call localStream.play interface",color:"blue",class:"blue",textColor:"#fff"},"main setAudioVolume to 0":{tips:"Business side calls remoteStream.setAudioVolume(0) interface to set the playback volume to 0, which will cause the playback to be silent",color:"orange",class:"orange",textColor:"#fff"},"screen sharing was stopped because the video track is ended":{tips:"Screen sharing capture stopped, possible reasons: user clicks the stop button, the window/page shared by the user is closed, etc.",color:"orange",class:"orange",textColor:"#fff"},"Join() => joining room":{tips:"Call client.join interface",color:"blue",class:"blue",textColor:"#fff"},"publish() => publishing local stream":{tips:"Call client.publish interface",color:"blue",class:"blue",textColor:"#fff"},"subscribe() => subscribe to":{tips:"Call client.subscribe interface",color:"blue",class:"blue",textColor:"#fff"},"switchRole() => switch role":{tips:"Call client.switchRole interface",color:"blue",class:"blue",textColor:"#fff"}};["enterRoom","exitRoom","switchRole","destroy","startLocalAudio","updateLocalAudio","stopLocalAudio","startLocalVideo","updateLocalVideo","stopLocalVideo","startScreenShare","updateScreenShare","stopScreenShare","startRemoteVideo","updateRemoteVideo","stopRemoteVideo","muteRemoteAudio","setRemoteAudioVolume"].forEach(e=>{HR["".concat(e,"()")]={tips:"Call trtc.".concat(e),color:"blue",class:"blue",textColor:"#fff"}});var jR,zR=Object.keys(HR),WR=mA(_A()),GR=((jR=GR||{})[jR.INVALID_PARAMETER=4096]="INVALID_PARAMETER",jR[jR.INVALID_OPERATION=4097]="INVALID_OPERATION",jR[jR.NOT_SUPPORTED=4098]="NOT_SUPPORTED",jR[jR.DEVICE_NOT_FOUND=4099]="DEVICE_NOT_FOUND",jR[jR.INITIALIZE_FAILED=4100]="INITIALIZE_FAILED",jR[jR.SIGNAL_CHANNEL_SETUP_FAILED=16385]="SIGNAL_CHANNEL_SETUP_FAILED",jR[jR.SIGNAL_CHANNEL_ERROR=16386]="SIGNAL_CHANNEL_ERROR",jR[jR.ICE_TRANSPORT_ERROR=16387]="ICE_TRANSPORT_ERROR",jR[jR.JOIN_ROOM_FAILED=16388]="JOIN_ROOM_FAILED",jR[jR.CREATE_OFFER_FAILED=16389]="CREATE_OFFER_FAILED",jR[jR.SIGNAL_CHANNEL_RECONNECTION_FAILED=16390]="SIGNAL_CHANNEL_RECONNECTION_FAILED",jR[jR.UPLINK_RECONNECTION_FAILED=16391]="UPLINK_RECONNECTION_FAILED",jR[jR.DOWNLINK_RECONNECTION_FAILED=16392]="DOWNLINK_RECONNECTION_FAILED",jR[jR.REMOTE_STREAM_NOT_EXIST=16400]="REMOTE_STREAM_NOT_EXIST",jR[jR.CLIENT_BANNED=16448]="CLIENT_BANNED",jR[jR.SERVER_TIMEOUT=16449]="SERVER_TIMEOUT",jR[jR.SUBSCRIPTION_TIMEOUT=16450]="SUBSCRIPTION_TIMEOUT",jR[jR.PLAY_NOT_ALLOWED=16451]="PLAY_NOT_ALLOWED",jR[jR.DEVICE_AUTO_RECOVER_FAILED=16452]="DEVICE_AUTO_RECOVER_FAILED",jR[jR.START_PUBLISH_CDN_FAILED=16453]="START_PUBLISH_CDN_FAILED",jR[jR.STOP_PUBLISH_CDN_FAILED=16454]="STOP_PUBLISH_CDN_FAILED",jR[jR.START_MIX_TRANSCODE_FAILED=16455]="START_MIX_TRANSCODE_FAILED",jR[jR.STOP_MIX_TRANSCODE_FAILED=16456]="STOP_MIX_TRANSCODE_FAILED",jR[jR.NOT_SUPPORTED_H264=16457]="NOT_SUPPORTED_H264",jR[jR.SWITCH_ROLE_FAILED=16458]="SWITCH_ROLE_FAILED",jR[jR.API_CALL_TIMEOUT=16459]="API_CALL_TIMEOUT",jR[jR.SCHEDULE_FAILED=16460]="SCHEDULE_FAILED",jR[jR.API_CALL_ABORTED=16461]="API_CALL_ABORTED",jR[jR.SPC_INITIALIZED_FAILED=16462]="SPC_INITIALIZED_FAILED",jR[jR.VIDEO_MANAGER_ERROR=16463]="VIDEO_MANAGER_ERROR",jR[jR.SWITCH_ROOM_FAILED=16464]="SWITCH_ROOM_FAILED",jR[jR.VIDEO_ENCODE_FAILED=16465]="VIDEO_ENCODE_FAILED",jR[jR.AUDIO_ENCODE_FAILED=16466]="AUDIO_ENCODE_FAILED",jR[jR.UNKNOWN=65535]="UNKNOWN",jR),qR=GR,KR=class extends Error{constructor(e){let{name:t="RtcError",message:i,code:r=qR.UNKNOWN,extraCode:n=0,constraint:a}=e,o="<".concat(function(e){for(let t in qR)if(qR[t]===e)return t;return"UNKNOWN"}(r)," 0x").concat(r.toString(16),">"),s="".concat(i).concat(a?" constraint: ".concat(a):"").concat(null!=i&&i.includes(o)?"":" ".concat(o));super(s),vA(this,"code"),vA(this,"extraCode"),vA(this,"message"),vA(this,"originMessage"),vA(this,"name"),vA(this,"constraint"),this.code=r,this.extraCode=n,this.name=t,this.message=s,this.constraint=a,this.originMessage=i}getCode(){return this.code}getExtraCode(){return this.extraCode}toString(){return this.originMessage}},YR=KR,XR=function(){return Date.now()+0},ZR=function(){let e=new Date;return e.setTime(XR()),e.toLocaleString()};fA({},{REPORT_TYPE:()=>kC,buildSSOPackage:()=>CC,bytes2ms:()=>Ck,calculateScaleResolutionDownNumber:()=>TC,concatArrayBuffers:()=>DC,convertObjectNumberToInt:()=>yC,copyProperties:()=>kk,deepClone:()=>lC,deepCloneBasic:()=>RC,deepMerge:()=>cC,delay:()=>EC,fibonacci:()=>Mk,formatedTime:()=>hC,getConstructorName:()=>Zk,getContainerFromElement:()=>uC,getEnv:()=>vk,getFirst16Bits:()=>LC,getInternalVersion:()=>iC,getLast16Bits:()=>OC,getLoggerUrl:()=>Ek,getMediaStreamTrackInfo:()=>IC,getMuteStateFromFlag:()=>aC,getNetworkType:()=>wk,getNumNetworkType:()=>Rk,getReconnectionTimeout:()=>Uk,getStringByteLength:()=>mC,getTestSignalDomain:()=>_k,getTurnServer:()=>oC,getUint32Version:()=>_C,getValueType:()=>Fk,getViewListFromView:()=>dC,glog:()=>Nk,ipv4ToUint32:()=>sC,isArray:()=>Gk,isAudioWorkletSupported:()=>Jk,isBoolean:()=>zk,isConstructor:()=>Xk,isEmpty:()=>nC,isFunction:()=>Bk,isLangChinese:()=>Pk,isMediaStreamTrack:()=>qk,isNumber:()=>jk,isObject:()=>Wk,isOverseaSdkAppId:()=>yk,isPlainObject:()=>xk,isPortrait:()=>gC,isPromise:()=>Yk,isRemoteTrack:()=>Kk,isRotate90Or270:()=>SC,isSetSinkIdSupported:()=>Qk,isString:()=>Hk,isUndefined:()=>Vk,loadImage:()=>vC,loadVideo:()=>AC,ms2bytes:()=>Ok,ms2samples:()=>Lk,normalizeUrl:()=>wC,performanceNow:()=>eC,promiseAny:()=>$k,samples2ms:()=>Dk,setNetworkTypeFromWebRTC:()=>Ak,stringify:()=>pC,stringifyIncludeValue:()=>fC,throttlePromise:()=>bC});var JR=function(e,t,i,r){return new(i||(i=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){e.done?n(e.value):function(e){return e instanceof i?e:new i(function(t){t(e)})}(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},QR=Symbol(32),$R=Symbol(16),ek=Symbol(8),tk=class{constructor(e){this.g=e,this.consumed=0,e&&(this.need=e.next().value)}setG(e){this.g=e,this.demand(e.next().value,!0)}consume(){this.buffer&&this.consumed&&(this.buffer.copyWithin(0,this.consumed),this.buffer=this.buffer.subarray(0,this.buffer.length-this.consumed),this.consumed=0)}demand(e,t){return t&&this.consume(),this.need=e,this.flush()}read(e){return JR(this,void 0,void 0,function*(){return this.lastReadPromise&&(yield this.lastReadPromise),this.lastReadPromise=new Promise((t,i)=>{var r;this.reject=i,this.resolve=e=>{delete this.lastReadPromise,delete this.resolve,delete this.need,t(e)},this.demand(e,!0)||null===(r=this.pull)||void 0===r||r.call(this,e)})})}readU32(){return this.read(QR)}readU16(){return this.read($R)}readU8(){return this.read(ek)}close(){var e;this.g&&this.g.return(),this.buffer&&this.buffer.subarray(0,0),null===(e=this.reject)||void 0===e||e.call(this,new Error("EOF")),delete this.lastReadPromise}flush(){if(!this.buffer||!this.need)return;let e=null,t=this.buffer.subarray(this.consumed),i=0,r=e=>t.length<(i=e);if("number"==typeof this.need){if(r(this.need))return;e=t.subarray(0,i)}else if(this.need===QR){if(r(4))return;e=t[0]<<24|t[1]<<16|t[2]<<8|t[3]}else if(this.need===$R){if(r(2))return;e=t[0]<<8|t[1]}else if(this.need===ek){if(r(1))return;e=t[0]}else if("buffer"in this.need){if("byteOffset"in this.need){if(r(this.need.byteLength-this.need.byteOffset))return;new Uint8Array(this.need.buffer,this.need.byteOffset).set(t.subarray(0,i)),e=this.need}else if(this.g)return void this.g.throw(new Error("Unsupported type"))}else{if(r(this.need.byteLength))return;new Uint8Array(this.need).set(t.subarray(0,i)),e=this.need}return this.consumed+=i,this.g?this.demand(this.g.next(e).value,!0):this.resolve&&this.resolve(e),e}write(e){if(e instanceof Uint8Array?this.malloc(e.length).set(e):"buffer"in e?this.malloc(e.byteLength).set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)):this.malloc(e.byteLength).set(new Uint8Array(e)),!this.g&&!this.resolve)return new Promise(e=>this.pull=e);this.flush()}writeU32(e){this.malloc(4).set([e>>24&255,e>>16&255,e>>8&255,255&e]),this.flush()}writeU16(e){this.malloc(2).set([e>>8&255,255&e]),this.flush()}writeU8(e){this.malloc(1)[0]=e,this.flush()}malloc(e){if(this.buffer){let t=this.buffer.length,i=t+e;if(i<=this.buffer.buffer.byteLength-this.buffer.byteOffset)this.buffer=new Uint8Array(this.buffer.buffer,this.buffer.byteOffset,i);else{let e=new Uint8Array(i);e.set(this.buffer),this.buffer=e}return this.buffer.subarray(t,i)}return this.buffer=new Uint8Array(e),this.buffer}};tk.U32=QR,tk.U16=$R,tk.U8=ek;var ik=128;function rk(e){let t=new tk;for(;e>=128;)t.malloc(1)[0]=255&e|ik,e>>>=7;return t.malloc(1)[0]=255&e,t.buffer||new Uint8Array(0)}function nk(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=new tk,r=t<<3;switch(typeof e){case"boolean":let n=i.malloc(2);n[0]=r,n[1]=e?1:0;break;case"number":i.malloc(1)[0]=r,i.write(rk(e));break;case"string":i.malloc(1)[0]=2|r;let a=(new TextEncoder).encode(e);i.write(rk(a.length));let o=i.malloc(a.length);for(let e=0;e<a.length;e++)o[e]=a[e];break;case"object":let s=new tk;if(Array.isArray(e))for(let t=0;t<e.length;t++){let i=nk(e[t],t+1);i&&s.write(i)}else{let t=1;for(let i in e){let r=nk(e[i],t++);r&&s.write(r)}}0===t?s.buffer&&i.write(s.buffer):(i.malloc(1)[0]=2|r,s.buffer&&(i.write(rk(s.buffer.length)),i.write(s.buffer)))}return i.buffer||new Uint8Array(0)}var ak=class{constructor(){vA(this,"buffer"),this.buffer=[]}get data(){return this.buffer}get length(){return this.buffer.length}writeInt32(e){this.buffer.push(e>>>24&255),this.buffer.push(e>>>16&255),this.buffer.push(e>>>8&255),this.buffer.push(255&e)}writeInt16(e){this.buffer.push(e>>>8&255),this.buffer.push(255&e)}writeByte(e){this.buffer.push(255&e)}writeBytes(e){for(let t=0;t<e.length;t++)this.buffer.push(e[t])}};function ok(e,t,i){e[i]=t>>>24&255,e[i+1]=t>>>16&255,e[i+2]=t>>>8&255,e[i+3]=255&t}function sk(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function ck(e,t){return e[t]}function lk(e,t,i){return(new TextDecoder).decode(function(e,t,i){return e.slice(t,t+i)}(e,t,i))}var dk=0,uk=2654435769,hk=16,pk=2,fk=7;function mk(e,t){let i=new ak,r=function(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"AVQualityReportSvc.C2S";return{version:arguments.length>4&&void 0!==arguments[4]?arguments[4]:2e3,encryption:arguments.length>5&&void 0!==arguments[5]?arguments[5]:2,d2:"",d2Len:0,uinType:arguments.length>6&&void 0!==arguments[6]?arguments[6]:30,uin:"",uinLen:0,reqHead:{seqNumber:i,appId:e,appidAtThird:new Uint8Array(0),a2:"",a2Len:0,serviceCmd:r,serviceCmdLen:0,cookie:"",cookieLen:0,imei:"",imeiLen:0,ksid:"",ksidLen:0,clientVersionInfo:"",clientVersionInfoLen:0},busiBuff:t}}(t,e,dk);dk=dk+1&2147483647,i.writeInt32(0),i.writeInt32(r.version),i.writeByte(r.encryption);let n=(new TextEncoder).encode(r.d2);i.writeInt32(n.length+4),n&&i.writeBytes(n),i.writeByte(r.uinType);let a=(new TextEncoder).encode(r.uin);i.writeInt32(a.length+4),a.length&&i.writeBytes(a);let o=new ak;o.writeInt32(0),o.writeInt32(r.reqHead.seqNumber),o.writeInt32(r.reqHead.appId),o.writeByte(r.reqHead.appId>>>24&255),o.writeByte(r.reqHead.appId>>>16&255),o.writeByte(r.reqHead.appId>>>8&255),o.writeByte(255&r.reqHead.appId);for(let _=4;_<16;_++)o.writeByte(0);let s=(new TextEncoder).encode(r.reqHead.a2);o.writeInt32(s.length+4),s.length&&o.writeBytes(s);let c=(new TextEncoder).encode(r.reqHead.serviceCmd);o.writeInt32(c.length+4),c.length&&o.writeBytes(c);let l=(new TextEncoder).encode(r.reqHead.cookie);o.writeInt32(l.length+4),l.length&&o.writeBytes(l);let d=(new TextEncoder).encode(r.reqHead.imei);o.writeInt32(d.length+4),d.length&&o.writeBytes(d);let u=(new TextEncoder).encode(r.reqHead.ksid);o.writeInt32(u.length+4),u.length&&o.writeBytes(u);let h=(new TextEncoder).encode(r.reqHead.clientVersionInfo);o.writeInt16(h.length+2),h.length&&o.writeBytes(h);let p=o.length;o.data[0]=p>>>24&255,o.data[1]=p>>>16&255,o.data[2]=p>>>8&255,o.data[3]=255&p,Hk(e)&&(e=(new TextEncoder).encode(e)),o.writeInt32(e.length+4),e.length&&o.writeBytes(e);let f=new Uint8Array(o.data),m=null;1===r.encryption?m=(new TextEncoder).encode(r.uin):2===r.encryption&&(m=new Uint8Array(16)),m&&(f=function(e,t){let i=e.length,r=(i+1+pk+fk)%8;r&&(r=8-r);let n=i+1+pk+fk+r,a=new Uint8Array(n),o=0,s=new Uint8Array(8),c=new Uint8Array(8),l=new Uint8Array(8),d=0;s[0]=248&Math.floor(256*Math.random())|r,d=1;for(let h=0;h<r;h++)s[d]=255&Math.floor(256*Math.random()),d+=1;for(let h=0;h<pk;)if(d<8&&(s[d]=255&Math.floor(256*Math.random()),d+=1,h+=1),8===d){gk(s,t,c,l,a,o),o+=8,d=0;for(let e=0;e<8;e++)l[e]=a[o-8+e]}let u=0;for(;u<i;)if(d<8&&(s[d]=e[u],d+=1,u+=1),8===d){gk(s,t,c,l,a,o),o+=8,d=0;for(let e=0;e<8;e++)l[e]=a[o-8+e]}for(let h=0;h<fk;)if(d<8&&(s[d]=0,d+=1,h+=1),8===d){gk(s,t,c,l,a,o),o+=8,d=0;for(let e=0;e<8;e++)l[e]=a[o-8+e]}return a}(f,m)),i.writeBytes(f);let g=new Uint8Array(i.data),v=g.length;return g[0]=v>>>24&255,g[1]=v>>>16&255,g[2]=v>>>8&255,g[3]=255&v,g}function gk(e,t,i,r,n,a){for(let o=0;o<8;o++)e[o]^=r[o];!function(e,t,i,r){let n=sk(e,0),a=sk(e,4),o=[];for(let c=0;c<4;c++)o[c]=sk(t,4*c);let s=0;for(let c=0;c<hk;c++)s+=uk,s>>>=0,n+=(a<<4)+o[0]^a+s^(a>>>5)+o[1],n>>>=0,a+=(n<<4)+o[2]^n+s^(n>>>5)+o[3],a>>>=0;ok(i,n,r),ok(i,a,r+4)}(e,t,n,a);for(let o=0;o<8;o++)n[a+o]^=i[o];for(let o=0;o<8;o++)i[o]=e[o]}var vk=function(){return new URLSearchParams(location.search).get("trtc_env")||""},_k=function(e){return e.includes(".")?e:"".concat(e).concat(".rtc.qq.com")},yk=e=>Number(e)<14e8,Ek=function(e,t){let i;i=yk(e)?"https://apisgp.my-imcloud.com":"https://yun.tim.qq.com";let r=Math.floor(Math.random()*2**31);return"".concat(i,"/v5/AVQualityReportSvc/C2S?random=").concat(r,"&sdkappid=").concat(e,"&cmdtype=").concat(t)},bk="unknown";function wk(){!function(){var e;Tk||(Tk=!0,null==(e=navigator.connection)||e.addEventListener("typechange",Ik))}();let{userAgent:e,connection:t}=navigator,i=(e.match(/NetType\/\S+/)||[])[0]||"";i=i.toLowerCase().replace("nettype/",""),"3gnet"===i&&(i="3g");let r=t&&t.type&&t.type.toLowerCase(),n=t&&t.effectiveType&&t.effectiveType.toLowerCase();return"slow-2"===n&&(n="2g"),r?Sk(r,n):bk}function Ik(){SO.warn("netType changed",wk())}var Tk=!1;function Sk(e,t){if(HA[e])return e;switch(e){case"cellular":case"wimax":return t||"unknown";case"ethernet":return"wired";default:return"unknown"}}function Ak(e){bk=Sk(e)}function Rk(){return HA[wk()]}function kk(e,t){for(let i of Reflect.ownKeys(t))if("constructor"!==i&&"prototype"!==i&&"name"!==i){let r=Object.getOwnPropertyDescriptor(t,i)||"";Object.defineProperty(e,i,r)}return e}function Ck(e){return Dk(e/4,arguments.length>1&&void 0!==arguments[1]?arguments[1]:48e3)}function Dk(e){return 1e3*e/(arguments.length>1&&void 0!==arguments[1]?arguments[1]:48e3)}function Ok(e){return 4*Lk(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:48e3)}function Lk(e){return e*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:48e3)/1e3}var Nk="undefined"!=typeof window&&"function"==typeof window.glog?window.glog:()=>{},Pk=()=>{let e=navigator.language;return e=e.substring(0,2),"zh"===e},xk=function(e){if(!e||"object"!=typeof e||"[object Object]"!=Object.prototype.toString.call(e))return!1;let t=Object.getPrototypeOf(e);if(null===t)return!0;let i=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&Function.prototype.toString.call(i)===Function.prototype.toString.call(Object)};function Mk(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e<=1?t:Mk(e-1,t,(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)+t)}function Uk(e){return e>8?3e4:1e3*Mk(e)}function Fk(e){return Reflect.apply(Object.prototype.toString,e,[]).replace(/^\[object\s(\w+)\]$/,"$1").toLowerCase()}var Bk=e=>"function"==typeof e,Vk=e=>void 0===e,Hk=e=>"string"==typeof e,jk=e=>"number"==typeof e,zk=e=>"boolean"==typeof e,Wk=e=>"object"===Fk(e),Gk=e=>"array"===Fk(e),qk=e=>Fk(e)==="MediaStreamTrack".toLowerCase(),Kk=e=>e.isRemote,Yk=e=>"promise"===Fk(e),Xk=e=>Bk(e)&&e.prototype.constructor===e,Zk=e=>Xk(e)?e.prototype.constructor.name:"",Jk="undefined"!=typeof AudioWorkletNode,Qk="undefined"!=typeof HTMLMediaElement&&"setSinkId"in HTMLMediaElement.prototype;function $k(e){return new Promise((t,i)=>{let r=[];e.forEach(n=>{n.then(t).catch(t=>{r.push(t),r.length===e.length&&i(r)})})})}function eC(){return performance&&performance.now?Math.floor(performance.now()):Date.now()}var tC=e=>+e<10?"0".concat(e):e,iC=e=>{let t=e.match(/^\d+\.\d+\.\d+/)[0];if(!t)return e;let i=t.split("."),r=tC(i[1])+tC(i[2]);return i[1]-15>0&&(i[1]="15"),i[2]-15>0&&(i[2]="15"),"".concat(i.join("."),".").concat(r)},rC=Object.prototype.hasOwnProperty;function nC(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e||"function"==typeof e||Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(xk(e))switch(Object.prototype.toString.call(e)){case"[object File]":case"[object Map]":case"[object Set]":return 0===e.size;case"[object Object]":for(let t in e)if(rC.call(e,t))return!1;return!0}return!1}function aC(e,t){return{userId:t,hasAudio:!!(8&e),hasVideo:!!(1&e),hasAuxiliary:!!(4&e),hasSmall:!!(2&e),audioMuted:!!(64&e),videoMuted:!!(16&e),audioAvailable:!(!(8&e)||64&e),videoAvailable:!(!(1&e)||16&e),hasDatachannel:!!(256&e)}}function oC(e){let t={urls:e.url.startsWith("turn:")||e.url.startsWith("turns:")?e.url:"turn:".concat(e.url)};return!Vk(e.username)&&!Vk(e.credential)&&(t.username=e.username,t.credential=e.credential,t.credentialType="password",Vk(e.credentialType)||(t.credentialType=e.credentialType)),t}function sC(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!Hk(e))return 0;let i=e.split(".");return t?(Number(i[0])<<24|Number(i[1])<<16|Number(i[2])<<8|Number(i[3]))>>>0:(Number(i[3])<<24|Number(i[2])<<16|Number(i[1])<<8|Number(i[0]))>>>0}var cC=function(e,t,i,r){if(!Wk(e)||!Wk(t))return 0;let n,a=0,o=Object.keys(t);for(let s=0,c=o.length;s<c;s++)if(n=o[s],!(Vk(t[n])||i&&i.includes(n)))if(Wk(e[n])&&Wk(t[n]))a+=cC(e[n],t[n],i,r);else{if(r&&r.includes(t[n]))continue;e[n]!==t[n]&&(e[n]=lC(t[n]),a+=1)}return a};function lC(e){if(Gk(e)){let t=[];return e.forEach((e,i)=>{t[i]=lC(e)}),t}if(Wk(e)){let t={};return Object.keys(e).forEach(i=>{t[i]=lC(e[i])}),t}return e}var dC=e=>{let t=[];if(Gk(e))t=[...e];else if(Hk(e)){let i=document.getElementById(e);i&&t.push(i)}else e&&t.push(e);return t},uC=e=>Hk(e)?document.getElementById(e):e,hC=()=>(e=>{let t=e=>e<10?"0".concat(e):"".concat(e),i=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),a=t(e.getHours()),o=t(e.getMinutes()),s=t(e.getSeconds());return"".concat(i,"/").concat(r,"/").concat(n," ").concat(a,":").concat(o,":").concat(s)})(new Date);function pC(e,t){let{keysToInclude:i,keysToExclude:r}=t;try{if(Gk(e))return"[".concat(e.map(e=>pC(e,{keysToInclude:i,keysToExclude:r})).join(","),"]");if(!xk(e)||!Gk(i)&&!Gk(r))return JSON.stringify(e);let t={},n=new Set(i),a=new Set(r);return Object.keys(e).forEach(o=>{(0===a.size&&n.has(o)||0===n.size&&!a.has(o))&&(t[o]=xk(e[o])||Gk(e[o])?JSON.parse(pC(e[o],{keysToExclude:r,keysToInclude:i})):e[o])}),JSON.stringify(t)}catch(CA){return"{}"}}function fC(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[];return Object.keys(e).forEach(r=>{t===e[r]&&i.push(r)}),pC(e,{keysToInclude:i})}function mC(e){return e.replace(/[\u4e00-\u9fa5]/g,"aa").length}var gC=()=>{var e,t,i,r;return null!=(e=window.screen)&&e.orientation?!(null==(r=null==(i=null==(t=window.screen)?void 0:t.orientation)?void 0:i.type)||!r.includes("portrait")):0===window.orientation||180===window.orientation},vC=async e=>new Promise((t,i)=>{let r;if(Hk(e))r=new Image,r.crossOrigin="anonymous",r.src=e;else if(r=e,r.complete)return void t(r);r.onload=()=>t(r),r.onerror=()=>{i(new YR({code:qR.INVALID_PARAMETER,message:"load image failed, url: ".concat(e)}))}}),_C=e=>{let t=e.split(".");return+t[0]<<24|+t[1]<<16|+t[2]<<8|+t[3]},yC=e=>(Object.keys(e).forEach(t=>{jk(e[t])&&(t.startsWith("uint")||t.startsWith("int"))?e[t]=Math.floor(e[t]):(xk(e[t])||Gk(e[t]))&&yC(e[t])}),e);function EC(e,t){return new Promise(i=>{let r=setTimeout(i,e);t&&t(r)})}function bC(e,t){let i=null;return function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return i||(i=e.apply(t||this,n),i.finally(()=>i=null),i)}}function wC(e){return e.replace(/(^|[^:])\/{2,}/g,"$1/")}function IC(e){var t;try{let{width:i,height:r,frameRate:n,sampleRate:a,sampleSize:o,channelCount:s}=null==(t=e.getSettings)?void 0:t.call(e),c=e.kind===WA?"".concat(a,"x").concat(o,"@").concat(s):"".concat(i,"x").concat(r,"@").concat(n),l=e.stats?" stats: ".concat(JSON.stringify(e.stats).replaceAll('"',"")):"";return"".concat(e.id," ").concat(e.readyState," muted:").concat(e.muted," ").concat(e.kind," ").concat(e.label," ").concat(c).concat(l)}catch(fx){return""}}function TC(e,t){return e.width*e.height===t.width*t.height?1:gC()&&t.width>t.height&&e.height>t.width?Math.max(e.width/t.height,e.height/t.width,1):Math.max(e.width/t.width,e.height/t.height,1)}function SC(e){return 90===e||270===e}async function AC(e){return new Promise((t,i)=>{let r=document.createElement("video");r.crossOrigin="anonymous",r.src=e,r.muted=!0,r.loop=!0,r.playsInline=!0,r.play().then(()=>t(r)),r.onerror=()=>{i(r.error)}})}function RC(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new WeakMap;if("object"!=typeof e||null===e)return e;if(t.has(e))return t.get(e);if(Array.isArray(e)){let i=[];return t.set(e,i),e.forEach((e,r)=>{i[r]=RC(e,t)}),i}if("[object Object]"===Object.prototype.toString.call(e)){let i={};return t.set(e,i),Reflect.ownKeys(e).forEach(r=>{i[r]=RC(e[r],t)}),i}return e}var kC=(e=>(e[e.END_REPORT=2001]="END_REPORT",e[e.LOG=2002]="LOG",e[e.KEY_METRIC_REPORT=2003]="KEY_METRIC_REPORT",e))(kC||{});function CC(e,t,i,r){try{let n=function(e,t,i,r){let n={data:e,random:Math.floor(2147483648*Math.random()),sdkAppId:i};return Vk(r)||(n=uA(dA({},n),{gzip:+r})),{uint32_sdkappid:0,uint64_from_uin:0,uint32_timestamp:0,uint32_seq:0,msg_common_info:{msg_device_info:{enum_device_type:0,str_device_brand:"",str_device_model:"",str_device_board:"",str_device_cpu_abi:""},msg_system_info:{enum_os_type:0,str_os_version:"",msg_network_info:0},msg_network_info:{enum_network_type:0}},msg_report_content:{uint32_type:t,bytes_report_data:JSON.stringify(n)}}}(e,t,i,r);return mk(nk(n),i)}catch(n){return JSON.stringify(e)}}function DC(e,t){let i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e),0),i.set(new Uint8Array(t),e.byteLength),i.buffer}function OC(e){return(65535&e)>>>0}function LC(e){return(4294901760&e)>>>0}function NC(e){let t=function(e){try{let t={},i=0;t.totalLength=sk(e,i),i+=4,t.version=sk(e,i),i+=4,t.encryption=ck(e,i),i+=1,t.uinType=ck(e,i),i+=1,t.uinLength=sk(e,i),i+=4,t.uin=t.uinLength>4?lk(e,i,t.uinLength-4):"",i+=t.uinLength-4;let r=e.slice(i);if(2===t.encryption){e=function(e,t){let i=0,r=new Uint8Array(8).fill(0),n=new Uint8Array(e.slice(0,8)),a=PC(n,t),o=7&a[0],s=e.length-1-o-pk-fk,c=new Uint8Array(s),l=0,d=r,u=e.slice(0,8);i=8;let h=1;h+=o;for(let f=1;f<=pk;)if(h<8)h++,f++;else if(8===h){let r=xC(e,i,d,u,a,t);d=r.ivPreCrypt,u=r.ivCurCrypt,a=r.debiBuf,i=r.bufPos,h=0}let p=s;for(;p>0;)if(h<8)c[l++]=a[h]^d[h],h++,p--;else if(8===h){let r=xC(e,i,d,u,a,t);d=r.ivPreCrypt,u=r.ivCurCrypt,a=r.debiBuf,i=r.bufPos,h=0}for(let f=1;f<=fk;)if(h<8)a[h],d[h],h++,f++;else if(8===h){if(i>=e.length)break;let r=xC(e,i,d,u,a,t);if(!r.success)break;d=r.ivPreCrypt,u=r.ivCurCrypt,a=r.debiBuf,i=r.bufPos,h=0}return c}(r,new Uint8Array(16).fill(0)),t.decrypted=!0,i=0}else e=r,i=0;return t.rspHeadLength=sk(e,i),i+=4,t.seqNo=sk(e,i),i+=4,t.retCode=sk(e,i),i+=4,t.retStrLength=sk(e,i),i+=4,t.retStr=t.retStrLength?lk(e,i,t.retStrLength-4):"",i+=t.retStrLength-4,t.serviceCmdLength=sk(e,i),i+=4,t.serviceCmd=t.serviceCmdLength?lk(e,i,t.serviceCmdLength-4):"",i+=t.serviceCmdLength-4,t.cookieLength=sk(e,i),i+=4,t.cookie=t.cookieLength?lk(e,i,t.cookieLength-4):"",i+=t.cookieLength-4,t.flag=sk(e,i),i+=4,t.busiBuffLength=sk(e,i),i+=4,t.busiBuff=t.busiBuffLength?lk(e,i,t.busiBuffLength-4):"",i+=t.busiBuffLength-4,t}catch(t){}}(e);return null==t?void 0:t.busiBuff}function PC(e,t){let i=e[0]<<24|e[1]<<16|e[2]<<8|e[3],r=e[4]<<24|e[5]<<16|e[6]<<8|e[7];i>>>=0,r>>>=0;let n=uk*hk>>>0;for(let a=0;a<hk;a++)r-=(i<<4)+t[2]^i+n^(i>>>5)+t[3],r>>>=0,i-=(r<<4)+t[0]^r+n^(r>>>5)+t[1],i>>>=0,n-=uk,n>>>=0;return new Uint8Array([i>>>24&255,i>>>16&255,i>>>8&255,255&i,r>>>24&255,r>>>16&255,r>>>8&255,255&r])}function xC(e,t,i,r,n,a){if(t+8>e.length)return{success:!1};let o=new Uint8Array(r),s=e.slice(t,t+8),c=new Uint8Array(8);for(let l=0;l<8;l++)c[l]=n[l]^s[l];return{success:!0,ivPreCrypt:o,ivCurCrypt:s,debiBuf:PC(c,a),bufPos:t+8}}var MC="undefined"!=typeof TextDecoder?new TextDecoder:void 0;function UC(e){let{url:t,body:i,method:r="POST",timeout:n,priority:a}=e;return new Promise((e,o)=>{if("fetch"in window)return fetch(t,{method:r,body:i,priority:a}).then(e=>e.clone().json().then(e=>({data:e}),()=>e.arrayBuffer().then(e=>({data:NC(new Uint8Array(e))||(MC?MC.decode(e):e)})))).then(e,o);let s=new XMLHttpRequest;s.onreadystatechange=()=>{if(4===s.readyState)if(s.status>=200&&s.status<300)try{let t=JSON.parse(s.response);e({data:t})}catch(t){e({data:s.response})}else o({status:s.status,statusText:s.statusText||"request failed!"})},s.timeout=n||5e3,s.open(r,t,!0),s.send(i)})}var FC=Object.prototype.hasOwnProperty,BC=e=>"function"==typeof e,VC=e=>void 0===e,HC=e=>e.isRemote;function jC(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e||"function"==typeof e||Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(function(e){if(!e||"object"!=typeof e||"[object Object]"!=Object.prototype.toString.call(e))return!1;let t=Object.getPrototypeOf(e);if(null===t)return!0;let i=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&Function.prototype.toString.call(i)===Function.prototype.toString.call(Object)}(e))switch(Object.prototype.toString.call(e)){case"[object File]":case"[object Map]":case"[object Set]":return 0===e.size;case"[object Object]":for(let t in e)if(FC.call(e,t))return!1;return!0}return!1}var zC=function(e){let{retryFunction:t,settings:i,onError:r,onRetrying:n,onRetryFailed:a,onRetrySuccess:o,context:s}=e;return function(){for(var e=arguments.length,c=new Array(e),l=0;l<e;l++)c[l]=arguments[l];let{retries:d=5,timeout:u=1e3}=i,h=0,p=-1,f=0,m=async(e,i)=>{let l=s||this;try{let i=await t.apply(l,c);h>0&&o&&o.call(this,h),h=0,e(i)}catch(g){let t=()=>{clearTimeout(p),h=0,f=2,i(g)},o=()=>{2!==f&&h<(BC(d)?d():d)?(h++,f=1,BC(n)&&n.call(this,h,t),p=window.setTimeout(()=>{p=-1,m(e,i)},BC(u)?u(h):u)):(t(),BC(a)&&a.call(this,g))};BC(r)?r.call(this,{error:g,retry:o,reject:i,retryFuncArgs:c,retriedCount:h}):o()}};return new Promise(m)}},WC=class e{constructor(e){vA(this,"_parentPath"),vA(this,"userId"),vA(this,"remoteUserId"),vA(this,"id"),vA(this,"sdkAppId"),vA(this,"type"),vA(this,"isLocal"),this.id=e.id,this.userId=e.userId,this.sdkAppId=e.sdkAppId,this.remoteUserId=e.remoteUserId,this.isLocal=!(e=>"boolean"==typeof e)(e.isLocal)||e.isLocal,this.type=this.isLocal?"":e.type}getFullId(){return this._parentPath&&this.id?"".concat(this._parentPath,"-").concat(this.id):this._parentPath?this._parentPath:this.id}createChild(t){let i=new e({id:t.id,userId:VC(t.userId)?this.userId:t.userId,sdkAppId:VC(t.sdkAppId)?this.sdkAppId:t.sdkAppId,type:VC(t.type)?this.type:t.type,isLocal:VC(t.isLocal)?this.isLocal:t.isLocal,remoteUserId:VC(t.remoteUserId)?this.remoteUserId:t.remoteUserId});return i.bindParent(this),i}bindParent(e){let t=e.getFullId();this._parentPath!==t&&(this.debug("bind logger parent: ".concat(e.id)),this._parentPath=t,this.userId=e.userId||this.userId,this.sdkAppId=e.sdkAppId||this.sdkAppId)}setUserId(e){this.userId=e}setSdkAppId(e){this.sdkAppId=e}log(e,t){let i=this.isLocal?this.userId:this.remoteUserId,r=this.getFullId();t.unshift("[".concat(this.isLocal?"↑":"↓").concat(this.type&&"main"!==this.type?"*":"").concat(r).concat(i?"|".concat(i):"","]")),SO.log(e,t,VC(this.userId)||jC(this.userId),this.userId,this.sdkAppId)}info(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.log(2,t)}debug(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.log(1,t)}warn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.log(3,t)}error(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.log(4,t)}},GC="undefined"==typeof navigator?"":navigator.userAgent,qC=e=>new RegExp(e,"i").test(GC),KC=e=>{if(qC(e)){let t=new RegExp("".concat(e,"\\/([\\d.]+)")),i=GC.match(t);if(i&&i[1])return i[1]}return""},YC=e=>{if(qC(e)){let t=new RegExp("".concat(e,"\\/(\\d+)")),i=GC.match(t);if(i&&i[1])return parseFloat(i[1])}return NaN},XC=/AppleWebKit\/([\d.]+)/i.exec(GC);XC&&parseFloat(XC[1]);var ZC=qC("iPad"),JC="undefined"!=typeof navigator&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&qC("Macintosh"),QC=qC("iPhone")&&!ZC,$C=qC("iPod"),eD=QC||ZC||$C||JC,tD=()=>{try{return eD&&navigator.maxTouchPoints>1&&navigator.vendor.includes("Apple")}catch(JS){return eD}},iD=qC("Android"),rD=function(){if(iD){let e=GC.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(e){let t=e[1]&&parseFloat(e[1]),i=e[2]&&parseFloat(e[2]);if(t&&i)return parseFloat("".concat(e[1],".").concat(e[2]));if(t)return t}}return NaN}();iD&&qC("webkit");var nD=qC("Firefox"),aD=KC("Firefox"),oD=YC("Firefox"),sD=qC("Edge"),cD=KC("Edge"),lD=qC("Edg"),dD=KC("Edg"),uD=YC("Edg"),hD=qC("SogouMobileBrowser"),pD=KC("SogouMobileBrowser"),fD=qC("MetaSr\\s"),mD=KC("MetaSr\\s"),gD=qC("TBS"),vD=KC("TBS"),_D=qC("XWEB"),yD=KC("XWEB");qC("MSIE\\s8\\.0");var ED=qC("MSIE\\/\\d+");!function(){if(ED){let e=/MSIE\s(\d+)\.\d/.exec(GC),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(GC)&&/rv:11.0/.test(GC)&&(t=11),t}}();var bD=qC("(micromessenger|webbrowser)"),wD=KC("MicroMessenger"),ID=!gD&&qC("MQQBrowser")&&qC("COVC"),TD=!gD&&qC("MQQBrowser")&&!qC("COVC"),SD=TD||ID?KC("MQQBrowser"):"",AD=!gD&&qC(" QQBrowser"),RD=KC(" QQBrowser"),kD=!gD&&qC("QQBrowserLite"),CD=KC("QQBrowserLite"),DD=!gD&&qC("MQBHD"),OD=KC("MQBHD"),LD=qC("Windows"),ND=!eD&&qC("MAC OS X"),PD=!iD&&qC("Linux"),xD=qC("CrOS");qC("MicroMessenger");var MD=qC("UCBrowser");qC("Electron");var UD=qC("MiuiBrowser"),FD=KC("MiuiBrowser"),BD=qC("HuaweiBrowser"),VD=qC("Huawei")||qC("HUAWEI"),HD=qC("Honor")||qC("HONOR"),jD=KC("HuaweiBrowser"),zD=qC("SamsungBrowser"),WD=KC("SamsungBrowser"),GD=qC("HeyTapBrowser"),qD=KC("HeyTapBrowser"),KD=qC("VivoBrowser"),YD=KC("VivoBrowser"),XD=qC("OpenHarmony");KC("OpenHarmony");var ZD=()=>YC("Chrome"),JD=qC("CriOS"),QD=qC("Chrome"),$D=!sD&&!fD&&!hD&&!gD&&!_D&&!lD&&!AD&&!UD&&!BD&&!zD&&!GD&&!KD&&QD,eO=qC("HeadlessChrome"),tO=ZD(),iO=QD&&tO>=128&&tO<=143,rO=KC("Chrome");YC("Electron");var nO=!QD&&!TD&&!ID&&!kD&&!DD&&qC("Safari"),aO=nO||eD,oO=KC("Version");/Android.*(wv|.0.0.0)/.test(GC);var sO=(()=>{if(JC)return oO;if(eD){let e=GC.match(/OS (\d+)_(\d+)/i);if(e&&e[1]){let t=e[1];return e[2]&&(t+=".".concat(e[2])),t}}return""})();function cO(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.split(".").map(e=>Number(e)),n=t.split(".").map(e=>Number(e));for(let a=0;a<Math.max(r.length,n.length);a++){let e=r[a]||0,t=n[a]||0;if(e>t)return!0;if(e<t)return!1}return i}var lO=Number(sO.split(".")[0]),dO="15.1"===sO,uO=(()=>{let e=Number(sO.split(".")[0]);return 14===e||13===e})(),hO=JD&&"11.1.1"===oO,pO="undefined"!=typeof location&&("file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname),fO=(()=>{let e;return()=>{if(void 0===e)try{e=!!window.localStorage}catch(t){e=!1}return e}})(),mO=function(){let e=new Map([[nD,["Firefox",aD]],[lD,["Edg",dD]],[$D,["Chrome",rO]],[JD,["ChiOS",KC("CriOS")]],[nO&&!JD,["Safari",oO]],[gD,["TBS",vD]],[_D,["XWEB",yD]],[bD&&QC,["WeChat",wD]],[AD,["QQ(Win)",RD]],[TD,["QQ(Mobile)",SD]],[ID,["QQ(Mobile X5)",SD]],[kD,["QQ(Mac)",CD]],[DD,["QQ(iPad)",OD]],[UD,["MI",FD]],[BD,["HW",jD]],[zD,["Samsung",WD]],[GD,["OPPO",qD]],[KD,["VIVO",YD]],[sD,["EDGE",cD]],[hD,["SogouMobile",pD]],[fD,["Sogou",mD]]]),t="unknown",i="unknown";return e.has(!0)&&([t,i]=e.get(!0)),{name:t,version:i}}();function gO(){return function(){let e=/;\s*([^;)]+)\s+Build\//,t=GC.match(e);return null!=t&&t[1]?t[1].trim():null}()||""}var vO=new Map([[iD,"Android"],[eD,"iOS"],[LD,"Windows"],[ND,"MacOS"],[PD,"Linux"],[xD,"ChromeOS"]]),_O=function(){return vO.get(!0)?vO.get(!0):"unknown"};function yO(){return LD?1:iD?2:ND?3:eD?4:PD?5:xD?6:XD?7:0}var EO=()=>{let e=_O();return eD?e+="/".concat(sO):iD&&(e+="/".concat(rD)),e+="/".concat(mO.name,"/").concat(nO&&!JD?mO.version:mO.version.split(".")[0]),e},bO=new(mA(yA(),1).default),wO=TA,IO=new class{constructor(){vA(this,"enable",!1),vA(this,"ssoFailCount",0),bO.on("22",e=>{let{schedule:t}=e;var i;null!=(i=null==t?void 0:t.config)&&i.sso&&bO.emit("266",{enable:!0})}),bO.on("266",e=>{let{enable:t}=e;this.enable=t})}handleUploadFailed(){this.ssoFailCount++,this.ssoFailCount>3&&bO.emit("266",{enable:!1})}},TO=class e{constructor(){vA(this,"_isEnableUploadLog",!0),vA(this,"_localJoinedUser",new Map),vA(this,"_queue",[]),vA(this,"_timeoutId",-1),vA(this,"_logLevel",1),vA(this,"_logLevelToUpload",2),!NA&&!PA&&(this.checkURLParam(),this.installEvents())}get isAbleToUpload(){return this._isEnableUploadLog&&-1!==this._timeoutId}installEvents(){bO.on(wO.JOIN_SCHEDULE_SUCCESS,e=>{let{schedule:t}=e;var i;null!=(i=null==t?void 0:t.config)&&i.logLevelToUpload&&VA[t.config.logLevelToUpload]&&(this._logLevelToUpload=t.config.logLevelToUpload)}),bO.on(wO.JOIN_START,e=>{let{params:t}=e;this.addJoinedUser({userId:t.userId,sdkAppId:t.sdkAppId}),this.startUpload()}),bO.on(wO.LEAVE_SUCCESS,e=>{let{room:t}=e;this.deleteJoinedUser(t.userId)})}startUpload(){-1===this._timeoutId&&this.uploadInterval()}addJoinedUser(e){this._localJoinedUser.set(e.userId,e),this.startUpload()}deleteJoinedUser(e){this._localJoinedUser.delete(e)}uploadInterval(){this.upload().catch(()=>{}),this._timeoutId=window.setTimeout(()=>this.uploadInterval(),5e3)}getLogsToUpload(){let e={map:new Map,splicedQueue:[]};if(this._queue[0].forAllJoinedClients&&0===this._localJoinedUser.size)return e;let t=0;for(;t<this._queue.length&&50!==t;t++){let i=this._queue[t];if(i.forAllJoinedClients)this._localJoinedUser.forEach(t=>{let{userId:r,sdkAppId:n}=t;e.map.has(r)?e.map.get(r).logs.push(i):e.map.set(r,{userId:r,sdkAppId:n,logs:[i]})});else if(Hk(i.userId)&&jk(i.sdkAppId)){let{userId:t,sdkAppId:r}=i;e.map.has(t)?e.map.get(t).logs.push(i):e.map.set(t,{userId:t,sdkAppId:r,logs:[i]})}}return e.map.size>0&&(e.splicedQueue=this._queue.splice(0,t)),e}async upload(){if(0===this._queue.length||!this._isEnableUploadLog)return;let{map:e,splicedQueue:t}=this.getLogsToUpload();if(0===e.size)return;try{let t=[...e.values()];for(let e=0;e<t.length;e++){let{userId:i,sdkAppId:r,logs:n}=t[e],a={timestamp:ZR(),sdkAppId:String(r),userId:i,version:LA,log:n.map(e=>e.log).join("\n")},o=JSON.stringify(a),s=IO.enable?CC(a,2002,r):o;await this.uploadLogWithRetry(s,r,s instanceof Uint8Array,o),n.forEach(e=>e.uploaded=!0)}}catch(r){}let i=t.filter(e=>!e.uploaded);i.length>0&&(this._queue=i.concat(this._queue))}uploadLogWithRetry(e,t,i,r){return zC({retryFunction:()=>UC({url:Ek(t,FA),body:e,timeout:5e3,priority:"low"}).then(e=>{i&&"ok"!==e.data&&(IO.handleUploadFailed(),this.uploadLogWithRetry(r,t,!1,r))}),settings:{retries:3,timeout:2e3},onError:e=>{let{retry:t}=e;t()}})()}getPrefix(e){let t=new Date;return t.setTime(XR()),"[".concat(function(e){let t=String(e.getMilliseconds());return"padStart"in String.prototype&&(t=t.toString().padStart(3,"0")),"".concat(e.toTimeString().replace(/.*(\d{2}:\d{2}:\d{2}).*/,"$1"),":").concat(t)}(t),"] <").concat(VA[e],">")}getLogLevel(){return this._logLevel}setLogLevel(e){Vk(VA[e])||(this._logLevel!==e&&this.info("setLogLevel",e),this._logLevel=e)}enableUploadLog(){this._isEnableUploadLog=!0}disableUploadLog(){this.warn("disableUploadLog"),this._isEnableUploadLog=!1}logChunkToString(e){if(Hk(e))return e;try{return e instanceof Error?e.toString():JSON.stringify(e)}catch(fx){return""}}addLogToQueue(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a={log:t.reduce((e,t)=>"".concat(e," ").concat(this.logChunkToString(t)).trim(),""),level:e,userId:r,sdkAppId:n,forAllJoinedClients:i};bO.emit(wO.LOG,{log:a}),this._isEnableUploadLog&&e>=this._logLevelToUpload&&this._queue.push(a)}log(t,i){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;var o;if(i.unshift(this.getPrefix(t)),this.addLogToQueue(t,i,r,n,a),t<this._logLevel)return;let s=(null==(o=VA[t])?void 0:o.toLowerCase())||"info";e.PRINT_LOG_TAG?console[s]("%cTRTC%c%s","padding: 1px 4px;border-radius: 3px;color: #fff;background: #1E88E5;","display: inline",...i):console[s](...i)}debug(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.log(1,t)}info(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.log(2,t)}warn(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.log(3,t)}error(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.log(4,t)}createLogger(e){if(e.parent instanceof WC){let t=e,{parent:i}=t,r=((e,t)=>{var i={};for(var r in e)sA.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&aA)for(var r of aA(e))t.indexOf(r)<0&&cA.call(e,r)&&(i[r]=e[r]);return i})(t,["parent"]),n=new WC(r);return n.bindParent(i),n}return new WC(e)}checkURLParam(){let e=new URLSearchParams(location.search).get("logLevelToUpload"),t=e?Number(e):-1;VA[t]&&(this._logLevelToUpload=t)}getQueue(){return this._queue}};vA(TO,"PRINT_LOG_TAG",!(eD||iD||eO));var SO=new TO,AO=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},RO=new class{constructor(){vA(this,"_prefix","TRTC"),vA(this,"_queue",new Map)}getRealKey(e){return"".concat(this._prefix,"_").concat(e)}checkStorage(){fO()&&(setInterval(this.doFlush.bind(this),2e4),Object.keys(localStorage).filter(e=>{if(e.startsWith(this._prefix))try{let t=localStorage.getItem(e);if(!t)return!1;let i=JSON.parse(t);if(i&&i.expiresIn<Date.now())return!0}catch(t){return!1}return!1}).forEach(e=>localStorage.removeItem(e)))}doFlush(){if(fO())try{for(let[e,t]of this._queue)localStorage.setItem(e,JSON.stringify(t))}catch(e){SO.warn(e)}}getItem(e){if(!fO())return null;try{let t=localStorage.getItem(this.getRealKey(e));if(!t)return null;let i=JSON.parse(t);return i&&i.expiresIn>=Date.now()?i.value:null}catch(fx){SO.warn(fx)}}setItem(e,t){if(fO())try{let i={expiresIn:Date.now()+6048e5,value:t};this._queue.set(this.getRealKey(e),i)}catch(CA){SO.warn(CA)}}deleteItem(e){if(!fO())return!1;try{return e=this.getRealKey(e),this._queue.delete(e),localStorage.removeItem(e),!0}catch(fx){return SO.warn(fx),!1}}clear(){if(fO())try{localStorage.clear()}catch(e){SO.warn(e)}}};fA({},{HTTPS_API:()=>nL,IS_GET_CAPABILITIES_FROM_INPUTDEVICE_SUPPORTED:()=>AL,IS_GET_CAPABILITIES_SUPPORTED:()=>SL,IS_GET_SETTINGS_SUPPORTED:()=>TL,IS_GET_SYNCHRONIZATION_SOURCES_SUPPORTED:()=>IL,IS_INSERTABLE_STREAM_SUPPORTED:()=>RL,IS_JITTER_BUFFER_TARGET_SUPPORTED:()=>VL,IS_RTC_RTP_SENDER_SUPPORTED:()=>EL,IS_SCRIPT_TRANSFORM_SUPPORTED:()=>kL,IS_SEI_SUPPORTED:()=>CL,IS_SPC_SUPPORTED:()=>_L,basis:()=>xL,capabilityCheck:()=>FL,checkSystemRequirementsInternal:()=>JO,decodeSupportStatus:()=>ZO,detectH264SupportedByFakeStreaming:()=>iL,detectVideoCodecCapabilities:()=>zL,detectVideoDecoderCapabilities:()=>GL,detectVideoEncoderCapabilities:()=>WL,encodeSupportStatus:()=>XO,getBrowserInfo:()=>HO,getDisplayResolution:()=>oL,getH264ProfileLevelIds:()=>qL,isAddTransceiverSupported:()=>vL,isBrowserSupported:()=>jO,isCanvasCaptureStreamAPISupported:()=>lL,isCanvasSmallStreamSupported:()=>dL,isGetReceiversSupported:()=>fL,isGetSendersSupported:()=>mL,isGetTransceiversSupported:()=>gL,isGetUserMediaSupported:()=>sL,isMediaDevicesSupported:()=>WO,isMediaSessionSupported:()=>LL,isMediaStreamTrackGeneratorSupported:()=>YO,isMediaStreamTrackProcessorSupported:()=>KO,isReplaceTrackSupported:()=>bL,isRequestVideoFrameCallbackSupported:()=>BL,isSIMDSupported:()=>PL,isScaleResolutionDownBySupported:()=>uL,isScreenCaptureApiAvailable:()=>$O,isSelectedCandidatePair:()=>aL,isSetParametersSupported:()=>wL,isSetSinkIdSupported:()=>eL,isSmallStreamSupported:()=>hL,isStopTransceiverSupported:()=>yL,isTRTCSupported:()=>QO,isUnifiedPlanDefault:()=>pL,isUsedInHttpProtocol:()=>qO,isWebAudioSupported:()=>cL,isWebCodecSupported:()=>OL,isWebCodecsSupported:()=>zO,isWebRTCSupported:()=>DL,isWebTransportSupported:()=>NL});var kO={AVOID_REPEATED_CALL:"AVOID_REPEATED_CALL",INVALID_PARAMETER_REQUIRED:"INVALID_PARAMETER_REQUIRED",INVALID_PARAMETER_TYPE:"INVALID_PARAMETER_TYPE",INVALID_PARAMETER_EMPTY:"INVALID_PARAMETER_EMPTY",INVALID_PARAMETER_INSTANCE:"INVALID_PARAMETER_INSTANCE",INVALID_PARAMETER_RANGE:"INVALID_PARAMETER_RANGE",INVALID_PARAMETER_MIN:"INVALID_PARAMETER_MIN",INVALID_PARAMETER_MAX:"INVALID_PARAMETER_MAX",INVALID_PARAMETER_STREAMTYPE:"INVALID_PARAMETER_STREAMTYPE",API_CALL_TIMEOUT:"API_CALL_TIMEOUT",SIGNAL_CHANNEL_RECONNECTION_FAILED:"SIGNAL_CHANNEL_RECONNECTION_FAILED",SIGNAL_CHANNEL_SETUP_FAILED:"SIGNAL_CHANNEL_SETUP_FAILED",ERROR_MESSAGE:"ERROR_MESSAGE",EXCHANGE_SDP_TIMEOUT:"EXCHANGE_SDP_TIMEOUT",DOWNLINK_RECONNECTION_FAILED:"DOWNLINK_RECONNECTION_FAILED",EXCHANGE_SDP_FAILED:"EXCHANGE_SDP_FAILED",UPDATE_OFFER_TIMEOUT:"UPDATE_OFFER_TIMEOUT",UPLINK_RECONNECTION_FAILED:"UPLINK_RECONNECTION_FAILED",INVALID_RECORDID:"INVALID_RECORDID",INVALID_PURE_AUDIO:"INVALID_PURE_AUDIO",INVALID_STREAMID:"INVALID_STREAMID",INVALID_USER_DEFINE_RECORDID:"INVALID_USER_DEFINE_RECORDID",INVALID_USER_DEFINE_PUSH_ARGS:"INVALID_USER_DEFINE_PUSH_ARGS",INVALID_PROXY:"INVALID_PROXY",INVALID_JOIN:"INVALID_JOIN",INVALID_ROOMID_STRING:"INVALID_ROOMID_STRING",INVALID_ROOMID_INTEGER:"INVALID_ROOMID_INTEGER",INVALID_SIGNAL_CHANNEL:"INVALID_SIGNAL_CHANNEL",JOIN_ROOM_TIMEOUT:"JOIN_ROOM_TIMEOUT",JOIN_ROOM_FAILED:"JOIN_ROOM_FAILED",REJOIN_ROOM_FAILED:"REJOIN_ROOM_FAILED",INVALID_DESTROY:"INVALID_DESTROY",INVALID_PUBLISH:"INVALID_PUBLISH",INVALID_UNPUBLISH:"INVALID_UNPUBLISH",INVALID_AUDIENCE:"INVALID_AUDIENCE",INVALID_INITIALIZE:"INVALID_INITIALIZE",INVALID_DUPLICATE_PUBLISHING:"INVALID_DUPLICATE_PUBLISHING",INVALID_SUBSCRIBE_UNDEFINED:"INVALID_SUBSCRIBE_UNDEFINED",INVALID_SUBSCRIBE_LOCAL:"INVALID_SUBSCRIBE_LOCAL",INVALID_REMOTE_STREAM:"INVALID_REMOTE_STREAM",SUBSCRIBE_FAILED:"SUBSCRIBE_FAILED",INVALID_ROLE:"INVALID_ROLE",INVALID_PARAMETER_SWITCH_ROLE:"INVALID_PARAMETER_SWITCH_ROLE",INVALID_OPERATION_SWITCH_ROLE:"INVALID_OPERATION_SWITCH_ROLE",SWITCH_ROLE_TIMEOUT:"SWITCH_ROLE_TIMEOUT",SWITCH_ROLE_FAILED:"SWITCH_ROLE_FAILED",CLIENT_BANNED:"CLIENT_BANNED",INVALID_OPERATION_START_PUBLISH_CDN:"INVALID_OPERATION_START_PUBLISH_CDN",INVALID_OPERATION_STOP_PUBLISH_CDN:"INVALID_OPERATION_STOP_PUBLISH_CDN",INVALID_STREAM_ID:"INVALID_STREAM_ID",START_PUBLISH_CDN_FAILED:"START_PUBLISH_CDN_FAILED",STOP_PUBLISH_CDN_FAILED:"STOP_PUBLISH_CDN_FAILED",START_MIX_TRANSCODE:"START_MIX_TRANSCODE",STOP_MIX_TRANSCODE:"STOP_MIX_TRANSCODE",INVALID_AUDIO_VOLUME:"INVALID_AUDIO_VOLUME",ENABLE_SMALL_STREAM_PUBLISHED:"ENABLE_SMALL_STREAM_PUBLISHED",DISABLE_SMALL_STREAM_PUBLISHED:"DISABLE_SMALL_STREAM_PUBLISHED",NOT_SUPPORTED_SMALL_STREAM:"NOT_SUPPORTED_SMALL_STREAM",INVALID_SMALL_STREAM_PROFILE:"INVALID_SMALL_STREAM_PROFILE",INVALID_PARAMETER_REMOTE_STREAM:"INVALID_PARAMETER_REMOTE_STREAM",INVALID_OPERATION_CHANGE_SMALL:"INVALID_OPERATION_CHANGE_SMALL",REMOTE_NOT_PUBLISH_SMALL_STREAM:"REMOTE_NOT_PUBLISH_SMALL_STREAM",INVALID_SWITCH_DEVICE:"INVALID_SWITCH_DEVICE",INVALID_SWITCH_DEVICE_PUBLISHING:"INVALID_SWITCH_DEVICE_PUBLISHING",INVALID_REPLACE_TRACK:"INVALID_REPLACE_TRACK",INVALID_INITIALIZE_LOCAL_STREAM:"INVALID_INITIALIZE_LOCAL_STREAM",INVALID_ADD_TRACK_REPETITIVE:"INVALID_ADD_TRACK_REPETITIVE",INVALID_ADD_TRACK_REMOVING:"INVALID_ADD_TRACK_REMOVING",INVALID_ADD_TRACK_PUBLISHING:"INVALID_ADD_TRACK_PUBLISHING",INVALID_STREAM_INITIALIZED:"INVALID_STREAM_INITIALIZED",INVALID_ADD_TRACK_NUMBER:"INVALID_ADD_TRACK_NUMBER",INVALID_REMOVE_AUDIO_TRACK:"INVALID_REMOVE_AUDIO_TRACK",INVALID_REMOVE_AUDIO_ADDING:"INVALID_REMOVE_AUDIO_ADDING",INVALID_REMOVE_AUDIO_ON:"INVALID_REMOVE_AUDIO_ON",INVALID_REMOVE_TRACK_PUBLISHING:"INVALID_REMOVE_TRACK_PUBLISHING",INVALID_REMOVE_TRACK_NOT_TRACK:"INVALID_REMOVE_TRACK_NOT_TRACK",INVALID_REMOVE_TRACK_NUMBER:"INVALID_REMOVE_TRACK_NUMBER",INVALID_REPLACE_TRACK_NO_TRACK:"INVALID_REPLACE_TRACK_NO_TRACK",REPEAT_JOIN:"REPEAT_JOIN",CLIENT_DESTROYED:"CLIENT_DESTROYED",NOT_BUG_PACKAGE:"NOT_BUG_PACKAGE",START_MIX_TRANSCODE_FAILED:"START_MIX_TRANSCODE_FAILED",STOP_MIX_TRANSCODE_FAILED:"STOP_MIX_TRANSCODE_FAILED",MIX_TRANSCODE_NOT_STARTED:"MIX_TRANSCODE_NOT_STARTED",CANNOT_LESS_THAN_ZERO:"CANNOT_LESS_THAN_ZERO",MIX_PARAMS_VIDEO_FRAMERATE:"MIX_PARAMS_VIDEO_FRAMERATE",MIX_PARAMS_VIDEO_GOP:"MIX_PARAMS_VIDEO_GOP",MIX_PARAMS_AUDIO_BITRATE:"MIX_PARAMS_AUDIO_BITRATE",MIX_PARAMS_USER_Z_ORDER:"MIX_PARAMS_USER_Z_ORDER",MIX_PARAMS_NOT_SELF:"MIX_PARAMS_NOT_SELF",MIX_PARAMS_USER_STREAM:"MIX_PARAMS_USER_STREAM",INVALID_PLAY:"INVALID_PLAY",INVALID_ELEMENT_ID:"INVALID_ELEMENT_ID",INVALID_ELEMENT_ID_TYPE:"INVALID_ELEMENT_ID_TYPE",PLAY_FAILED:"PLAY_FAILED",INVALID_USERID:"INVALID_USERID",INVALID_CREATE_STREAM_SOURCE:"INVALID_CREATE_STREAM_SOURCE",INVALID_CREATE_STREAM_SCREEN:"INVALID_CREATE_STREAM_SCREEN",INVALID_CREATE_STREAM_AUDIO:"INVALID_CREATE_STREAM_AUDIO",INVALID_CREATE_STREAM_SCREEN_AUDIO:"INVALID_CREATE_STREAM_SCREEN_AUDIO",NOT_SUPPORTED_HTTP:"NOT_SUPPORTED_HTTP",NOT_SUPPORTED_WEBRTC:"NOT_SUPPORTED_WEBRTC",NOT_SUPPORTED_PROFILE:"NOT_SUPPORTED_PROFILE",NOT_SUPPORTED_MEDIA:"NOT_SUPPORTED_MEDIA",NOT_SUPPORTED_H264ENCODE:"NOT_SUPPORTED_H264ENCODE",NOT_SUPPORTED_H264DECODE:"NOT_SUPPORTED_H264DECODE",NOT_SUPPORTED_TRACK:"NOT_SUPPORTED_TRACK",NOT_SUPPORTED_SWITCH_DEVICE:"NOT_SUPPORTED_SWITCH_DEVICE",NOT_SUPPORTED_CAPTURE:"NOT_SUPPORTED_CAPTURE",NOT_SUPPORTED_AUX:"NOT_SUPPORTED_AUX",MICROPHONE_NOT_FOUND:"MICROPHONE_NOT_FOUND",CAMERA_NOT_FOUND:"CAMERA_NOT_FOUND",SIGNAL_RESPONSE_FAILED:"SIGNAL_RESPONSE_FAILED",CATCH_HANDLER_ERROR:"CATCH_HANDLER_ERROR",API_NOT_EXIST:"API_NOT_EXIST",CONNECTION_CLOSED:"CONNECTION_CLOSED",SUBSCRIBE_ALL_FALSE:"SUBSCRIBE_ALL_FALSE",SEI_NOT_SUPPORT:"SEI_NOT_SUPPORT",SEI_DISABLED:"SEI_DISABLED",SEI_BEFORE_PUBLISH:"SEI_BEFORE_PUBLISH",SEI_NOT_VIDEO:"SEI_NOT_VIDEO",CALL_FREQUENCY_LIMIT:"CALL_FREQUENCY_LIMIT",CONNECTION_ABORTED:"CONNECTION_ABORTED",API_CALL_ABORTED:"API_CALL_ABORTED",DUPLICATE_AUX:"DUPLICATE_AUX"},CO={AVOID_REPEATED_CALL:e=>"previous ".concat(e.name,"() is ongoing, please avoid repeated calls."),INVALID_PARAMETER_REQUIRED(e){let{key:t,rule:i,fnName:r,value:n}=e;return"'".concat(t||i.name,"' is a required param when calling ").concat(r,"(), received: ").concat(n,".")},INVALID_PARAMETER_TYPE(e){let{key:t,rule:i,fnName:r,value:n}=e,a="".concat(t||i.name),o="";return o=Array.isArray(i.type)?i.type.join("|"):i.type,"'".concat(a,"' must be type of ").concat(o," when calling ").concat(r,"(), received type: ").concat(Fk(n),".")},INVALID_PARAMETER_EMPTY(e){let{key:t,rule:i,fnName:r,value:n}=e;return"'".concat(t||i.name,"' cannot be '").concat(n,"' when calling ").concat(r,"().")},INVALID_PARAMETER_INSTANCE(e){let{key:t,rule:i,fnName:r,value:n}=e,a="".concat(t||i.name),o="".concat(i.instanceOf.name||i.instanceOf);return"'".concat(a,"' must be instanceof ").concat(o," when calling ").concat(r,"(), received type: ").concat(Fk(n),".")},INVALID_PARAMETER_RANGE(e){let{key:t,rule:i,fnName:r,value:n}=e;return"'".concat(t||i.name,"' must be one of ").concat(i.values.join("|")," when calling ").concat(r,"(), received: ").concat(n,".")},INVALID_PARAMETER_MIN(e){let{key:t,rule:i,fnName:r,value:n}=e;return"the min value of ".concat(t||i.name," is ").concat(i.min,", received: ").concat(n,".")},INVALID_PARAMETER_MAX(e){let{key:t,rule:i,fnName:r,value:n}=e;return"the max value of ".concat(t||i.name," is ").concat(i.max,", received: ").concat(n,".")},API_CALL_TIMEOUT:e=>"".concat(e.commandDesc||e.command," timeout observed."),SIGNAL_CHANNEL_RECONNECTION_FAILED:"signal channel reconnection failed, please check your network.",SIGNAL_CHANNEL_SETUP_FAILED:e=>"SignalChannel setup failure: (errorCode: ".concat(e.errorCode,", errorMsg: ").concat(e.errorMsg," })."),ERROR_MESSAGE(e){let t="".concat(e.type," failed");return e.message&&(t="".concat(t,": ").concat(e.message,".")),t},EXCHANGE_SDP_TIMEOUT:"exchange sdp timeout.",DOWNLINK_RECONNECTION_FAILED:"downlink reconnection failed, please check your network and re-join room.",EXCHANGE_SDP_FAILED:e=>"exchange sdp failed ".concat(e.errMsg,"."),UPDATE_OFFER_TIMEOUT:"update offer timeout observed.",UPLINK_RECONNECTION_FAILED:"uplink reconnection failed, please check your network and publish again.",INVALID_RECORDID:"recordId must be an integer number.",INVALID_PURE_AUDIO:"pureAudioPushMode must be 1 or 2.",INVALID_STREAMID:"streamId must be a sting literal within 64 bytes, and not be empty.",INVALID_USER_DEFINE_RECORDID:"userDefineRecordId must be a sting literal contains (a-zA-Z),(0-9), underline and hyphen, within 64 bytes, and not be empty.",INVALID_USER_DEFINE_PUSH_ARGS:"userDefinePushArgs must be a sting literal within 256 bytes, and not be empty.",INVALID_PROXY:'proxy server url must start with "wss://".',INVALID_JOIN:"duplicate join() called.",INVALID_ROOMID_STRING:e=>"'".concat(e,"' must be validate string when useStringRoomId is true."),INVALID_ROOMID_INTEGER:e=>"'".concat(e,"' must be an integer between [1, 4294967294] when useStringRoomId is false."),INVALID_SIGNAL_CHANNEL:"SignalChannel is not ready yet.",JOIN_ROOM_TIMEOUT:"join room timeout.",JOIN_ROOM_FAILED(e){let{error:t,code:i}=e;return"Failed to join room - ".concat(t," code: ").concat(i)},REJOIN_ROOM_FAILED:e=>"reJoin room: ".concat(e.roomId," failed, please check your network."),INVALID_DESTROY:"please call leave() before destroy().",INVALID_PUBLISH:"please call join() before publish().",INVALID_UNPUBLISH:"stream has not been published yet.",INVALID_AUDIENCE:'no permission to publish() under live/audience, please call switchRole("anchor") firstly before publish().',INVALID_INITIALIZE:"cannot publish stream because stream is not initialized, is switching device, or has been closed.",INVALID_DUPLICATE_PUBLISHING:e=>"duplicate ".concat(e," stream publishing, please unpublish your prev ").concat(e," stream and then re-publish."),INVALID_SUBSCRIBE_UNDEFINED:"stream is undefined or null.",INVALID_SUBSCRIBE_LOCAL:"stream cannot be LocalStream.",INVALID_REMOTE_STREAM:"remoteStream does not exist because it has been unpublished by remote peer.",SUBSCRIBE_FAILED(e){let{message:t,userId:i,streamType:r}=e;return"failed to subscribe ".concat(i," ").concat(r," stream, reason: ").concat(t,".")},INVALID_ROLE:"switchRole can only be called in live mode.",INVALID_PARAMETER_SWITCH_ROLE:"role could only be set to a value as anchor or audience.",INVALID_OPERATION_SWITCH_ROLE:"please call join() before switchRole().",SWITCH_ROLE_TIMEOUT:"switchRole timeout.",SWITCH_ROLE_FAILED:e=>"switchRole failed, errCode: ".concat(e.code," errMsg: ").concat(e.message,"."),CLIENT_BANNED:e=>"client was banned because of ".concat(e.message,"."),INVALID_OPERATION_START_PUBLISH_CDN:"please call startPublishCDNStream() after join room and publish the local stream.",INVALID_OPERATION_STOP_PUBLISH_CDN:"please call startPublishCDNStream() before stopPublishCDNStream().",START_PUBLISH_CDN_FAILED:e=>"startPublishCDNStream failed, errMsg: ".concat(e.message,"."),STOP_PUBLISH_CDN_FAILED:e=>"stopPublishCDNStream failed, errMsg: ".concat(e.message,"."),INVALID_STREAM_ID:e=>"'".concat(e,"' can only consist of uppercase and lowercase english letters (a-zA-Z), numbers (0-9), hyphens and underscores."),START_MIX_TRANSCODE:"please call startMixTranscode() after join().",STOP_MIX_TRANSCODE:"please call stopMixTranscode() after startMixTranscode().",INVALID_AUDIO_VOLUME:"interval must be a number.",ENABLE_SMALL_STREAM_PUBLISHED:"Cannot enable small stream after localStream published.",DISABLE_SMALL_STREAM_PUBLISHED:"Cannot disable small stream after localStream published.",NOT_SUPPORTED_SMALL_STREAM:"your browser does not support opening small stream.",INVALID_SMALL_STREAM_PROFILE:"small stream profile is invalid.",INVALID_PARAMETER_REMOTE_STREAM:"remoteStream is invalid.",INVALID_OPERATION_CHANGE_SMALL:"cannot switch to the small stream without subscribing to the video of remoteStream.",REMOTE_NOT_PUBLISH_SMALL_STREAM:"remote peer does not publish small stream.",INVALID_SWITCH_DEVICE:"cannot switch device on current stream.",INVALID_SWITCH_DEVICE_PUBLISHING:"cannot switch device when publishing localStream.",INVALID_REPLACE_TRACK:"cannot replace track when publishing localStream.",INVALID_INITIALIZE_LOCAL_STREAM:"local stream has not initialized yet.",INVALID_ADD_TRACK_REPETITIVE:"previous addTrack is ongoing, please avoid repetitive execution.",INVALID_ADD_TRACK_REMOVING:"cannot add track when a track is removing.",INVALID_ADD_TRACK_PUBLISHING:"cannot add track when publishing localStream.",INVALID_STREAM_INITIALIZED:"your local stream haven't been initialized yet.",INVALID_ADD_TRACK_NUMBER:"a Stream has at most one audio track and one video track.",INVALID_REMOVE_AUDIO_TRACK:"remove audio track is not supported on your browser.",INVALID_REMOVE_AUDIO_ADDING:"cannot remove track when a track is adding.",INVALID_REMOVE_AUDIO_ON:"previous removeTrack is ongoing, please avoid repetitive execution.",INVALID_REMOVE_TRACK_PUBLISHING:"cannot remove track when publishing localStream.",INVALID_REMOVE_TRACK_NOT_TRACK:"localStream has not this track.",INVALID_REMOVE_TRACK_NUMBER:"remove the only video track is not supported, please use replaceTrack or muteVideo.",INVALID_REPLACE_TRACK_NO_TRACK:e=>"cannot replace ".concat(e.kind," track because stream has not ").concat(e.kind," track"),NOT_BUG_PACKAGE:"You need to buy packages, refer to tencent console.",START_MIX_TRANSCODE_FAILED:e=>"startMixTranscode failed, errMsg: ".concat(e.message,"."),STOP_MIX_TRANSCODE_FAILED:e=>"stopMixTranscode failed, errMsg: ".concat(e.message,"."),MIX_TRANSCODE_NOT_STARTED:"mixTranscode has not been started.",CANNOT_LESS_THAN_ZERO(e){let{key:t,rule:i,fnName:r,value:n}=e;return"'".concat(t||i.name,"' cannot be less than 0 when calling ").concat(r,"().")},MIX_PARAMS_VIDEO_FRAMERATE:"'config.videoFramerate' should be an integer between 0 and 30, excluding 0.",MIX_PARAMS_VIDEO_GOP:"'config.videoGOP' should be an integer between 1 and 8.",MIX_PARAMS_AUDIO_BITRATE:"'config.audioBitrate' should be an integer between 32 and 192.",MIX_PARAMS_USER_Z_ORDER:e=>"'".concat(e,"' is required and must be between 1 and 15."),MIX_PARAMS_NOT_SELF:"'config.mixUsers' must contain self.",MIX_PARAMS_USER_STREAM:"'config.videoWidth' and 'config.videoHeight' of output stream should be contain all mix stream.",INVALID_PLAY:"duplicate play() call observed, please stop() firstly.",INVALID_ELEMENT_ID:e=>{let{key:t,fnName:i}=e;return"'".concat(t,"' is not found in the document object when calling ").concat(i,"().")},INVALID_ELEMENT_ID_TYPE:e=>{let{key:t,fnName:i,type:r}=e;return"the element corresponding to '".concat(t,"' must be instanceof HTMLElement when calling ").concat(i,"(), received: ").concat(r,".")},PLAY_FAILED:e=>"".concat(e.media," play failed, browser exception: ").concat(e.error.toString()),INVALID_USERID:"userId cannot be all spaces.",INVALID_CREATE_STREAM_SOURCE:"LocalStream must be created by createStream() with either audio/video or audioSource/videoSource, but can not be mixed with audio/video and audioSource/videoSource.",INVALID_CREATE_STREAM_SCREEN:"screen/video cannot be both true.",INVALID_CREATE_STREAM_AUDIO:"audio/screenAudio cannot be both true.",INVALID_CREATE_STREAM_SCREEN_AUDIO:"when screen is true, screenAudio can be configured.",NOT_SUPPORTED_HTTP:"http protocol does not support the ability to capture microphone, camera and screen. please use https to deploy your page.",NOT_SUPPORTED_WEBRTC:"your browser or environment does not support full WebRTC capabilities.",NOT_SUPPORTED_PROFILE:"your browser does not support setVideoProfile.",NOT_SUPPORTED_MEDIA:"your browser or environment does not support navigator.mediaDevices.",NOT_SUPPORTED_H264ENCODE:"your device does not support H.264 encoding.",NOT_SUPPORTED_H264DECODE:"your device does not support H.264 decoding.",NOT_SUPPORTED_TRACK:e=>"".concat(e,"Track is not supported on your browser."),NOT_SUPPORTED_SWITCH_DEVICE:"switchDevice is not supported on your browser.",NOT_SUPPORTED_CAPTURE:"Your browser or environment does not support screen sharing, please check whether the browser version.",MICROPHONE_NOT_FOUND:"no microphone detected, please check your microphone.",CAMERA_NOT_FOUND:"no camera detected, please check your camera.",SIGNAL_RESPONSE_FAILED:e=>"".concat(e.signalResponse," failed, response code is ").concat(e.code," , errMsg: ").concat(e.message,"."),CATCH_HANDLER_ERROR(e){let{name:t,event:i}=e;return"an error was caught in ".concat(t,".on('").concat(i,"', handler), please check your code in 'handler'.")},API_NOT_EXIST(e){let{name:t}=e;return"experimental api ".concat(t," does not exist.")},REPEAT_JOIN:e=>"please avoid repeated join.",CONNECTION_CLOSED:"remoteStream has been unsubscribed or unpublished by remote user.",SUBSCRIBE_ALL_FALSE:"cannot subscribe when both audio & video are false, use client.unsubscribe() instead",CLIENT_DESTROYED(e){let{funName:t}=e;return"failed to call ".concat(t,"() because client was destroyed.")},SEI_NOT_SUPPORT:e=>"not support to sendSEIMessage".concat(!1===e?" without using h264 codec":""),SEI_DISABLED:"SEI is disabled",SEI_BEFORE_PUBLISH:"please call sendSEIMessage() after publish() success",SEI_NOT_VIDEO:"cannot send sei when localStream has not video.",CALL_FREQUENCY_LIMIT:e=>{let{isSize:t,name:i,timesInSecond:r,maxSizeInSecond:n}=e;return"api ".concat(i," call ").concat(t?"size":"times"," is over ").concat(t?"".concat(n," bytes"):r," in a second.")},CONNECTION_ABORTED:e=>"connection aborted due to: ".concat(e),API_CALL_ABORTED(e){let t;return t=e.message.includes("REMOTE_STREAM_NOT_EXIST")?"Subscribe ".concat(e.userId," ").concat(e.streamType," stream aborted, reason: remote user ").concat(e.userId," unpublished stream."):"API aborted, reason: ".concat(e.message),t},DUPLICATE_AUX:"only one auxiliary stream can be published in a room.",NOT_SUPPORTED_AUX:"publish auxiliary stream is not supported on your browser.",INVALID_PARAMETER_STREAMTYPE:e=>"'streamType' is required when 'userId' is not '*', calling ".concat(e,"()")},DO=(e,t)=>t?"".concat(xA,"/").concat(e,"/").concat(t):"".concat(xA,"/").concat(e,"/index.html"),OO=()=>{if(window.TRTC_ERROR_INFO&&window.TRTC_ERROR_LINK)return{TRTC_ERROR_INFO:window.TRTC_ERROR_INFO,TRTC_ERROR_LINK:window.TRTC_ERROR_LINK};let e=null==localStorage?void 0:localStorage.getItem("trtc_error_assistance");if(e){e=JSON.parse(e);let t=document.createElement("script");t.type="text/javascript",t.text=e.message,document.body.appendChild(t);let i=window.TRTC_ERROR_INFO,r=window.TRTC_ERROR_LINK;return document.body.removeChild(t),{TRTC_ERROR_INFO:i,TRTC_ERROR_LINK:r}}return{}};function LO(e){let{key:t,data:i,link:r,addDocLink:n=!0}=e,a="",o="",s="";Bk(CO[t])?a=CO[t](i):Hk(CO[t])&&(a=CO[t]);let{TRTC_ERROR_INFO:c,TRTC_ERROR_LINK:l}=OO();r?s="".concat(r.className,".html#").concat(r.fnName):l&&l[t]&&(Bk(l[t])?s=l[t](i):Hk(l[t])&&(s=l[t]));let d=a;return Pk()&&(c&&c[t]&&(Bk(c[t])?o=c[t](i):Hk(c[t])&&(o=c[t])),o&&(d=n?"".concat(o,"\n请查看文档: ").concat(DO("zh-cn",s),"\n\n"):"".concat(o,"\n\n"),d+=a)),n&&(d+=" \nRefer to: ".concat(DO("en",s),"\n")),d}var NO,PO=mA(IA(),1),xO=class{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];vA(this,"countMap",new Map),vA(this,"distributionMap",new Map),vA(this,"version"),vA(this,"log",SO.createLogger({id:"kv"})),e&&(bO.on("102",e=>{let{track:t,cost:i}=e;this.addSuccessEvent({key:t.kind===WA?501700:511700,cost:i})}),bO.on("103",e=>{let{track:t,error:i}=e;this.addFailedEvent({key:t.kind===WA?501700:511700,error:i})}),bO.on("266",e=>{let{enable:t}=e;this.log.info("".concat(t?"enable":"disable"," sso")),t?this.addSuccessEvent({key:525701}):this.addFailedEvent({key:525701})}))}getReportData(e,t){let i={msg_sdk_basic_info:{uint32_sdk_version:_C(this.version||LA),uint32_terminal_type:15,bytes_device_name:"",bytes_os_version:"",uint32_framework:30,uint32_network_type:0},stats_count:[...this.countMap.entries()].map(e=>{let[t,i]=e;return{uint32_key:t,uint32_count:i}}),stats_distribution:[...this.distributionMap.entries()].map(e=>{let[t,i]=e;return{uint32_key:t,distribution_items:[...i.entries()].map(e=>{let[t,i]=e;return{uint32_item_key:t,uint32_item_value:i}})}}),str_user_sig:e,bytes_report_token:t};return this.countMap.clear(),this.distributionMap.clear(),i}clear(){this.countMap.clear(),this.distributionMap.clear()}isEnumKey(e){let t=+String(e).slice(-3);return t>=700&&t<799}isErrorCodeKey(e){let t=+String(e).slice(-3);return t>=600&&t<699}isCountKey(e){let t=+String(e).slice(-3);return t>=0&&t<599}isNumberKey(e){let t=+String(e).slice(-3);return t>=800&&t<899}addCount(e){let{key:t,useUV:i=!1}=e;this.isCountKey(t)?i&&this.countMap.has(t)||this.countMap.set(t,(this.countMap.get(t)||0)+1):this.log.debug("".concat(t," is not count key, last 3 number should be 0~599"))}addEnum(e){let{key:t,value:i,useUV:r=!0}=e;var n;if(!this.isEnumKey(t))return this.log.debug("".concat(t," is not enum key, last 3 number should be 700~799"));if(r&&this.countMap.has(t))return;this.countMap.set(t,(this.countMap.get(t)||0)+1);let a=(null==(n=this.distributionMap)?void 0:n.get(t))||new Map;a.set(i,(a.get(i)||0)+1),this.distributionMap.set(t,a)}addNumber(e){let{key:t,value:i,split:r=100,useUV:n=!1,max:a=5e3}=e;var o;if(!this.isNumberKey(t))return this.log.debug("".concat(t," is not number key, last 3 number should be 800~899"));if(n&&this.countMap.has(t))return;i>a&&(i=a),this.countMap.set(t,(this.countMap.get(t)||0)+1);let s=(null==(o=this.distributionMap)?void 0:o.get(t))||new Map,c=0;if(jk(r))c=Math.floor(i/r);else for(let l=r.length-1;l>0;l--)if(i>r[l]){c=l;break}s.set(c,(s.get(c)||0)+1),this.distributionMap.set(t,s)}addSuccessEvent(e){let{key:t,cost:i,timeKey:r,split:n}=e;if(t&&(this.addEnum({key:t,value:1,useUV:!1}),i)){let e=+String(t).slice(-3);e<800&&e>=700?this.addNumber({key:r||t+100,value:i,split:n}):r||this.log.debug("time stat ignored, ".concat(t))}}addFailedEvent(e){let{key:t,error:i}=e;if(!t)return;let r=qR.UNKNOWN;i&&(jk(i)?r=i:(!Vk(i.extraCode)||!Vk(i.code))&&(r=i.extraCode||i.code)),this.addEnum({key:t,value:0,useUV:!1}),this.addEnum({key:t,value:Math.abs(r),useUV:!1})}},MO=((NO=MO||{})[NO.DECODER_TYPE=514700]="DECODER_TYPE",NO[NO.DECODER_HW_SW=514701]="DECODER_HW_SW",NO[NO.DECODE_RESULT=514702]="DECODE_RESULT",NO[NO.DECODE_FAILED_OS=514703]="DECODE_FAILED_OS",NO[NO.DOWNGRADE_RESULT=514704]="DOWNGRADE_RESULT",NO[NO.DOWNGRADE_WEBCODECS_VIDEO=514705]="DOWNGRADE_WEBCODECS_VIDEO",NO[NO.DOWNGRADE_WEBCODECS_2D=514706]="DOWNGRADE_WEBCODECS_2D",NO[NO.DOWNGRADE_WASM_WEGBL=514707]="DOWNGRADE_WASM_WEGBL",NO[NO.DOWNGRADE_WASM_VIDEO=514708]="DOWNGRADE_WASM_VIDEO",NO[NO.DOWNGRADE_WASM_2D=514709]="DOWNGRADE_WASM_2D",NO[NO.DECODE_H264_RESULT=514710]="DECODE_H264_RESULT",NO[NO.DECODE_H265_RESULT=514711]="DECODE_H265_RESULT",NO[NO.DECODE_VP8_RESULT=514712]="DECODE_VP8_RESULT",NO[NO.DECODE_CAPABILITIES=514713]="DECODE_CAPABILITIES",NO[NO.H264_PROFILE_LEVEL_ID_HIGH=514714]="H264_PROFILE_LEVEL_ID_HIGH",NO[NO.H264_PROFILE_LEVEL_ID_MAIN=514715]="H264_PROFILE_LEVEL_ID_MAIN",NO[NO.RENDER_FREEZE_RATE=514850]="RENDER_FREEZE_RATE",NO[NO.DATA_FREEZE_RATE=514851]="DATA_FREEZE_RATE",NO[NO.VIDEO_CONSUME_RENDER_RATE=514852]="VIDEO_CONSUME_RENDER_RATE",NO),UO=new xO(!0);new xO(!1);var FO=UO,BO={result:!1,detail:{isBrowserSupported:!1,isWebRTCSupported:!1,isWebCodecsSupported:!1,isMediaDevicesSupported:!1,isScreenShareSupported:!1,isSmallStreamSupported:!1,isH264EncodeSupported:!1,isVp8EncodeSupported:!1,isH265EncodeSupported:!1,isH264DecodeSupported:!1,isVp8DecodeSupported:!1,isH265DecodeSupported:!1}},VO=new Map([[nD,["Firefox",aD]],[lD,["Edg",dD]],[$D,["Chrome",rO]],[nO,["Safari",oO]],[gD,["TBS",vD]],[_D,["XWEB",yD]],[bD&&QC,["WeChat",wD]],[AD,["QQ(Win)",RD]],[TD,["QQ(Mobile)",SD]],[ID,["QQ(Mobile X5)",SD]],[kD,["QQ(Mac)",CD]],[DD,["QQ(iPad)",OD]],[UD,["MI",FD]],[BD,["HW",jD]],[zD,["Samsung",WD]],[GD,["OPPO",qD]],[KD,["VIVO",YD]],[sD,["EDGE",cD]],[hD,["SogouMobile",pD]],[fD,["Sogou",mD]]]);function HO(){let e=VO.get(!0);return{browserName:e?e[0]:"unknown",browserVersion:e?e[1]:"unknown"}}var jO=function(){return!(MD||sD||lD&&uD<80||nD&&oD<56)},zO=function(){return["VideoDecoder","VideoEncoder","AudioEncoder","AudioDecoder"].every(e=>e in window)},WO=function(){if(!navigator.mediaDevices)return qO()||SO.error(CO.NOT_SUPPORTED_MEDIA),!1;let e=["getUserMedia","enumerateDevices"];return e.filter(e=>e in navigator.mediaDevices).length===e.length},GO=!1;function qO(){return"http:"===location.protocol&&!pO&&(GO||SO.error(LO({key:kO.NOT_SUPPORTED_HTTP})),GO=!0,!0)}var KO=function(){return(null==window?void 0:window.OffscreenCanvas)&&(null==window?void 0:window.MediaStreamTrackProcessor)&&(null==window?void 0:window.MediaStreamTrackGenerator)},YO=function(){return!(null==window||!window.MediaStreamTrackGenerator)},XO=async function(){var e,t,i;if(BO.detail.isH264EncodeSupported&&BO.detail.isVp8EncodeSupported)return{isH264EncodeSupported:BO.detail.isH264EncodeSupported,isVp8EncodeSupported:BO.detail.isVp8EncodeSupported,isH265EncodeSupported:BO.detail.isH265EncodeSupported};let r,n=!1,a=!1,o=!1;try{let s=new RTCPeerConnection,c=document.createElement(zA);c.getContext("2d");let l=c.captureStream(0);return s.addTrack(l.getVideoTracks()[0],l),r=await s.createOffer(),n=-1!==(null==(e=r.sdp)?void 0:e.toLowerCase().indexOf("h264")),a=-1!==(null==(t=r.sdp)?void 0:t.toLowerCase().indexOf("vp8")),o=-1!==(null==(i=r.sdp)?void 0:i.toLowerCase().indexOf("h265")),s.close(),{isH264EncodeSupported:n,isVp8EncodeSupported:a,isH265EncodeSupported:o}}catch(s){return{isH264EncodeSupported:!1,isVp8EncodeSupported:!1,isH265EncodeSupported:!1}}},ZO=async function(){var e;if(BO.detail.isH264DecodeSupported&&BO.detail.isVp8DecodeSupported)return{isH264DecodeSupported:BO.detail.isH264DecodeSupported,isVp8DecodeSupported:BO.detail.isVp8DecodeSupported,isH265DecodeSupported:BO.detail.isH265DecodeSupported};let t,i=!1,r=!1;try{let n=new RTCPeerConnection;vL()?(n.addTransceiver(GA,{direction:"recvonly"}),t=await n.createOffer()):t=await n.createOffer({offerToReceiveVideo:!0}),-1!==t.sdp.toLowerCase().indexOf("h264")&&(i=!0),-1!==t.sdp.toLowerCase().indexOf("vp8")&&(r=!0);let a=-1!==(null==(e=t.sdp)?void 0:e.toLowerCase().indexOf("h265"));return n.close(),{isH264DecodeSupported:i,isVp8DecodeSupported:r,isH265DecodeSupported:a}}catch(n){return{isH264DecodeSupported:!1,isVp8DecodeSupported:!1,isH265DecodeSupported:!1}}};var JO=bC(async e=>{let t=Date.now(),i=DL(),r=WO(),n=zO();if(BO.detail.isWebRTCSupported=i,BO.detail.isMediaDevicesSupported=r,BO.detail.isWebCodecsSupported=n,BO.detail.isScreenShareSupported=$O(),BO.detail.isSmallStreamSupported=hL(),37===e)return Object.assign(BO.detail,await async function(){return rL||(rL=new Promise(async e=>{let t={isH264EncodeSupported:!1,isH264DecodeSupported:!1,isVp8EncodeSupported:!1,isVp8DecodeSupported:!1};if(!zO())return void e(t);let i=null,r=null,n=null,a=()=>{n&&clearTimeout(n),i=null,r=null};try{i=document.createElement("canvas"),r=i.getContext("2d"),i.width=320,i.height=240;let o=0,s=()=>{!r||!i||(r.fillStyle="hsl(".concat(o%360,", 50%, 50%)"),r.fillRect(0,0,i.width,i.height),r.fillStyle="white",r.font="20px Arial",r.fillText("Frame ".concat(o),10,30),o++)};n=setTimeout(()=>{a(),e(t)},5e3);let c=[{type:"h264",encodeConfig:{codec:"avc1.42E01E",avc:{format:"annexb"},width:320,height:240,bitrate:1e6},decodeConfig:{codec:"avc1.42E01E",avc:{format:"annexb"}}},{type:"vp8",encodeConfig:{codec:"vp8",width:320,height:240,bitrate:1e6},decodeConfig:{codec:"vp8"}}];(await Promise.all(c.map(async e=>{let t,r={type:e.type,encodeSupported:!1,decodeSupported:!1};try{t=await new Promise(async(t,n)=>{try{let a=new VideoEncoder({output:e=>{t(e),r.encodeSupported=!0},error:n});a.configure(e.encodeConfig),s();let o=new VideoFrame(i,{timestamp:0});a.encode(o,{keyFrame:!0}),o.close(),await a.flush(),a.close()}catch(a){n(a)}})}catch(p){return SO.warn("".concat(e.type," encoder error:"),p),r}try{await new Promise(async(i,n)=>{try{let a=new VideoDecoder({output:e=>{r.decodeSupported=!0,i(0),e.close()},error:n});a.configure(e.decodeConfig),a.decode(t),await a.flush(),a.close()}catch(a){n(a)}})}catch(p){SO.warn("".concat(e.type," decoder error:"),p)}return r}))).forEach(e=>{"h264"===e.type?(t.isH264EncodeSupported=e.encodeSupported,t.isH264DecodeSupported=e.decodeSupported):"vp8"===e.type&&(t.isVp8EncodeSupported=e.encodeSupported,t.isVp8DecodeSupported=e.decodeSupported)}),a(),e(t)}catch(o){a(),SO.warn("detectWebCodecsSupported failed:",o),e(t)}}),rL)}()),BO.detail.isBrowserSupported=n,BO.result=r&&n,BO.result||SO.error("".concat(navigator.userAgent," ").concat(fC(BO.detail,!1))),UL(e),FO.addNumber({key:523800,value:Date.now()-t}),BO;if(BO.result&&BO.detail.isH264EncodeSupported&&BO.detail.isVp8EncodeSupported&&BO.detail.isH265EncodeSupported&&BO.detail.isH264DecodeSupported&&BO.detail.isVp8DecodeSupported&&BO.detail.isH265DecodeSupported)return BO;let a=jO(),{encode:o,decode:s}=await async function(){let[e,t]=await Promise.all([XO(),ZO()]);return{encode:{h264:e.isH264EncodeSupported,vp8:e.isVp8EncodeSupported,h265:e.isH265EncodeSupported},decode:{h264:t.isH264DecodeSupported,vp8:t.isVp8DecodeSupported,h265:t.isH265DecodeSupported}}}(),{h264:c,vp8:l}=o,{h264:d}=s,{h265:u}=o,{vp8:h,h265:p}=s;if(!c||!l){let e=await XO();SO.warn("detect encode again h264:".concat(c," vp8:").concat(l," result: ").concat(JSON.stringify(e))),c=e.isH264EncodeSupported,l=e.isVp8EncodeSupported}if(c&&d&&iD&&QD&&!_D&&!gD&&(!GD||115!==tO)){let{encode:e,decode:t}=await iL();c=e,d=t}return BO.result=a&&i&&r&&(c||l)&&(d||h),BO.detail.isBrowserSupported=a,BO.detail.isWebRTCSupported=i,BO.detail.isH264EncodeSupported=c,BO.detail.isVp8EncodeSupported=l,BO.detail.isH265EncodeSupported=u,BO.detail.isH264DecodeSupported=d,BO.detail.isVp8DecodeSupported=h,BO.detail.isH265DecodeSupported=p,BO.result||SO.error("".concat(navigator.userAgent," ").concat(fC(BO.detail,!1))),UL(),FO.addNumber({key:523800,value:Date.now()-t}),BO}),QO=function(){return BO.result},$O=function(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia)},eL="undefined"!=typeof HTMLMediaElement&&"setSinkId"in HTMLMediaElement.prototype,tL=null;async function iL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;return tL||(tL=new Promise(async t=>{let i={encode:!1,decode:!1},r=()=>{};try{let n=document.createElement("canvas"),a=n.getContext("2d");n.width=640,n.height=480;let o=setInterval(()=>{a.fillText("test",Math.floor(640*Math.random()),Math.floor(480*Math.random()))},66),s=-1,c=-1;r=()=>{clearInterval(s),clearInterval(o),clearTimeout(c),d.close(),u.close(),l.getTracks().forEach(e=>e.stop())},c=setTimeout(()=>{r(),t(i)},e);let l=n.captureStream(),d=new RTCPeerConnection({}),u=new RTCPeerConnection({offerToReceiveAudio:!0,offerToReceiveVideo:!0});d.addEventListener("icecandidate",e=>u.addIceCandidate(e.candidate)),u.addEventListener("icecandidate",e=>d.addIceCandidate(e.candidate)),d.addTrack(l.getVideoTracks()[0],l);let h=await d.createOffer();await d.setLocalDescription(h),await u.setRemoteDescription(h);let p=await u.createAnswer(),f=PO.default.parse(p.sdp),m=f.media[0].rtp.findIndex(e=>"H264"===e.codec);f.media[0].rtp=[f.media[0].rtp[m]],f.media[0].fmtp=f.media[0].fmtp.filter(e=>e.payload===f.media[0].rtp[0].payload),f.media[0].rtcpFb&&(f.media[0].rtcpFb=f.media[0].rtcpFb.filter(e=>e.payload===f.media[0].rtp[0].payload)),p.sdp=PO.default.write(f),await u.setLocalDescription(p),await d.setRemoteDescription(p),s=setInterval(async()=>{i.encode&&i.decode&&(r(),t(i));let[e,n]=await Promise.all([d.getSenders()[0].getStats(),u.getReceivers()[0].getStats()]);i.encode||e.forEach(e=>{"outbound-rtp"===e.type&&(e.mediaType===GA||e.kind===GA)&&e.bytesSent>0&&(i.encode=!0)}),i.decode||n.forEach(e=>{"inbound-rtp"===e.type&&(e.mediaType===GA||e.kind===GA)&&e.bytesReceived>0&&(i.decode=!0)})},100)}catch(n){r(),SO.warn("detectH264Supported failed",n),t({encode:!0,decode:!0})}}).then(e=>(e.encode||(e.decode=!0),(!e.encode||!e.decode)&&SO.warn("detectH264Supported encode: ".concat(e.encode," decode: ").concat(e.decode," ").concat("")),e)),tL)}var rL=null;var nL=(e,t,i)=>{"http:"===location.protocol&&!pO&&(e[t]=()=>{throw new YR({code:qR.INVALID_OPERATION,message:CO.NOT_SUPPORTED_HTTP})})},aL=function(e){return!("candidate-pair"!==e.type||!e.nominated||"in-progress"!==e.state&&"succeeded"!==e.state)&&!(zk(e.selected)&&!e.selected)};function oL(){let e="";if(screen.width){let t=screen.width?screen.width*window.devicePixelRatio:"",i=screen.height?screen.height*window.devicePixelRatio:"";e+="".concat(t," * ").concat(i)}return e}function sL(){return navigator.getUserMedia||navigator.mediaDevices&&navigator.mediaDevices.getUserMedia}function cL(){let e={isSupported:!1},t=["AudioContext","webkitAudioContext","mozAudioContext","msAudioContext"];for(let i=0;i<t.length;i++)if(t[i]in window){e.isSupported=!0;break}return e.isSupported}function lL(){return"captureStream"in HTMLCanvasElement.prototype}function dL(){return!(bD||eD||tO&&tO<63)&&!(!jO()||!lL())}function uL(){return!(tO<74||sD||lO<11||oD<46)}function hL(){return dL()||uL()}var pL=function(){if(Vk(window.RTCRtpTransceiver)||!vL()||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let e=null,t=!1;try{e=new RTCPeerConnection({sdpSemantics:"unified-plan"}),e.addTransceiver(WA),t=!0}catch(fx){}return null==e||e.close(),t};function fL(){return"RTCPeerConnection"in window&&"getReceivers"in window.RTCPeerConnection.prototype}function mL(){return"RTCPeerConnection"in window&&"getSenders"in window.RTCPeerConnection.prototype}function gL(){return"RTCPeerConnection"in window&&"getTransceivers"in window.RTCPeerConnection.prototype}function vL(){return!(11===lO&&!hO)&&("RTCPeerConnection"in window&&"addTransceiver"in window.RTCPeerConnection.prototype)}var _L=!(!vL()||QD&&tO<86);function yL(){return"RTCRtpTransceiver"in window&&"stop"in window.RTCRtpTransceiver.prototype}var EL="RTCRtpSender"in window;function bL(){return EL&&"replaceTrack"in window.RTCRtpSender.prototype}function wL(){return EL&&"setParameters"in window.RTCRtpSender.prototype&&mL()}var IL="RTCRtpReceiver"in window&&"getSynchronizationSources"in window.RTCRtpReceiver.prototype,TL=window.MediaStreamTrack&&"getSettings"in MediaStreamTrack.prototype,SL=window.MediaStreamTrack&&"getCapabilities"in MediaStreamTrack.prototype,AL="undefined"!=typeof InputDeviceInfo&&"getCapabilities"in InputDeviceInfo.prototype,RL=EL&&"createEncodedStreams"in window.RTCRtpSender.prototype&&ZD()>=86,kL="RTCRtpScriptTransform"in window,CL=EL&&(RL||kL),DL=function(){return["RTCPeerConnection","webkitRTCPeerConnection","RTCIceGatherer"].filter(e=>e in window).length>0};function OL(){let e={AudioDecoder:!1,AudioEncoder:!1,VideoDecoder:!1,VideoEncoder:!1,ImageDecoder:!1};return Vk(window.AudioDecoder)||(e.AudioDecoder=!0),Vk(window.AudioEncoder)||(e.AudioEncoder=!0),Vk(window.VideoDecoder)||(e.VideoDecoder=!0),Vk(window.VideoEncoder)||(e.VideoEncoder=!0),Vk(window.ImageDecoder)||(e.ImageDecoder=!0),e}function LL(){return"mediaSession"in navigator&&!Vk(navigator.mediaSession.setActionHandler)}function NL(){return!Vk(window.WebTransport)}function PL(){return"undefined"!=typeof WebAssembly&&WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]))}function xL(){let e={browser:"".concat(mO.name,"/").concat(mO.version),os:_O(),displayResolution:oL(),isScreenShareSupported:$O(),isWebRTCSupported:DL(),isGetUserMediaSupported:sL(),isWebAudioSupported:cL(),isWebSocketsSupported:"WebSocket"in window&&2===window.WebSocket.CLOSING,isWebCodecSupported:OL(),isMediaSessionSupported:LL(),isWebTransportSupported:NL()};return navigator.userAgent.includes("miniProgram")&&(e.browser="mini/".concat(e.browser)),e}var ML="checkResult";function UL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;RO.setItem(ML+e,{ua:navigator.userAgent,checkResult:BO})}function FL(e){qO();let t=RO.getItem(ML+e);t&&t.ua===navigator.userAgent&&t.checkResult&&function(e,t){return!!Wk(e)&&Object.keys(t).every(t=>t in e)}(t.checkResult.detail,BO.detail)&&(BO=t.checkResult),JO(e)}function BL(){return"requestVideoFrameCallback"in HTMLVideoElement.prototype}var VL="RTCRtpReceiver"in window&&"jitterBufferTarget"in window.RTCRtpReceiver.prototype;function HL(e){return{h264:1,h265:2,vp8:3,vp9:4,av1:5}[e]}var jL=!1;async function zL(){var e;try{if(jL||null==(e=null==navigator?void 0:navigator.mediaCapabilities)||!e.encodingInfo)return;let t=yO(),i=bD||_D?4:QD?1:nO?2:nD?3:0;if(0===t||0===i)return;jL=!0;let r=["H264","VP8","VP9","AV1","H265"],[n,a]=await Promise.all([WL(r),GL(r)]);n&&Object.keys(n).forEach(e=>{let r=HL(e.toLowerCase());FO.addEnum({key:513707,value:+"".concat(r).concat(+n[e].supported).concat(+n[e].powerEfficient).concat(t).concat(i),useUV:!1})}),a&&Object.keys(a).forEach(e=>{let r=HL(e.toLowerCase());FO.addEnum({key:514713,value:+"".concat(r).concat(+a[e].supported).concat(+a[e].powerEfficient).concat(t).concat(i),useUV:!1})});let{sender:o,receiver:s}=qL();FO.addEnum({key:513708,value:+"".concat(t).concat(i).concat(+o.high),useUV:!1}),FO.addEnum({key:513709,value:+"".concat(t).concat(i).concat(+o.main),useUV:!1}),FO.addEnum({key:514714,value:+"".concat(t).concat(i).concat(+s.high),useUV:!1}),FO.addEnum({key:514715,value:+"".concat(t).concat(i).concat(+s.main),useUV:!1})}catch(t){SO.info("detectVideoCodecCapabilities failed",t)}}async function WL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1080,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e3,a={};try{for(let o of e){let e=await navigator.mediaCapabilities.encodingInfo({type:"webrtc",video:{contentType:"video/".concat(o),width:t,height:i,bitrate:n,framerate:r}});a[o]=e}}catch(DA){}return a}async function GL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1920,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1080,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e3,a={};try{for(let o of e){let e=await navigator.mediaCapabilities.decodingInfo({type:"webrtc",video:{contentType:"video/".concat(o),width:t,height:i,bitrate:n,framerate:r}});a[o]=e}}catch(DA){}return a}function qL(){let e={sender:{base:!1,main:!1,high:!1},receiver:{base:!1,main:!1,high:!1}};try{if(RTCRtpSender&&"function"==typeof RTCRtpSender.getCapabilities){let t=RTCRtpSender.getCapabilities("video");t&&t.codecs&&t.codecs.filter(e=>"video/h264"===e.mimeType.toLowerCase()).forEach(t=>{if(t.sdpFmtpLine){let i=t.sdpFmtpLine.match(/profile-level-id=([0-9a-fA-F]+)/);if(i&&i[1])switch(i[1].slice(0,2)){case"42":e.sender.base=!0;break;case"4d":e.sender.main=!0;break;case"64":e.sender.high=!0}}})}if(RTCRtpReceiver&&"function"==typeof RTCRtpReceiver.getCapabilities){let t=RTCRtpReceiver.getCapabilities("video");t&&t.codecs&&t.codecs.filter(e=>"video/h264"===e.mimeType.toLowerCase()).forEach(t=>{if(t.sdpFmtpLine){let i=t.sdpFmtpLine.match(/profile-level-id=([0-9a-fA-F]+)/);if(i&&i[1])switch(i[1].slice(0,2)){case"42":e.receiver.base=!0;break;case"4d":e.receiver.main=!0;break;case"64":e.receiver.high=!0}}})}}catch(t){SO.warn("get H264 profile levelId failed",t)}return e}var KL=mA(yA(),1),YL=Symbol("instance"),XL=Symbol("cacheResult"),ZL=class{constructor(e,t,i){this.oldState=e,this.newState=t,this.action=i,this.aborted=!1}abort(e){this.aborted=!0,tN.call(e,this.oldState,new Error("action '".concat(this.action,"' aborted")))}toString(){return"".concat(this.action,"ing")}},JL=class extends Error{constructor(e,t,i){super(t),this.state=e,this.message=t,this.cause=i}};var QL=new Map;function $L(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(r,n,a)=>{let o=i.action||n;if(!i.context){let i=QL.get(r)||[];QL.has(r)||QL.set(r,i),i.push({from:e,to:t,action:o})}let s=a.value;a.value=function(){let r=this;for(var n=arguments.length,a=new Array(n),c=0;c<n;c++)a[c]=arguments[c];if(i.context&&(r=iN.get("function"==typeof i.context?i.context.call(this,...a):i.context)),r.state===t)return i.sync?r[XL]:Promise.resolve(r[XL]);r.state instanceof ZL&&r.state.action==i.abortAction&&r.state.abort(r);let l=null;Array.isArray(e)?0==e.length?r.state instanceof ZL&&r.state.abort(r):("string"!=typeof r.state||!e.includes(r.state))&&(l=new JL(r._state,"".concat(r.name," ").concat(o," to ").concat(t," failed: current state ").concat(r._state," not from ").concat(e.join("|")))):e!==r.state&&(l=new JL(r._state,"".concat(r.name," ").concat(o," to ").concat(t," failed: current state ").concat(r._state," not from ").concat(e)));let d=e=>{if(i.fail&&i.fail.call(this,e),i.sync){if(i.ignoreError)return e;throw e}return i.ignoreError?Promise.resolve(e):Promise.reject(e)};if(l)return d(l);let u=r.state,h=new ZL(u,t,o);tN.call(r,h);let p=e=>{var n;return r[XL]=e,h.aborted||(tN.call(r,t),null===(n=i.success)||void 0===n||n.call(this,r[XL])),e},f=e=>(tN.call(r,u,e),d(e));try{let e=s.apply(this,a);return function(e){return"object"==typeof e&&e&&"then"in e}(e)?e.then(p).catch(f):i.sync?p(e):Promise.resolve(p(e))}catch(m){return f(new JL(r._state,"".concat(r.name," ").concat(o," from ").concat(e," to ").concat(t," failed: ").concat(m),m instanceof Error?m:new Error(String(m))))}}}}var eN="undefined"!=typeof window&&window.__AFSM__?(e,t)=>{window.dispatchEvent(new CustomEvent(e,{detail:t}))}:"undefined"!=typeof importScripts?(e,t)=>{postMessage({type:e,payload:t})}:()=>{};function tN(e,t){let i=this._state;this._state=e;let r=e.toString();e&&this.emit(r,i),this.emit(iN.STATECHANGED,e,i,t),this.updateDevTools({value:e,old:i,err:t instanceof Error?t.message:String(t)})}var iN=class e extends KL.default{constructor(t,i,r){super(),this.name=t,this.groupName=i,this._state=e.INIT,t||(t=Date.now().toString(36)),r?Object.setPrototypeOf(this,r):r=Object.getPrototypeOf(this),i||(this.groupName=this.constructor.name);let n=r[YL];n?this.name=n.name+"-"+n.count++:r[YL]={name:this.name,count:0},this.updateDevTools({diagram:this.stateDiagram})}get stateDiagram(){let e=Object.getPrototypeOf(this),t=QL.get(e)||[],i=new Set,r=[],n=[],a=new Set,o=Object.getPrototypeOf(e);QL.has(o)&&(o.stateDiagram.forEach(e=>i.add(e)),o.allStates.forEach(e=>a.add(e))),t.forEach(e=>{let{from:t,to:i,action:a}=e;"string"==typeof t?r.push({from:t,to:i,action:a}):t.length?t.forEach(e=>{r.push({from:e,to:i,action:a})}):n.push({to:i,action:a})}),r.forEach(e=>{let{from:t,to:r,action:n}=e;a.add(t),a.add(r),a.add(n+"ing"),i.add("".concat(t," --\x3e ").concat(n,"ing : ").concat(n)),i.add("".concat(n,"ing --\x3e ").concat(r," : ").concat(n," 🟢")),i.add("".concat(n,"ing --\x3e ").concat(t," : ").concat(n," 🔴"))}),n.forEach(e=>{let{to:t,action:r}=e;i.add("".concat(r,"ing --\x3e ").concat(t," : ").concat(r," 🟢")),a.forEach(e=>{e!==t&&i.add("".concat(e," --\x3e ").concat(r,"ing : ").concat(r))})});let s=[...i];return Object.defineProperties(e,{stateDiagram:{value:s},allStates:{value:a}}),s}static get(t){let i;return"string"==typeof t?(i=e.instances.get(t),i||e.instances.set(t,i=new e(t,void 0,Object.create(e.prototype)))):(i=e.instances2.get(t),i||e.instances2.set(t,i=new e(t.constructor.name,void 0,Object.create(e.prototype)))),i}static getState(t){var i;return null===(i=e.get(t))||void 0===i?void 0:i.state}updateDevTools(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};eN(e.UPDATEAFSM,Object.assign({name:this.name,group:this.groupName},t))}get state(){return this._state}set state(e){tN.call(this,e)}};iN.STATECHANGED="stateChanged",iN.UPDATEAFSM="updateAFSM",iN.INIT="[*]",iN.ON="on",iN.OFF="off",iN.instances=new Map,iN.instances2=new WeakMap;var rN="undefined"!=typeof window,nN=rN&&window.requestIdleCallback||function(e){let t=Date.now();return setTimeout(()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))})},1e3)},aN=rN&&window.cancelIdleCallback||function(e){clearTimeout(e)},oN=rN&&(window.cancelAnimationFrame||window.mozCancelAnimationFrame),sN=class e{static generateTaskID(){return this.currentTaskID++}static run(e,t,i){null!=i&&i.fps&&(i.delay=i.delay||Number((1e3/i.fps).toFixed(2))),i=dA("interval"===e?{delay:2e3,count:0,backgroundTask:!0}:"ric"===e?{delay:1e4,count:0}:"raf"===e?{fps:60,delay:16.6,count:0,backgroundTask:!0}:{delay:2e3,count:0,backgroundTask:!0},i);let r=uA(dA({taskID:this.generateTaskID(),loopCount:0,intervalID:null,timeoutID:null,rafID:null,ricID:null,taskName:e,callback:t},i),{delay:i.delay});return this.taskMap.set(r.taskID,r),this[e](r),r.taskID}static interval(t){return t.intervalID=setInterval(()=>{t.callback(),t.loopCount+=1,e.isBreakLoop(t)},t.delay)}static intervalInWorker(t){e.sharedWorker||(e.sharedWorker=new Worker(URL.createObjectURL(new Blob(["\n        const timers = new Map();\n        self.onmessage = function(e) {\n          const { taskId, delay, type } = e.data;\n          if (type === 'start') {\n            timers.set(taskId, setInterval(() => {\n              self.postMessage({ type: 'tick', taskId });\n            }, delay));\n          } else if (type === 'stop') {\n            clearInterval(timers.get(taskId));\n            timers.delete(taskId);\n          }\n        };\n      "],{type:"application/javascript"}))),e.sharedWorker.onmessage=t=>{var i;if("tick"===t.data.type){let r=e.workerTasks.get(t.data.taskId);r&&(e.isBreakLoop(r)?(null==(i=e.sharedWorker)||i.postMessage({type:"stop",taskId:r.taskID}),e.workerTasks.delete(r.taskID)):(r.callback(),r.loopCount+=1))}}),e.workerTasks.set(t.taskID,t),e.sharedWorker.postMessage({taskId:t.taskID,delay:t.delay,type:"start"})}static timeout(t){let i=()=>{if(t.callback(),t.loopCount+=1,!e.isBreakLoop(t))return t.timeoutID=setTimeout(i,t.delay)};return t.timeoutID=setTimeout(i,t.delay)}static ric(t){let i,r=eC(),n=()=>{if(i=eC()-r,i>=t.delay&&(r=eC()-Math.floor(i%t.delay),t.callback(),t.loopCount+=1),!e.isBreakLoop(t))return t.ricID=nN(n,{timeout:t.delay})};return t.ricID=nN(n,{timeout:t.delay})}static raf(t){let i,r=eC(),n=()=>document.hidden&&t.backgroundTask?(i=eC()-r,r=eC(),t.callback(),t.loopCount+=1,e.isBreakLoop(t)?void 0:t.timeoutID=setTimeout(n,t.delay-Math.floor(i%t.delay))):(i=eC()-r,i>=t.delay&&(r=eC()-Math.floor(i%t.delay),t.callback(),t.loopCount+=1),e.isBreakLoop(t)?void 0:t.rafID=requestAnimationFrame(n));if(t.rafID=requestAnimationFrame(n),t.backgroundTask){let e=()=>{if(document.hidden){let e=eC()-r;e>=t.delay?n():t.timeoutID=setTimeout(n,t.delay-e)}};document.addEventListener("visibilitychange",e),t.onVisibilitychange=e,document.hidden&&e()}return t.taskID}static hasTask(e){return this.taskMap.has(e)}static clearTask(e){if(!this.taskMap.has(e))return!0;let{intervalID:t,timeoutID:i,rafID:r,ricID:n,onVisibilitychange:a}=this.taskMap.get(e);return t&&clearInterval(t),i&&clearTimeout(i),r&&oN&&oN(r),n&&aN(n),a&&document.removeEventListener("visibilitychange",a),this.taskMap.delete(e),!0}static isBreakLoop(e){return!this.hasTask(e.taskID)||0!==e.count&&e.loopCount>=e.count&&(this.clearTask(e.taskID),!0)}};vA(sN,"taskMap",new Map),vA(sN,"currentTaskID",1),vA(sN,"sharedWorker",null),vA(sN,"workerTasks",new Map);var cN=sN,lN={LOAD_START:eR,LOADED_DATA:tR,LOADED_META_DATA:iR,MEDIA_TRACK_CHANGED:"media-track-changed",PLAYER_STATE_CHANGED:"player-state-changed",ERROR:"error",AUTOPLAY_FAILED:"autoplay-failed",RESIZE:cR,TIME_UPDATE:"time-update",LEAVE_PICTURE_IN_PICTURE:oR,ENTER_PICTURE_IN_PICTURE:aR,USER_RESUME_IN_PIP_OR_FULL_SCREEN:"user-resume-in-pip-or-full-screen",USER_PAUSE_IN_PIP_OR_FULL_SCREEN:"user-pause-in-pip-or-full-screen",ENTER_FULL_SCREEN:"enter-full-screen",LEAVE_FULL_SCREEN:"leave-full-screen",VOLUME_CHANGE:"volume-change"},dN={};fA(dN,{create:()=>hN,remove:()=>pN});var uN=new WeakMap;function hN(e,t){uN.has(e)||uN.set(e,[]);let i=uN.get(e),r={add:(e,n)=>("addEventListener"in t?(i.push(t.removeEventListener.bind(t,e,n)),t.addEventListener(e,n)):(i.push(t.off.bind(t,e,n)),t.on(e,n)),r)};return r}function pN(e){let t=uN.get(e);t&&(t.forEach(e=>e()),uN.delete(e))}var fN=new class{constructor(){vA(this,"_roomIdMap",new Map),vA(this,"_configs"),"undefined"==typeof registerProcessor&&(this._configs={sdkAppId:"",userId:"",version:LA,env:BA,browserVersion:mO.name+mO.version,ua:navigator.userAgent})}setConfig(e){let{sdkAppId:t,env:i,userId:r,roomId:n}=e;t!==this._configs.sdkAppId&&(this._configs.sdkAppId=String(t)),this._configs.env=i,this._configs.userId=r,this._roomIdMap.set(r,String(n))}logSuccessEvent(e){pO||!SO.isAbleToUpload||this._configs.env===BA&&this.uploadEventToKibana(uA(dA({},e),{result:"success"}))}logFailedEvent(e){if(pO||!SO.isAbleToUpload)return;let{eventType:t,code:i,error:r,userId:n}=e,a={roomId:this._roomIdMap.get(n||this._configs.userId),userId:n,eventType:t,result:"failed",code:i||(null==r?void 0:r.extraCode)||(null==r?void 0:r.code)||qR.UNKNOWN};this._configs.env===BA&&this.uploadEventToKibana(uA(dA({},a),{error:r}))}uploadEventToKibana(e){let t="stat-".concat(e.eventType,"-").concat(e.result);("delta-join"===e.eventType||"delta-leave"===e.eventType||"delta-publish"===e.eventType)&&(t="".concat(e.eventType,":").concat(e.delta)),this.uploadEvent({log:t,userId:e.userId}),"failed"===e.result&&(t="stat-".concat(e.eventType,"-").concat(e.result,"-").concat(e.code),this.uploadEvent({log:t,userId:e.userId,error:e.error}))}uploadEvent(e){let{log:t,userId:i,error:r}=e,n={timestamp:ZR(),sdkAppId:this._configs.sdkAppId,userId:i||this._configs.userId,version:LA,log:t};r&&(n.errorInfo=r.message,r.stack&&(n.errorInfo+="\n".concat(r.stack)));let a=IO.enable?CC(n,2002,Number(this._configs.sdkAppId)):JSON.stringify(n);this.sendRequest(Ek(this._configs.sdkAppId,FA),a)}sendRequest(e,t){setTimeout(()=>UC({url:e,body:t,priority:"low"}).catch(()=>{}),2e3)}},mN=new WeakMap;var gN=class extends iN{constructor(e,t){super(e.id,"".concat(t,"-player")),this.options=e,this.kind=t,vA(this,"id"),vA(this,"element",null),vA(this,"track"),vA(this,"url"),vA(this,"attr"),vA(this,"mode"),vA(this,"muted"),vA(this,"_log"),vA(this,"isPausedByUserCall",!1),vA(this,"_pausedRetryCount"),vA(this,"_isElementPlayingFired",!1),vA(this,"_interval"),vA(this,"_delayDestroyTimeoutId",0),vA(this,"_playSuccessResolve"),vA(this,"_isReplayByRecreateMediaStreamCalled",!1),vA(this,"isPlayCalled",!1),vA(this,"isInAutoPlayFailedState",!1),this.id=e.id,this._log=e.log,this.track=e.track,this.muted=e.muted,this._pausedRetryCount=5,this._state="STOPPED",this.bindTrackEvents(),this._log.info("create ".concat(t,"-player ").concat(this.id))}get isPlaying(){var e;return"PLAYING"===this._state&&!1===(null==(e=this.element)?void 0:e.paused)}get isPaused(){var e;return"PAUSED"===this._state||!0===(null==(e=this.element)?void 0:e.paused)}get isStopped(){return"STOPPED"===this._state}setAttr(e){this.attr=e}setUrl(e){this.track&&(this.unbindTrackEvents(),this.element&&(this.element.srcObject=null),this.track=null),e!==this.url&&(this.url=e,null!==e&&this.element&&(this.element.crossOrigin="anonymous",this.element.src=e))}async play(){if(!this.isPlaying)try{this.isPlayCalled=!0,this._delayDestroyTimeoutId&&(clearTimeout(this._delayDestroyTimeoutId),this._delayDestroyTimeoutId=0,this.bindTrackEvents(),this.bindElementEvents()),this.bindAutoPlayEvent(),await new Promise((e,t)=>{this._playSuccessResolve=e,this.element.play().then(e,t)})}catch(fx){let t=LO({key:kO.PLAY_FAILED,data:{media:this.kind,error:fx}});if(this._log.warn(fx),t.includes("NotAllowedError"))throw this.isInAutoPlayFailedState=!0,new YR({code:qR.PLAY_NOT_ALLOWED,message:t})}}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;var t;this.isPlayCalled=!1,this._isElementPlayingFired=!1,this.unbindEvents(),e>0&&!aO?this._delayDestroyTimeoutId||(null==(t=this.element)||t.remove(),this._log.info("destroy element after 3 * ".concat(e)),this._delayDestroyTimeoutId=setTimeout(()=>this.destroyElement(),3*e)):this.destroyElement(),this.handleStopped(ZA),this._interval>0&&cN.clearTask(this._interval)}destroyElement(){this.element&&(this._log.debug("destroy element"),this.element.remove(),this.element.src="",this.element.srcObject=null,this.element=null),clearTimeout(this._delayDestroyTimeoutId),this._delayDestroyTimeoutId=0}pause(){this._log.info("pause"),this.isPausedByUserCall=!0,this.doPause()}doPause(){var e;null==(e=this.element)||e.pause()}resume(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isPausedByUserCall=!1,this.doResume(e)}doResume(){return this._log.info("resume"),this.isPausedByUserCall||this.isPlaying?Promise.resolve():dO?this.replay():this.play().catch(()=>{})}setMuted(e){this.element&&(this.element.muted=e),this.muted=e}replay(){return this.stop(),this.play().catch(()=>{})}bindElementEvents(){if(this.element){let e=this.handleElementEvent.bind(this);return hN(this.element,this.element).add(JA,e).add(ZA,e).add(QA,e).add($A,e).add(eR,e).add(tR,e).add(iR,e)}}bindTrackEvents(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.track;if(e){let t=this.handleTrackEvent.bind(this);null==dN||dN.create(e,e).add(ZA,t).add(YA,t).add(XA,t),e.readyState===ZA&&this.handleTrackEvent({type:ZA}),e.muted&&this.handleTrackEvent({type:YA})}}bindAutoPlayEvent(){bO.listeners(wO.AUTOPLAY_DIALOG_CLICK_CONFIRM).includes(this.resume)||bO.on(wO.AUTOPLAY_DIALOG_CLICK_CONFIRM,this.resume,this)}unbindTrackEvents(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.track;e&&pN(e)}unbindEvents(){this.element&&pN(this.element),this.unbindTrackEvents(),bO.off(wO.AUTOPLAY_DIALOG_CLICK_CONFIRM,this.resume,this)}handleElementEvent(e){switch(e.type){case JA:PN()||(this.isInAutoPlayFailedState=!1),this._isElementPlayingFired=!0,this._log.info("".concat(this.kind," player is playing")),this.handlePlaying(JA),this._interval&&(cN.clearTask(this._interval),this._interval=-1);break;case ZA:this._log.info("".concat(this.kind," player is ended")),this.handleStopped(ZA);break;case QA:this._log.info("".concat(this.kind," player is paused")),this.handlePaused(QA);break;case $A:if(this.element&&this.element.error){this.handlePaused($A);let{code:e,message:t}=this.element.error;this._log.error("".concat(this.kind," ").concat(this._log.isLocal?"local":"remote"," MediaError code: ").concat(e," message: ").concat(t," userAgent: ").concat(navigator.userAgent)),fN.uploadEvent({log:"stat-".concat(this.kind,"-").concat(lR,"-").concat(e,"-").concat(navigator.userAgent),error:this.element.error}),HD||VD?this.emit(lN.ERROR,this.element.error):this.replayByRecreateMediaStream(this.element.error)}break;case tR:this.kind===GA&&this.emit(lN.LOADED_DATA);break;case iR:this.kind===GA&&this.emit(lN.LOADED_META_DATA);break;case eR:this.emit(lN.LOAD_START)}}replayByRecreateMediaStream(e){if(!this._isReplayByRecreateMediaStreamCalled)return this._isReplayByRecreateMediaStreamCalled=!0,this.doReplayByRecreateMediaStream(1e3).then(()=>{this._log.warn("replayByRecreateMediaStream success"),fN.uploadEvent({log:"stat-replayByRecreateMediaStream-success"}),FO.addSuccessEvent({key:this.kind===WA?506700:516700})}).catch(()=>{var t;this._log.error("replayByRecreateMediaStream failed"),fN.uploadEvent({log:"stat-replayByRecreateMediaStream-failed"}),FO.addFailedEvent({key:this.kind===WA?506700:516700,error:null==(t=this.element)?void 0:t.error}),this.emit(lN.ERROR,e)})}doReplayByRecreateMediaStream(e){return this._log.warn("delay ".concat(e,"ms to recreate mediaStream")),new Promise((t,i)=>{EC(e).then(()=>{this.element&&(this.element.srcObject=null,this.element.srcObject=new MediaStream([this.track]),this._log.warn("recreated mediaStream"),this.element.onerror=()=>{var e,t,r;this._log.warn("element onerror ".concat(null==(t=null==(e=this.element)?void 0:e.error)?void 0:t.code," fired after recreated mediaStream")),i(null==(r=this.element)?void 0:r.error)}),EC(5e3).then(()=>{var e,r;(!this.isPlaying||null!=(e=this.element)&&e.error)&&i(null==(r=this.element)?void 0:r.error),t()})})}).finally(()=>{this.element&&(this.element.onerror=null)})}async handleTrackEvent(e){let t=e.type;switch(this.options.enableLogTrackState&&this._log[t===XA?"info":"warn"]("track ".concat(t)),t){case ZA:this.handleStopped(ZA);break;case YA:this.handlePaused(YA);break;case XA:this.mode>0?this.handlePlaying(this.mode.toString()):this.element&&(this.element.paused&&!this.isPausedByUserCall&&(this._log.warn("track unmuted and element is paused, resume"),await this.doResume()),this.element&&!this.element.paused&&this._isElementPlayingFired&&this.handlePlaying(XA))}}handlePlaying(e){var t;return this._log.debug("handlePlaying",e),null==(t=this._playSuccessResolve)||t.call(this,e),e}handlePaused(e){return this._log.debug("handlePaused",e),e}handleStopped(e){return this._log.debug("handleStopped",e),e}getElement(){return this.element}};vA(gN,"PlayerEvent",lN),gA([function(e){let{settings:t={retries:5,timeout:2e3},onError:i,onRetrying:r,onRetryFailed:n}=e;return function(e,a,o){let s=zC({retryFunction:o.value,settings:t,onError(t){let{error:r,retry:n,reject:o,retryFuncArgs:s}=t;var c;i?i.call(this,r,()=>{var t;null!=(t=mN.get(e))&&t.has(a)?n():o(r)},o,s):null!=(c=mN.get(e))&&c.has(a)?n():o(r)},onRetrying(t,i){var n;BC(r)&&r.call(this,t,i),null!=(n=mN.get(e))&&n.has(a)&&(mN.get(e).get(a).stopRetry=i)},onRetryFailed:n});return o.value=function(){let t=mN.get(e);for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return t?t.set(a,{args:r}):mN.set(e,new Map([[a,{args:r}]])),s.apply(this,r).finally(()=>{var t;return null==(t=mN.get(e))?void 0:t.delete(a)})},o}}({settings:{retries:2,timeout:0},onError(e,t,i,r){r[0]=(r[0]||1e3)+1e3,t()}})],gN.prototype,"doReplayByRecreateMediaStream",1),gA([$L([],"PLAYING",{sync:!0,success(e){this.emit(lN.PLAYER_STATE_CHANGED,{type:this.kind,state:"PLAYING",reason:e})}})],gN.prototype,"handlePlaying",1),gA([$L("PLAYING","PAUSED",{ignoreError:!0,sync:!0,success(e){this.emit(lN.PLAYER_STATE_CHANGED,{type:this.kind,state:"PAUSED",reason:e})}})],gN.prototype,"handlePaused",1),gA([$L([],"STOPPED",{sync:!0,success(e){this.emit(lN.PLAYER_STATE_CHANGED,{type:this.kind,state:"STOPPED",reason:e})}})],gN.prototype,"handleStopped",1);var vN="trtc_autoplay",_N="".concat(vN,"_mask"),yN="".concat(vN,"_wrapper"),EN="".concat(vN,"_header"),bN="".concat(vN,"_content"),wN="".concat(vN,"_action_wrapper"),IN="".concat(vN,"_question"),TN="".concat(vN,"_collapse"),SN="".concat(vN,"_action_confirm"),AN="".concat(vN,"_detail"),RN="#2473E8",kN="dialog",CN="".concat(kN,"-show"),DN="".concat(kN,"-1"),ON="".concat(kN,"-2"),LN=!1,NN=!1,PN=()=>NN,xN="".concat(xA,"/").concat(Pk()?"zh-cn":"en","/tutorial-21-advanced-auto-play-policy.html"),MN="<br><a href='".concat(xN,"' target='_blank'>").concat(Pk()?"其他方案？":"Any other solution?","</a>"),UN="".concat(Pk()?"浏览器自动播放策略：在用户与页面产生交互（点击、触摸）之前，浏览器禁止播放有声媒体。该弹窗用于帮助用户恢复音视频播放。".concat(MN):"Autoplay Policy: Before user interacts with the web page (clicking, touching), page will not be allowed to play media with sound. This Dialog is used to help users resume playback. ".concat(MN)),FN=class{constructor(){if(vA(this,"content","音视频播放被浏览器拦截，请点击“恢复播放”。"),vA(this,"_dialogNode",null),vA(this,"_bodyPosition",""),vA(this,"_showDetail",!1),vA(this,"_isCollapseClicked",!1),vA(this,"_isQuestionClicked",!1),Pk()||(this.content='Media playback failed. Click the "Resume" to resume playback.'),!LN){let e=document.createElement("style");e.innerHTML=".".concat(_N,"{position:fixed;top:0;left:0;right:0;bottom:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.5);z-index:1500;}.").concat(_N," div:not(.").concat(wN,"){display:block !important;}.").concat(yN,"{padding:14px;background:#fff;border-radius:3px;box-shadow:0px 3px 15px #434343;border:1px solid #d1cfcf;max-width:500px;}.").concat(yN," a{color:").concat(RN,";}.").concat(EN,"{overflow:hidden;text-overflow:ellipsis;font-size:16px;font-weight:600;}.").concat(bN,"{margin:8px 0;}.").concat(wN,"{width:100%;display:flex !important;align-items:center;justify-content:right;float:right;}.").concat(TN,"{margin-right:auto;cursor:pointer}.").concat(IN,"{height:100%;line-height:16px;cursor:pointer;}.").concat(SN,"{margin-left:8px;color:#fff;background:").concat(RN,";padding:4px 12px;outline:none;border:1px solid;border-radius:3px;font-weight:bold;}.").concat(SN,":hover{opacity:0.9;}.").concat(TN,",.").concat(SN,",.").concat(bN,",.").concat(IN,"{font-size:14px;}@media screen and (max-width:750px){.").concat(yN,"{width:80vw;}}"),document.head.appendChild(e),LN=!0}this.addDiaLog()}createDiaLog(){let e=document.createElement("template");e.innerHTML='<div class="'.concat(_N,"\"><div class='").concat(yN,"'><div class='").concat(EN,"'>").concat(location.host,"</div><div class='").concat(bN,"'>").concat(this.content,"</div><div class='").concat(AN,'\' style="visibility:hidden;width:100%;height:0;font-size:12px;color:gray;">').concat(UN,"</div><div class='").concat(wN,"'></div></div></div>").trim();let t=document.createElement("button");t.className=SN,t.innerText=Pk()?"恢复播放":"Resume",t.onclick=this.onConfirm.bind(this);let i=document.createElement("div");i.className=IN,i.innerHTML='<?xml version="1.0" encoding="UTF-8"?>\n    <svg class="icon" width="18" height="18" p-id="2030" t="1639646523624" version="1.1" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg">\n    <path d="m464 784.35c0 26.51 21.49 48 48 48s48-21.49 48-48-21.49-48-48-48-48 21.49-48 48z" p-id="2031"/>\n    <path d="m512 960c-247.04 0-448-200.96-448-448s200.96-448 448-448 448 200.96 448 448-200.96 448-448 448zm0-831.71c-211.58 0-383.71 172.13-383.71 383.71 0 211.55 172.13 383.71 383.71 383.71 211.55 0 383.71-172.16 383.71-383.71 0-211.58-172.16-383.71-383.71-383.71z" p-id="2032"/>\n    <path d="m512 673.7c-17.665 0-32.001-14.336-32.001-31.999v-54.112c0-52.353 40-92.352 75.328-127.65 25.887-25.92 52.672-52.672 52.672-74.017 0-53.343-43.072-96.735-95.999-96.735-53.823 0-95.999 41.536-95.999 94.559 0 17.665-14.336 31.999-32.001 31.999s-32.001-14.336-32.001-31.999c0-87.424 71.775-158.56 160-158.56s160 72.095 160 160.74c0 47.904-36.32 84.192-71.424 119.3-27.84 27.776-56.576 56.512-56.576 82.336v54.112c0 17.665-14.336 32.032-32.001 32.032z" p-id="2033"/>\n    </svg>\n    ',i.onclick=this.onQuestionClick.bind(this);let r=document.createElement("div");r.className=TN,r.innerText="".concat(Pk()?"详情 >":"Detail >"),r.onclick=this.onCollapseClick.bind(this);let n=e.content.firstChild,a=n.querySelector(".".concat(wN));return a.appendChild(r),a.appendChild(i),a.appendChild(t),n}addDiaLog(){PN()||(NN=!0,this._dialogNode=this.createDiaLog(),document.body.appendChild(this._dialogNode),this._dialogNode.onclick=this.onConfirm.bind(this),this._dialogNode.querySelector(".".concat(yN)).onclick=e=>e.stopPropagation(),this._bodyPosition=document.body.style.position,document.body.style.position="fixed",SO.info("show autoplay dialog"),fN.uploadEvent({log:CN}))}deleteDialog(){this._dialogNode&&(document.body.removeChild(this._dialogNode),document.body.style.position=this._bodyPosition,this._dialogNode=null,NN=!1),BN=null}onConfirm(){SO.warn("confirm clicked, try resume stream"),bO.emit(wO.AUTOPLAY_DIALOG_CLICK_CONFIRM),this.deleteDialog()}onCollapseClick(){let e=this._dialogNode.querySelector(".".concat(AN));e.style.visibility="".concat(this._showDetail?"hidden":"visible"),e.style.height="".concat(this._showDetail?0:"fit-content"),this._showDetail=!this._showDetail,this._isCollapseClicked||fN.uploadEvent({log:DN}),this._isCollapseClicked=!0}onQuestionClick(){window.open(xN,"_blank"),this._isQuestionClicked||fN.uploadEvent({log:ON}),this._isQuestionClicked=!0}},BN=null;var VN,HN=class extends gN{constructor(e){super(e,GA),vA(this,"stat",{}),vA(this,"_calculateTimeout",-1),vA(this,"viewMirror",!1),vA(this,"objectFit","cover"),vA(this,"container"),vA(this,"canvas"),vA(this,"shouldRenderAlpha",!1),vA(this,"_preSize",{width:0,height:0}),vA(this,"posterImg"),vA(this,"pipWindow"),vA(this,"enterPIPPromise"),vA(this,"_originContainerPosition"),vA(this,"_isResettingSrcObject",!1),this.mode=e.canvas?1:0,this.container=e.container,this.canvas=e.canvas,Vk(e.viewMirror)||(this.viewMirror=e.viewMirror),Vk(e.objectFit)||(this.objectFit=e.objectFit),this.initializeElement()}get isPlaying(){var e;return!("PLAYING"!==this._state||this.element&&this.element.paused)&&("live"===(null==(e=this.track)?void 0:e.readyState)&&!this.track.muted)}initializeElement(){var e;let t=document.createElement(GA);this.track&&2!==this.mode&&(t.srcObject=new MediaStream([this.track])),t.muted=!0,t.setAttribute("id","video_".concat(this.id)),t.setAttribute("style",this.styleAttribute),this.canvas&&this.canvas.setAttribute("style",this.styleAttribute),t.setAttribute("autoplay","autoplay"),t.setAttribute("playsinline","playsinline"),this.element=t,iD&&(t.poster="data:,"),null==(e=this.container)||e.appendChild(this.elementToRender),this.bindElementEvents(),this.calculateStat()}get styleAttribute(){let e="width:100%;height:100%;object-fit:".concat(this.objectFit,";").concat(this.shouldRenderAlpha?"":"background-color:black",";");return this.viewMirror&&(e+="transform:scaleX(-1);"),e}setContainer(e){var t;this.container=e,this._pausedRetryCount=5,this.track&&this.elementToRender&&(null==(t=this.container)||t.appendChild(this.elementToRender))}bindElementEvents(){let e=super.bindElementEvents();this.handleElementEvent=this.handleElementEvent.bind(this),this.handleFullscreenChange=this.handleFullscreenChange.bind(this),this.handleVolumeChange=this.handleVolumeChange.bind(this),e&&e.add(aR,this.handleElementEvent).add(oR,this.handleElementEvent).add(cR,this.handleElementEvent),this.element&&(this.element.addEventListener(sR,this.handleFullscreenChange),this.element.addEventListener("webkitbeginfullscreen",this.handleFullscreenChange),this.element.addEventListener("webkitendfullscreen",this.handleFullscreenChange),this.element.addEventListener("volumechange",this.handleVolumeChange))}handleTrackEvent(e){var t;return e.type===YA&&(null!=(t=this.stat)&&t.fps&&(this.stat.fps=0),this.isFullscreen()&&this.resetSrcObjectToReplay()),super.handleTrackEvent(e)}handleFullscreenChange(){this.isFullscreen()?(this._log.info("enter fullscreen"),this.emit(lN.ENTER_FULL_SCREEN)):(this._log.info("leave fullscreen"),this.emit(lN.LEAVE_FULL_SCREEN))}handleVolumeChange(){var e;(this.isPictureInPicture()||this.isFullscreen())&&this.emit(lN.VOLUME_CHANGE,{muted:null==(e=this.element)?void 0:e.muted})}handleElementEvent(e){var t,i,r,n,a,o;if(2===this.mode)return;super.handleElementEvent(e);let s=e.type,c=this.isPictureInPicture(),l=this.isFullscreen(),d=e.isTrusted&&(c&&nO||l);if(s===JA&&d&&!this._isResettingSrcObject&&(this._log.warn("user resume in ".concat(l?"fullscreen":"pip")),this.emit(lN.USER_RESUME_IN_PIP_OR_FULL_SCREEN)),s===QA&&(d&&(this._log.warn("user pause in ".concat(l?"fullscreen":"pip")),this.emit(lN.USER_PAUSE_IN_PIP_OR_FULL_SCREEN)),this.container&&!this.container.isConnected&&(this._log.warn("".concat(this.kind," player has been remove, element ID: ").concat(this.container.id)),EC(500).then(()=>{var e;null!=(e=this.container)&&e.isConnected&&(this._pausedRetryCount=5,this._log.info("view container ".concat(this.container.id," is in dom, reset pausedRetryCount")))})),this._pausedRetryCount>0&&!PN()&&!this.isPausedByUserCall&&!d&&(this._log.info("[".concat(5-this._pausedRetryCount+1,"/").concat(5,"] ").concat(this.kind," player auto resume when paused")),this.doResume(),this._pausedRetryCount--),eD&&!d&&(this._interval=cN.run("timeout",()=>{this.element&&"PAUSED"===this._state&&!this.isPausedByUserCall&&this.doResume()},{delay:3e3})),this.stat.fps&&(this.stat.fps=0)),this.viewMirror&&this.element){let e=this.element.style.transform;s===aR?this.element.style.transform=e.replace("scaleX(-1)",""):s===oR&&!e.includes("scaleX")&&(this.element.style.transform="".concat(e," scaleX(-1)"))}s===cR&&(this._preSize.height!==(null==(t=this.element)?void 0:t.videoHeight)||this._preSize.width!==(null==(i=this.element)?void 0:i.videoWidth))&&(this._log.info("video size changed to ".concat(null==(r=this.element)?void 0:r.videoWidth,"x").concat(null==(n=this.element)?void 0:n.videoHeight)),this._preSize.height=(null==(a=this.element)?void 0:a.videoHeight)||0,this._preSize.width=(null==(o=this.element)?void 0:o.videoWidth)||0,this.emit(lN.RESIZE,{newWidth:this._preSize.width,newHeight:this._preSize.height})),s===oR&&(this._log.warn("exit pip"),this.isPaused&&!this.isPausedByUserCall&&(this._log.warn("resume after exit pip"),this.doResume()),this.resetSrcObjectToReplay(),this.emit(lN.LEAVE_PICTURE_IN_PICTURE)),s===aR&&this.emit(lN.ENTER_PICTURE_IN_PICTURE)}resetSrcObjectToReplay(){iD&&iO&&this.isPlayCalled&&this.element&&this.track&&!this.isPausedByUserCall&&(this._log.warn("reset srcObject to replay for android chromium"),this._isResettingSrcObject=!0,this.element.srcObject=new MediaStream([this.track]),this.element.play().catch(e=>{this._log.warn("play failed after reset srcObject",e)}).finally(()=>{this._isResettingSrcObject=!1}))}setCanvas(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var i,r,n,a;this.canvas!==e&&(null==(i=this.canvas)||i.remove(),null==e||e.setAttribute("style",this.styleAttribute),this.canvas=e,this.mode=e?t:0,2===this.mode&&this.setTrack(e.captureStream().getVideoTracks()[0]),e?(null==(r=this.element)||r.remove(),null==(n=this.container)||n.appendChild(e)):this.element&&(null==(a=this.container)||a.appendChild(this.element)))}setAttr(e){let t=Object.assign({autoplay:"autoplay",playsinline:"playsinline",muted:!0},e);t.style=Object.assign({width:"100%",height:"100%"},t.style),super.setAttr(t)}get mirror(){return this.viewMirror}setRect(e,t){this.elementToRender&&(this.elementToRender.style.width="".concat(e,"px"),this.elementToRender.style.height="".concat(t,"px"))}setViewMirror(e){this.elementToRender&&(this.elementToRender.style.transform=e?"scaleX(-1)":""),this.viewMirror=e}setObjectFit(e){this.elementToRender&&(this.elementToRender.style.objectFit="".concat(e)),this.objectFit=e}setPoster(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise(i=>{if(!this.element||(this._log.info("setPoster",e.slice(0,10)),""===e?this.element.removeAttribute("poster"):this.element.poster=e,!t||!nO&&!nD))return i();if(""===e)return this.removePosterImg(),i();if(this.posterImg)return i();let r=document.createElement("img");r.src=e;let n=window.getComputedStyle(this.element).objectFit||this.objectFit;r.style="position:absolute;top:0;left:0;width:100%;height:100%;object-fit:".concat(n,";"),r.onload=async()=>{var e;try{r.decode&&await r.decode(),this.container&&"static"===window.getComputedStyle(this.container).position&&(this._originContainerPosition=this.container.style.position,this.container.style.position="relative"),this.posterImg=r,null==(e=this.container)||e.appendChild(r),tD()&&lO<=17&&this.elementToRender&&(this.elementToRender.style.visibility="hidden")}catch(t){this._log.warn("decode poster image error",t)}return i()},r.onerror=()=>(this._log.warn("load poster image error"),i())})}removePosterImg(){this.posterImg&&(tD()&&lO<=17&&this.elementToRender&&(this.elementToRender.style.visibility=""),this.posterImg.remove(),URL.revokeObjectURL(this.posterImg.src),this.container&&!Vk(this._originContainerPosition)&&"relative"===this.container.style.position&&(this.container.style.position=this._originContainerPosition),delete this.posterImg)}get hasPoster(){var e;return!!this.posterImg||!(null==(e=this.element)||!e.getAttribute("poster"))}async pause(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];super.pause(),!this.isPictureInPicture()&&!this.hasPoster&&(iO||e&&(nD||nO))&&await this.setPoster(this.getVideoFrame(),!0)}resume(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return super.resume(e).then(()=>{var e;(this.posterImg||null!=(e=this.element)&&e.poster)&&this.setPoster("",!0)})}doResume(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.isPaused&&e&&this.element&&this.track&&iO&&"video"===this.track.kind&&(this.element.srcObject=new MediaStream([this.track])),super.doResume()}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;var t;this.isPictureInPicture()&&this.exitPictureInPicture().catch(e=>{}),this.isFullscreen()&&this.exitFullscreen().catch(e=>{}),this.element&&(this.element.removeEventListener(sR,this.handleFullscreenChange),this.element.removeEventListener("webkitbeginfullscreen",this.handleFullscreenChange),this.element.removeEventListener("webkitendfullscreen",this.handleFullscreenChange),this.element.removeEventListener("volumechange",this.handleVolumeChange)),super.stop(e),null==(t=this.canvas)||t.remove(),this.removePosterImg()}play(){return this.element?this.elementToRender&&this.elementToRender.parentElement!==this.container&&this.container&&this.container.append(this.elementToRender):this.initializeElement(),2===this.mode?Promise.resolve():super.play()}get elementToRender(){return this.canvas||this.element}setTrack(e){e!==this.track&&(this.unbindTrackEvents(),this.track=e,this.emit(lN.MEDIA_TRACK_CHANGED,e),null!==e&&(this.bindTrackEvents(),this.element&&2!==this.mode&&(this.element.srcObject=new MediaStream([e]),this.element.remove()),this.elementToRender&&this.elementToRender.parentElement!==this.container&&this.container&&this.container.append(this.elementToRender)))}getVideoFrame(){if(this.canvas)return this.canvas.toDataURL("image/png");if(!this.element)return"";let e=document.createElement("canvas");return e.width=this.element.videoWidth,e.height=this.element.videoHeight,e.getContext("2d").drawImage(this.element,0,0),e.toDataURL("image/png")}getElement(){return this.element}calculateStat(){try{if(BL()&&this.element&&this._calculateTimeout<0){let e=0,t=null,i=(r,n)=>{this.stat.width=n.width,this.stat.height=n.height,t&&(this.stat.fps=Math.round((n.presentedFrames-t.presentedFrames)/(r-e)*1e3)),e=r,t=n,this._calculateTimeout=-1,this.element&&(this._calculateTimeout=setTimeout(()=>{var e;return null==(e=this.element)?void 0:e.requestVideoFrameCallback(i)},2e3))};this.element.requestVideoFrameCallback(i)}}catch(fx){this._log.warn("init stat failed",fx)}}async enterFullscreen(){let e=this.elementToRender;if(!e)throw this._log.warn("no element to render, cannot enter fullscreen"),new Error("No element available for fullscreen");if(eD&&this.isPictureInPicture()){this._log.info("exit pip before entering fullscreen");try{await this.exitPictureInPicture()}catch(CA){this._log.warn("exit pip failed before fullscreen:",CA)}}try{if(e.requestFullscreen)await e.requestFullscreen();else if(e.webkitRequestFullscreen)await e.webkitRequestFullscreen();else if(e.webkitEnterFullscreen)await e.webkitEnterFullscreen();else if(e.mozRequestFullScreen)await e.mozRequestFullScreen();else{if(!e.msRequestFullscreen)throw new Error("Fullscreen API not supported");await e.msRequestFullscreen()}this._log.info("entered fullscreen mode")}catch(CA){throw this._log.error("failed to enter fullscreen:",CA),CA}}async exitFullscreen(){try{if(!this.isFullscreen())return;if(document.exitFullscreen)await document.exitFullscreen();else if(document.webkitExitFullscreen)await document.webkitExitFullscreen();else if(document.mozCancelFullScreen)await document.mozCancelFullScreen();else{if(!document.msExitFullscreen)throw new Error("Exit fullscreen API not supported");await document.msExitFullscreen()}this._log.info("exited fullscreen mode")}catch(fx){throw this._log.error("failed to exit fullscreen:",fx),fx}}isFullscreen(){let e=this.elementToRender;return!!e&&(this.element&&this.element.webkitDisplayingFullscreen?!this.isPictureInPicture():(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)===e)}async toggleFullscreen(){this.isFullscreen()?await this.exitFullscreen():await this.enterFullscreen()}async enterPictureInPicture(){this.enterPIPPromise=this._enterPictureInPicture();try{return await this.enterPIPPromise}finally{delete this.enterPIPPromise}}async _enterPictureInPicture(){var e;try{if(!this.element)throw new Error("No video element available for pip");if(this.canvas&&1!==this.mode)throw new Error("pip is not supported for canvas-only mode");let{element:t}=this;if(t.requestPictureInPicture){this._log.info("requestPictureInPicture");let i=await t.requestPictureInPicture();return this.pipWindow=i,this._log.info("entered pip mode"),this.elementToRender===this.canvas&&(this.canvas.remove(),null==(e=this.container)||e.appendChild(this.element)),i}if(t.webkitSetPresentationMode)return this._log.info("webkitSetPresentationMode"),await t.webkitSetPresentationMode("picture-in-picture"),this._log.info("entered pip mode (webkit)"),{};throw new Error("pip API not supported")}catch(CA){throw this._log.error("failed to enter pip:",CA.name,CA.message),CA}}async exitPictureInPicture(){var e,t;try{if(!this.isPictureInPicture())return;if(delete this.pipWindow,document.pictureInPictureElement&&document.exitPictureInPicture)await document.exitPictureInPicture(),this.elementToRender===this.canvas&&(null==(e=this.element)||e.remove(),this._pausedRetryCount=5,null==(t=this.container)||t.appendChild(this.canvas)),this._log.info("exited pip mode");else{if(!this.element||!this.element.webkitSetPresentationMode)throw new Error("Exit pip API not supported or not in PiP mode");await this.element.webkitSetPresentationMode("inline"),this._log.info("exited pip mode (webkit)")}}catch(i){throw this._log.error("failed to exit pip:",i),i}}isPictureInPicture(){if(!this.element)return!1;let{element:e}=this;return document.pictureInPictureElement?document.pictureInPictureElement===e:!!e.webkitPresentationMode&&"picture-in-picture"===e.webkitPresentationMode}async togglePictureInPicture(){this.isPictureInPicture()?await this.exitPictureInPicture():await this.enterPictureInPicture()}};"undefined"!=typeof AudioContext?VN=AudioContext:"undefined"!=typeof webkitAudioContext?VN=webkitAudioContext:"undefined"!=typeof mozAudioContext&&(VN=mozAudioContext);var jN,zN=-1,WN=0,GN=-1,qN=!1,KN=0,YN=-1,XN=-1;!function e(){try{if(jN)return;(jN=new VN({sampleRate:48e3})).onstatechange=()=>{SO.info("context state: ".concat(jN.state).concat("running"!==jN.state?" visibilityState: ".concat(document.visibilityState):"")),ZN()},clearTimeout(zN)}catch(JS){SO.error("initAudioContext failed: ".concat(JS," typeof AudioContextClass: ").concat(typeof VN)),zN=setTimeout(e,1e3)}}();var ZN=()=>{"suspended"===jN.state?(WN=eC(),-1===GN&&(GN=setTimeout(()=>{"suspended"===jN.state&&(qN=!0,bO.emit("155",{isSuspended:!0}))},1500)),$N(),document.addEventListener("click",ZN)):"interrupted"===jN.state?$N():(WN&&(FO.addNumber({key:507800,value:eC()-WN,split:[0,500,1e3,1500,2e3,3e3,4e3,5e3,1e4,3e4],max:6e4}),WN=0),-1!==GN&&(clearTimeout(GN),GN=-1,qN&&(qN=!1,bO.emit("155",{isSuspended:!1}))),document.removeEventListener("visibilitychange",ZN),document.removeEventListener("click",ZN))},JN=0,QN=-1;function $N(){return new Promise((e,t)=>{if("running"===jN.state)return e();Date.now()-JN<1e3?(clearTimeout(QN),QN=setTimeout(()=>{JN=Date.now(),jN.resume().then(e,t)},1e3)):(clearTimeout(QN),JN=Date.now(),jN.resume().then(e,t))}).catch(e=>{SO.warn("context resume failed: ".concat(e)),document.addEventListener("visibilitychange",ZN)})}document.addEventListener("click",ZN);var eP=e=>jN,tP=class{constructor(e){this.name=e,vA(this,"node"),vA(this,"node2"),vA(this,"pre",new Set),vA(this,"next",new Set),vA(this,"context"),vA(this,"connectedNodes",new Set),vA(this,"nextInputChannelMap",new Map),vA(this,"_channelCount",1)}get channelCount(){return this._channelCount}set channelCount(e){this._channelCount=e,this.setChannelCount(this.node,e),this.setChannelCount(this.node2,e),this.next.forEach(t=>t.channelCount=e)}setChannelCount(e,t){!e||e instanceof ScriptProcessorNode||(e.channelCountMode="explicit",e.channelCount=t||this.channelCount||1)}setContext(e){this.context=e,this.node&&e.addMixWeight()}removeContext(){var e;this.node&&(null==(e=this.context)||e.reduceMixWeight()),delete this.context}replaceNode(e){var t;if(e!==this.node)try{this.node?this._disconnect():null==(t=this.context)||t.addMixWeight(),this.node=e,this.setChannelCount(this.node),this.preNodeReconnect(),this.reconnect()}catch(CA){SO.error(CA)}}setNode(e,t){var i;if(!this.node)try{null==(i=this.context)||i.addMixWeight(),this.node=e,this.setChannelCount(this.node),t&&(this.node2=t,this.setChannelCount(this.node2)),this.preNodeReconnect(),this.reconnect(),FO.addSuccessEvent({key:502701})}catch(r){SO.error(r),FO.addFailedEvent({key:502701,error:r})}}deleteNode(){var e;if(this.node)try{this._disconnect(),delete this.node,delete this.node2,null==(e=this.context)||e.reduceMixWeight(),this.preNodeReconnect(),FO.addSuccessEvent({key:502702})}catch(fx){SO.error(fx),FO.addFailedEvent({key:502702,error:fx})}}preNodeReconnect(){this.pre.forEach(e=>{e.node?e.reconnect():e.preNodeReconnect()})}connectNext(e){this.next.forEach(t=>{let i=this.nextInputChannelMap.get(t);e._connect(t.node,i)||t.connectNext(e)})}_connect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(!this.node||!e)&&((this.node2||this.node).connect(e,0,t),this.connectedNodes.add(e),!0)}_disconnect(){this.connectedNodes.forEach(e=>{var t;return null==(t=this.node2||this.node)?void 0:t.disconnect(e)}),this.connectedNodes.clear()}reconnect(){this._disconnect(),this.connectNext(this)}pipeTo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.next.add(e),e.pre.add(this),this.nextInputChannelMap.set(e,t),e}},iP=class extends tP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;super(),this.fftSize=e,vA(this,"dataArray",new Uint8Array(0))}setNode(e){e.fftSize=this.fftSize,this.dataArray=new Uint8Array(e.frequencyBinCount),super.setNode(e)}getByteTimeDomainData(){var e;return null==(e=this.node)||e.getByteTimeDomainData(this.dataArray),this.dataArray}get level(){var e;return null==(e=this.node)||e.getByteTimeDomainData(this.dataArray),Math.max(...this.dataArray)/128-1}get timeDomainPathData(){let e=this.getByteTimeDomainData(),t=0,i=0,r="M".concat(t,",").concat(i);for(let n=0;n<e.length;n++)i=e[n]/128*100/2,r+="L".concat(t,",").concat(i),t+=1;return r}},rP=class{constructor(){vA(this,"source",new tP),vA(this,"gain",new tP),vA(this,"destination",new tP)}get volume(){var e;return(null==(e=this.gain.node)?void 0:e.gain.value)||1}setVolume(e){1!==e?(this.gain.node||this.gain.setNode(eP().createGain()),this.gain.node.gain.value=e):this.gain.node&&this.gain.deleteNode()}replaceSource(e){let t=function(t){try{let e=nP.get(t);if(e)return e;let i=eP();if(t instanceof HTMLAudioElement)e=i.createMediaElementSource(t);else{if(!(t instanceof MediaStreamTrack))return t;e=i.createMediaStreamSource(new MediaStream([t]))}return nP.set(t,e),e}catch(e){if(!(nD&&e instanceof Error&&"NotSupportedError"===e.name))throw e;SO.warn(e)}}(e);t&&this.source.replaceNode(t)}get track(){var e;return null==(e=this.stream)?void 0:e.getAudioTracks()[0]}get stream(){var e;return null==(e=this.destination.node)?void 0:e.stream}},nP=new WeakMap;var aP=class e{constructor(e){vA(this,"_volume",0),vA(this,"_volumeDb",0),vA(this,"_log"),vA(this,"_scriptProcessorNode",null),vA(this,"_audioWorkletNode",null),vA(this,"_interval",200),vA(this,"ready",this.preload());let{log:t}=e;this._log=t,bO.on(wO.AUDIO_LEVEL_INTERVAL,this.handleAudioLevelInterval,this)}static get isRunning(){return Date.now()-e.lastMessageTime<2e3}get node(){return this._audioWorkletNode||this._scriptProcessorNode}preload(){if(!e.workletReady){let t='class VolumeMeterWorklet extends AudioWorkletProcessor{constructor(){super(),this.volume=0,this.intervalTime=200,this.tick=200,this.isStop=!1,this.cache=[],this.sentFirstInfo1=!1,this.unmute=!1,this.port.onmessage=t=>{var e=t.data;switch(e.name){case"chunk":this.cache.push(...e.data),this.sentFirstInfo1||(this.port.postMessage({cl:e.data.length}),this.sentFirstInfo1=!0);break;case"setIntervalTime":this.intervalTime=e.intervalTime;break;case"unmute":this.unmute=!0;break;case"stop":this.isStop=!0}}}process(t,s){t=t[0],s=s[0];if(t||s){if(this.isStop)return!1;var i=s&&s[0]?s[0].length:0,h=this.cache.length,a=(i<h?(s[0].set(this.cache.slice(0,i)),this.cache=this.cache.slice(i)):this.unmute&&s[0].set(t[0]),(i<h?s:t)[0]);if(a){let e=0;for(let t=0;t<a.length;++t)e=Math.max(Math.abs(a[t]),e);s=a.reduce((t,e)=>t+e*e,0)/a.length;this.volume=e,this.tick-=a.length,this.tick<0&&(this.tick+=this.intervalTime/1e3*sampleRate,this.port.postMessage({volume:this.volume,volumeDb:Math.max(10*Math.log10(s)+100,0)/100,cacheLen:h,outputLen:i}))}}return!0}}registerProcessor("volume-meter",VolumeMeterWorklet);';e.workletReady=async function(e,t){if(!e.audioWorklet)return Promise.reject("audioWorklet is not supported");try{await e.audioWorklet.addModule(t),SO.info("worklet addModule success")}catch(fx){throw SO.info("worklet addModule catch error. ".concat(fx.message)),fx}}(e.audioContext,URL.createObjectURL(new Blob([t],{type:"application/javascript"})))}return e.workletReady.then(()=>this.initAudioWorklet()).catch(e=>(this._log.error("volumeMeter preload error: ".concat(e)),this.initScriptProcessor()))}initAudioWorklet(){if(!this._audioWorkletNode)try{this._audioWorkletNode=new AudioWorkletNode(e.audioContext,"volume-meter");let t=!1;this._audioWorkletNode.port.onmessage=i=>{e.lastMessageTime=Date.now(),this._volume=i.data.volume||0,this._volumeDb=i.data.volumeDb||0,!t&&i.data.cacheLen&&i.data.outputLen&&(this._log.warn("worklet play success"),t=!0)},this.handleAudioLevelInterval({interval:this._interval})}catch(t){this._log.error("volumeMeter init audio worklet error: ".concat(t)),fN.logFailedEvent({userId:this._log.userId,eventType:dR,error:t}),this.initScriptProcessor()}}initScriptProcessor(){if(!this._scriptProcessorNode)try{this._scriptProcessorNode=eP().createScriptProcessor(2048,1,1),this._scriptProcessorNode.onaudioprocess=t=>{e.lastMessageTime=Date.now();let i=t.inputBuffer.getChannelData(0),r=0;for(let e=0;e<i.length;++e)r+=i[e]*i[e];this._volume=Math.sqrt(r/i.length)||0}}catch(t){this._log.error("volumeMeter init script processor error: ".concat(t))}}destroy(){this._scriptProcessorNode&&(this._scriptProcessorNode.onaudioprocess=null),this._audioWorkletNode&&(this._audioWorkletNode.port.postMessage({name:"stop"}),this._audioWorkletNode.port.onmessage=null),this._audioWorkletNode=null,this._scriptProcessorNode=null,bO.off(wO.AUDIO_LEVEL_INTERVAL,this.handleAudioLevelInterval,this)}getInternalAudioLevel(){return this._volume}getCalculatedVolume(){return parseFloat(this._volume.toFixed(2))}getVolumeDb(){return Math.floor(100*this._volumeDb)}handleAudioLevelInterval(e){var t;let{interval:i}=e;this._interval=i,null==(t=this._audioWorkletNode)||t.port.postMessage({name:"setIntervalTime",intervalTime:i})}};vA(aP,"lastMessageTime",0),vA(aP,"audioContext",eP()),vA(aP,"workletReady");var oP=aP,sP=class extends tP{constructor(e){super(),vA(this,"_volumeMeter"),this._volumeMeter=new oP(e)}deleteNode(){super.deleteNode(),this._volumeMeter.destroy()}async init(){await this._volumeMeter.preload(),this.setNode(this._volumeMeter.node)}getCalculatedVolume(){return this._volumeMeter.getCalculatedVolume()}getInternalAudioLevel(){return this._volumeMeter.getInternalAudioLevel()}getVolumeDb(){return this._volumeMeter.getVolumeDb()}write(e){if(this.node){let t=e.allocationSize({planeIndex:0}),i=new Float32Array(t>>2);e.copyTo(i,{planeIndex:0}),this.node.port.postMessage({name:"chunk",data:i},[i.buffer]),e.close()}}},cP=mA(yA(),1),lP=e=>t=>t.deviceId===e,dP=class{constructor(e,t){vA(this,"kind"),vA(this,"type"),vA(this,"devices",[]),this.kind=e,this.type=t}update(e,t){let i=e.filter(e=>e.kind==="".concat(this.kind).concat(this.type.toLocaleLowerCase()));1===this.devices.length&&pP(this.devices[0])||t&&(i.forEach(e=>{if(e.deviceId&&!this.devices.find(lP(e.deviceId))){let i="".concat(this.kind).concat(this.type,"Added");SO.warn("".concat(i,": ").concat(JSON.stringify(e))),t.emit(i,e)}}),this.devices.forEach(e=>{if(e.deviceId&&!i.find(lP(e.deviceId))){let i="".concat(this.kind).concat(this.type,"Removed");SO.warn("".concat(i,": ").concat(JSON.stringify(e))),t.emit(i,e)}})),this.devices=i}hasDevice(e){return!!this.devices.find(t=>t.deviceId===e)}},uP=class extends cP.EventEmitter{constructor(){super(),vA(this,"audioInputs",new dP(WA,"Input")),vA(this,"videoInputs",new dP(GA,"Input")),vA(this,"audioOutputs",new dP(WA,"Output")),this.init(),navigator.mediaDevices&&(navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",()=>this.update()),"ondevicechange"in navigator.mediaDevices||cN.run("interval",()=>{this.update()},{delay:1e4}))}init(){fP().then(e=>{this.audioInputs.update(e),this.videoInputs.update(e),this.audioOutputs.update(e)})}async update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=await fP(e);return this.audioInputs.update(t,this),this.videoInputs.update(t,this),this.audioOutputs.update(t,this),this}hasBlueTooth(){var e;if(1e3*(null==(e=eP())?void 0:e.outputLatency)>150)return!0;let t=["bluetooth","air","wireless","bt","tws","buds","headset","headphone"];return this.audioOutputs.devices.some(e=>t.some(t=>e.label.toLowerCase().includes(t)))||this.audioInputs.devices.some(e=>t.some(t=>e.label.toLowerCase().includes(t)))}},hP=PA||NA?null:new uP;function pP(e){return e.deviceId===e.groupId&&""===e.groupId}async function fP(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(qO()||!WO())return[];let t=await navigator.mediaDevices.enumerateDevices();if(0!==e){let r={audio:!1,video:!1};if(t.forEach(e=>{pP(e)&&(e.kind===rR?r.audio=!0:e.kind===nR&&(r.video=!0))}),2===e&&(r.audio=!1),1===e&&(r.video=!1),r.audio||r.video){let e;try{e=await navigator.mediaDevices.getUserMedia(r),r.audio&&$N()}catch(i){SO.debug("capture before getDevices failed: ",i)}t=await navigator.mediaDevices.enumerateDevices(),null==e||e.getTracks().forEach(e=>e.stop())}}return t.map((e,t)=>{let i={kind:e.kind,deviceId:e.deviceId,groupId:e.groupId,label:e.label||"".concat(e.kind,"_").concat(t)};return e.deviceId.length>0&&yP.add("".concat(e.deviceId,"_").concat(e.kind)),e.getCapabilities&&(i.getCapabilities=()=>e.getCapabilities()),i})}function mP(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return hP.update(e?1:0).then(e=>e.audioInputs.devices)}function gP(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return hP.update(e?2:0).then(e=>e.videoInputs.devices)}var vP=!1;async function _P(){try{vP||(vP=!0,SO.info("speakers:".concat((await async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(eD||nO)&&(e=!1),hP.update(e?1:0).then(e=>e.audioOutputs.devices)}()).map(e=>" ".concat(e.deviceId.slice(0,8),": ").concat(e.label)))))}catch(JS){}}var yP=new Set;async function EP(e){let{newDeviceId:t,oldDeviceId:i,oldGroupId:r,oldLabel:n,kind:a}=e;return t===i&&(a!==WA||t!==hR||await async function(e,t){let i=(await mP()).find(e=>e.deviceId===hR);return!t&&(null==i?void 0:i.groupId)===e||(null==i?void 0:i.groupId)===e&&i.label===t}(r,n))}var bP,wP=class extends rP{constructor(e){super(),this.log=e,vA(this,"volumeMeter"),vA(this,"volumeMeterAfter3A"),vA(this,"volumeDestination"),vA(this,"analyser",new iP),this.volumeMeter=new sP({log:this.log}),this.volumeMeterAfter3A=new sP({log:this.log}),this.volumeDestination=new tP,this.volumeMeter.pipeTo(this.volumeDestination)}destroy(){this.gain.deleteNode(),this.volumeMeter.deleteNode(),this.analyser.deleteNode(),this.source.deleteNode(),this.destination.deleteNode(),this.volumeDestination.deleteNode()}},IP=class extends gN{constructor(e){super(e,WA),vA(this,"_outputDeviceId"),vA(this,"_floatVolume",1),vA(this,"_destination"),vA(this,"pipeline"),vA(this,"volumeMeterMode","worklet"),vA(this,"enableVolumeControlInIOS"),this.enableVolumeControlInIOS=e.enableVolumeControlInIOS,this.mode=0,e.url&&(this.url=e.url),this.pipeline=new wP(this._log)}setTrack(e){}get duration(){var e;return Math.floor(1e3*((null==(e=this.element)?void 0:e.duration)||0))}get currentTime(){var e;return Math.floor(1e3*((null==(e=this.element)?void 0:e.currentTime)||0))}set currentTime(e){this.element&&(this.element.currentTime=e/1e3)}getMediaStream(){return this.pipeline.stream||(this.track?new MediaStream([this.track]):null)}initializeElement(e){if(("15.2"===sO||"15.3"===sO||"15.4"===sO)&&this.muted)return void this._log.info("audioElement is muted.");let t=bP||new Audio;t.setAttribute("autoplay","autoplay"),t.srcObject=this.getMediaStream(),t.muted=this.muted,this.url&&(t.crossOrigin="anonymous",t.src=this.url),this.element=t,this.setVolume(jk(e)?e/100:this._floatVolume),t===bP&&(bP=void 0),this.options.enableTimeupdateEvent&&(this.element.ontimeupdate=()=>this.emit(lN.TIME_UPDATE,this.currentTime)),this.bindElementEvents()}async play(e){if(this.track||this.url){try{!this.pipeline.source.node&&this.track&&this.pipeline.replaceSource(this.track),this.element||this.initializeElement(null==e?void 0:e.volume),this._outputDeviceId&&await this.setSinkId(this._outputDeviceId),"worklet"===this.volumeMeterMode?(this.pipeline.volumeMeter.init(),this.pipeline.volumeMeterAfter3A.init()):"analyser"===this.volumeMeterMode&&this.pipeline.analyser.setNode(eP().createAnalyser()),_P()}catch(CA){throw this._log.warn("audio play error: ".concat(CA)),cO(sO,"18.7",!0)&&this.bindAutoPlayEvent(),CA}return super.play()}}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.pipeline.destroy(),super.stop(e)}setVolume(e){this._floatVolume=e,this.element&&(this.element.volume=e)}async setSinkId(e){var t,i;this._outputDeviceId!==e&&(this._outputDeviceId=e),this.element&&this.element.sinkId!==e&&await(null==(i=(t=this.element).setSinkId)?void 0:i.call(t,e))}get useDestination(){return!!this.pipeline.stream}setLoop(e){this.element&&(this.element.loop=e)}getAudioLevel(){return this.pipeline.volumeMeter.getCalculatedVolume()}getInternalAudioLevel(){return this.pipeline.volumeMeter.getInternalAudioLevel()}getInternalAudioLevelAfter3A(){return this.pipeline.volumeMeterAfter3A.getInternalAudioLevel()}},TP=class extends IP{constructor(e){super(e),vA(this,"_sourceElement"),vA(this,"_output",new tP),this.pipeline.source.pipeTo(this.pipeline.gain),this.pipeline.gain.pipeTo(this.pipeline.volumeMeter).pipeTo(this._output),this.pipeline.gain.pipeTo(this.pipeline.destination)}setOutput(){this.mode=1,this._output.setNode(eP().destination)}write(e){this.pipeline.volumeMeter.write(e)}setTrack(e){var t,i,r;(null==(i=null==(t=this.element)?void 0:t.error)?void 0:i.code)!==MediaError.MEDIA_ERR_DECODE&&this.track!==e&&(this.unbindTrackEvents(),this.track=e,this.emit(lN.MEDIA_TRACK_CHANGED,e),e?(this.bindTrackEvents(),this._sourceElement?this._sourceElement.srcObject=new MediaStream([e]):!this.useDestination&&this.element&&(this.element.srcObject=new MediaStream([e])),this.pipeline.source.channelCount=(null==(r=e.getSettings())?void 0:r.channelCount)||1,this.pipeline.replaceSource(e)):this.pipeline.source.deleteNode())}setVolume(e){var t;let i=e<=1&&!tD();if(this._floatVolume!==e||!(i&&(null==(t=this.element)?void 0:t.volume)===e||!i&&this.pipeline.volume===e))if(this._floatVolume=e,this.useDestination)this.pipeline.setVolume(e),this._log.info("set pipeline volume: ".concat(e));else if(i)this.element?(this._log.info("set element volume: ".concat(e)),this.element.volume=e):this._log.info("set element volume: no element");else{if(tD()){if(!this.enableVolumeControlInIOS)return;!function(){if(!eD||-1!==XN)return;let e=()=>{eC()-KN<500||(jN&&"running"===jN.state&&jN.currentTime===YN&&(SO.warn("context is fake running, auto resume"),jN.suspend().catch(e=>{SO.warn("context suspend failed: ".concat(e))})),YN=jN.currentTime,KN=eC())};XN=setInterval(()=>{e()},2e3),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&e()})}()}if(nD&&!this.pipeline.source.node)return void this._log.warn("set pipeline volume failed: no source node");this._log.info("start set pipeline volume: ".concat(e)),this.pipeline.setVolume(e),this.element&&!this._sourceElement&&(this._destination||(this._destination=eP().createMediaStreamDestination()),this.pipeline.destination.setNode(this._destination),pN(this.element),this._sourceElement=this.element,this._sourceElement.muted=!0,this.element=null,this.play().catch(e=>{this.emit(lN.AUTOPLAY_FAILED,e)}))}}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.pipeline.destroy();let t=this._sourceElement||this.element;t&&aO&&(bP=t),this._sourceElement&&(this._sourceElement.srcObject=null,delete this._sourceElement),super.stop(e)}},SP=class extends iN{constructor(e){let{userId:t,sdkAppId:i,mediaType:r,room:n,PlayerClass:a=(1===r?TP:HN)}=e;var o;super(),vA(this,"id",AO()),vA(this,"userId",""),vA(this,"isRemote"),vA(this,"mediaType"),vA(this,"room"),vA(this,"user"),vA(this,"_log"),vA(this,"_inputTrack"),vA(this,"_outputTrack"),vA(this,"isPlayCalled"),vA(this,"container",null),vA(this,"player"),vA(this,"subVideoPlayerMap"),vA(this,"muted",!1),vA(this,"abortCtrl"),vA(this,"objectFit","cover"),vA(this,"mirror"),vA(this,"rotation"),vA(this,"isScreen",!1),vA(this,"manager"),vA(this,"trackSettings"),vA(this,"isFirstVideoFrameEmitted",!1),this.userId=t||"",this.mediaType=r,this._log=SO.createLogger({parent:null==n?void 0:n.getLogger(),id:"".concat(this.kind[0],"t"),userId:null==(o=n||this.room)?void 0:o.userId,remoteUserId:this instanceof yx?void 0:this.userId,sdkAppId:i,type:2===this.mediaType?"auxiliary":"main",isLocal:this instanceof yx}),this.player=new a({id:this.userId||this.id,track:null,muted:!1,container:null,log:this._log,enableVolumeControlInIOS:null==n?void 0:n.enableVolumeControlInIOS}),this.player.on(lN.PLAYER_STATE_CHANGED,e=>{if(bO.emit(wO.PLAYER_STATE_CHANGED,dA({track:this},e)),this.emit("player-state-changed",e),"PLAYING"===e.state&&this.room){let e=!0;for(let{remoteAudioTrack:t,remoteVideoTrack:i,remoteAuxiliaryTrack:r}of[...this.room.remotePublishedUserMap.values()])if(t.isAvailable&&!t.player.isPlaying||i.isAvailable&&!i.player.isPlaying||r.isAvailable&&!r.player.isPlaying){e=!1;break}e&&PN()&&BN&&BN.deleteDialog()}}),this.kind===GA&&(this.player.on(lN.LOADED_DATA,()=>{this.emitFirstVideoFrameEvent(lN.LOADED_DATA),bO.emit(wO.VIDEO_LOADED_DATA,{track:this})}),this.player.on(lN.LOADED_META_DATA,()=>{this.emitFirstVideoFrameEvent(lN.LOADED_META_DATA)}),this.player.on(lN.MEDIA_TRACK_CHANGED,e=>{var t;null==(t=this.subVideoPlayerMap)||t.forEach(t=>t.setTrack(e))}),this.player.on(lN.RESIZE,e=>{this.emitFirstVideoFrameEvent(lN.RESIZE),this.emit("video-size-changed",dA({userId:this.userId,streamType:2===this.mediaType?"auxiliary":"main"},e))})),this.onTrackMuted=this.onTrackMuted.bind(this),this.onTrackUnmuted=this.onTrackUnmuted.bind(this),this.onTrackEnded=this.onTrackEnded.bind(this),this.onPlayerError&&this.player.on(lN.ERROR,this.onPlayerError.bind(this)),this.player.on(lN.AUTOPLAY_FAILED,this.handleAutoPlayFailed,this)}get log(){return this._log||SO}get kind(){return 1===this.mediaType?WA:GA}get isAudio(){return this.kind===WA}get strMediaType(){return 4===this.mediaType?GA:2===this.mediaType?qA:WA}get streamType(){return 2&this.mediaType?"auxiliary":"main"}get isMediaTrackActive(){return!!this.mediaTrack&&(!this.mediaTrack.muted&&"live"===this.mediaTrack.readyState&&this.mediaTrack.enabled)}async play(e,t){let i=Gk(e)?e[0]:e;if(this.isPlayCalled)return this.log.info("play update options: ".concat(JSON.stringify(t))),t&&!Vk(t.muted)&&this.setPlayerMute(t.muted),t&&!Vk(t.objectFit)&&(this.objectFit=t.objectFit),void(this.player instanceof HN&&(this.player.setObjectFit(this.objectFit),this.container!==i&&i&&(this.container=i,this.player.setContainer(i)),Gk(e)&&e.length>=1&&await this.playSubContainer(e.slice(1),t)));if(t&&!Vk(t.muted)?this.setPlayerMute(t.muted):(!this.isRemote||this.kind===GA)&&this.setPlayerMute(!0),t&&!Vk(t.objectFit)&&(this.objectFit=t.objectFit),this.player instanceof HN&&(this.player.setObjectFit(this.objectFit),t&&!Vk(t.poster)&&this.player.setPoster(t.poster)),this.isPlayCalled=!0,i&&(this.container=i,this.player instanceof HN&&this.player.setContainer(i)),bO.emit(wO.PLAY_TRACK_START,{track:this}),this._outputTrack){this._log.info("play with options: ".concat(JSON.stringify(t)));try{this.player.setTrack(this.playerMediaTrack),await this.player.play(t),Gk(e)&&e.length>1&&await this.playSubContainer(e.slice(1),t)}catch(r){throw this.handleAutoPlayFailed(r),r}}else this.log.info("play has not mediaTrack, abort")}setMirror(e,t){if(this.isScreen||this.kind!==GA||Vk(e)||e===this.mirror)return;this.mirror=e;let i=this.player;t&&(i=t);let r=this.manager;if(zk(this.mirror))return i.setViewMirror(this.mirror),void(!this.isRemote&&r&&(r.mirror=!1));switch(this.mirror){case"view":r&&(r.mirror=!1),i.setViewMirror(!0);break;case"publish":r&&(r.mirror=!0),i.setViewMirror(!0);break;case"both":r&&(r.mirror=!0),i.setViewMirror(!1)}}async playSubContainer(e,t){if(!this._outputTrack||this.kind===WA)return;this.subVideoPlayerMap||(this.subVideoPlayerMap=new Map),this.subVideoPlayerMap.forEach((t,i)=>{var r;e.find(e=>i===e)||(t.stop(),null==(r=this.subVideoPlayerMap)||r.delete(i))});for(let[r,n]of e.entries()){let e=this.subVideoPlayerMap.get(n);e?t&&(Vk(t.objectFit)||e.setObjectFit(t.objectFit)):this.subVideoPlayerMap.set(n,new HN({id:this.userId||this.id,track:this.playerMediaTrack,container:n,muted:this.player.muted,objectFit:this.objectFit,log:this.log.createChild({id:"vp-sub".concat(r+1)})}))}let i=[...this.subVideoPlayerMap.values()];for(let r of i)r.setViewMirror(this.player.mirror),await r.play()}setAudioOutput(e){return this.player.setSinkId(e)}setAudioVolume(e){this.player.setVolume(e)}getAudioLevel(){return this.player.getAudioLevel()||0}getInternalAudioLevel(){var e;return(null==(e=this.player)?void 0:e.getInternalAudioLevel())||0}stop(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isPlayCalled&&(this.isPlayCalled=!1,this.isFirstVideoFrameEmitted=!1,this.player&&(this.log.info("stop ".concat(this.kind," player")),this.player.stop(HC(this)&&!e?this.jitterBufferDelay:0)),this.subVideoPlayerMap&&this.subVideoPlayerMap.size>0&&this.subVideoPlayerMap.forEach(e=>{e.stop()}),this.container=null)}async resume(){var e;this.isPlayCalled&&await(null==(e=this.player)?void 0:e.resume())}close(){this._toInitState(),this.log.info("close"),this.isPlayCalled&&this.stop(!0)}_toInitState(){}setMute(e){this.muted=e,this._inputTrack&&(this._inputTrack.enabled=!e),this._outputTrack&&(this._outputTrack.enabled=!e),this.emit(e?"mute":"unmute",this),bO.emit(e?wO.TRACK_MUTED:wO.TRACK_UNMUTED,{track:this})}setPlayerMute(e){this.player.setMuted(e)}get mediaTrack(){return this._inputTrack||null}get outMediaTrack(){return this._outputTrack||null}get playerMediaTrack(){return this.outMediaTrack}installTrackEvent(e){hN(e,e).add(YA,this.onTrackMuted).add(XA,this.onTrackUnmuted).add(ZA,this.onTrackEnded),e.muted&&this.onTrackMuted(),e.readyState===ZA&&this.onTrackEnded()}uninstallTrackEvent(e){pN(e)}setInputMediaStreamTrack(e){var t;let i=this._inputTrack;if(e!==i)return this._inputTrack=e,this.trackSettings=null==(t=e.getSettings)?void 0:t.call(e),e.enabled=!this.muted,i&&this.uninstallTrackEvent(i),this.installTrackEvent(e),this.emit("input-media-track-changed",e||null,i||null),this.manager?this.manager.changeInput(this):this.setOutputMediaStreamTrack(e)}setOutputMediaStreamTrack(e){var t;e!==this._outputTrack&&(this.isRemote?this.log.debug("setOutputMediaStreamTrack",e.label):this.log.info("setOutputMediaStreamTrack",null==(t=e.getSettings)?void 0:t.call(e).deviceId,e.label),this._outputTrack=e,this._inputTrack&&(this._outputTrack.contentHint=this._inputTrack.contentHint,this._outputTrack.enabled=this._inputTrack.enabled),this.updatePlayingState(!!e),this.emit("output-media-track-changed",e))}setMediaType(e){this.mediaType=e}updatePlayingState(e){var t,i;if(this.isPlayCalled)if(e){if(this.player.setTrack(this.playerMediaTrack),this.player.isStopped)return this.player.play().catch(e=>this.handleAutoPlayFailed(e)),void this.log.info("playing state updated, play ".concat(this.kind))}else if(!this.player.isStopped){if(HC(this)&&this.isAudio&&null!=(t=this.user)&&t.muteState.hasAudio&&null!=(i=this.user)&&i.muteState.audioMuted)return;return this.player.stop(HC(this)?this.jitterBufferDelay:0),void this.log.info("playing state updated, stop ".concat(this.kind))}this.log.debug("updatePlayingState abort ".concat(this.isPlayCalled," ").concat(e," ").concat(this.player.isStopped))}async handleAutoPlayFailed(e){var t;this.log.warn("handleAutoPlayFailed",e);let i=()=>{this.resume().then(()=>{document.removeEventListener("click",i,!0)})};if(this.room&&this.room.enableAutoPlayDialog){if((_D||bD)&&(await EC(100),null!=(t=this.player)&&t.isPlaying))return;BN||(BN=new FN)}else document.addEventListener("click",i,!0);bO.once(wO.LOCAL_TRACK_CAPTURE_SUCCESS,e=>{let{track:t}=e;"audio"===t.kind&&PN()&&!this.player.isPlaying&&this.isRemote&&this.isAvailable&&i()}),this.emit("error",e)}getVideoFrame(){return this.player instanceof HN?this.player.getVideoFrame():""}emitFirstVideoFrameEvent(e){var t,i,r;if(this.isFirstVideoFrameEmitted)return;let n=null==(t=this.mediaTrack)?void 0:t.getSettings(),a=(null==n?void 0:n.width)||(null==(i=this.player.element)?void 0:i.videoWidth)||0,o=(null==n?void 0:n.height)||(null==(r=this.player.element)?void 0:r.videoHeight)||0;e===lN.RESIZE&&!a&&!o||e===lN.LOADED_META_DATA&&!a&&!o||(e===lN.LOADED_DATA&&!a&&!o&&this._log.warn("the dimension of video is 0x0 in first-video-frame event"),this.isFirstVideoFrameEmitted=!0,SC(this.rotation)&&([a,o]=[o,a]),this.emit("first-video-frame",{width:a,height:o,streamType:this.streamType,userId:this.isRemote?this.userId:""}))}onTrackMuted(){this._log.warn("".concat(this.kind," track is unable to provide media output"))}onTrackUnmuted(){this._log.info("".concat(this.kind," track is able to provide media output"))}onTrackEnded(){this._log.warn("".concat(this.kind," track ended"))}};gA([$L([],iN.INIT,{sync:!0})],SP.prototype,"_toInitState",1);var AP=Object.prototype.hasOwnProperty;var RP=function(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e||"function"==typeof e||Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(xk(e))switch(Object.prototype.toString.call(e)){case"[object File]":case"[object Map]":case"[object Set]":return 0===e.size;case"[object Object]":for(let t in e)if(AP.call(e,t))return!1;return!0}return!1},kP=zC({retryFunction:async function(e){let t=function(e){return{audio:DP(e),video:OP(e)}}(e);SO.info("getUserMedia with constraints: ".concat(JSON.stringify(t)));let i=[],r=[],n=["label","deviceId","groupId"];if(t.audio&&(i=await mP(),SO.info("microphones: ".concat(pC(i.map(e=>uA(dA({},e),{groupId:e.groupId.substring(0,8)})),{keysToInclude:n})))),t.video&&(r=await gP(),SO.info("cameras: ".concat(pC(r,{keysToInclude:n}))),!zk(t.video)&&"user"===t.video.facingMode&&!t.video.deviceId)){let e=r.filter(e=>!e.label.includes("infrared")).find(e=>e.label.includes("facing front"));e&&(t.video.deviceId=e.deviceId,SO.info("exclude infrared camera: ".concat(JSON.stringify(t))))}try{let i=await navigator.mediaDevices.getUserMedia(t);return SL&&i.getTracks().forEach(t=>{var i;let r=t.getCapabilities();SO.info("".concat(t.kind," capabilities: ").concat(pC(r,{keysToInclude:fR}))),!Vk(e.echoCancellation)&&-1===(null==(i=r.echoCancellation)?void 0:i.indexOf(e.echoCancellation))&&SO.warn("Invalid argument for 'echoCancellation'. Expected one of [".concat(JSON.stringify(r.echoCancellation),"], but received '").concat(e.echoCancellation,"'"))}),t.audio&&$N(),i}catch(a){let{message:t}=a;throw"NotFoundError"===a.name&&(e.video&&r&&0===r.length&&(t=LO({key:kO.CAMERA_NOT_FOUND})),e.audio&&i&&0===i.length&&(t=LO({key:kO.MICROPHONE_NOT_FOUND}))),new YR({code:qR.INITIALIZE_FAILED,name:a.name,message:t,constraint:a.constraint})}},settings:{retries:3,timeout:500},onError:e=>{let{error:t,retry:i,reject:r,retryFuncArgs:n,retriedCount:a}=e,o=a+1;"NotReadableError"===t.name||"OverconstrainedError"===t.name||"AbortError"===t.name?(1===o?(n[0].video&&(n[0].maxResolution=!1,(!nO||n[0].width*n[0].height<=2073600)&&n[0].frameRate&&(n[0].frameRate=n[0].frameRate>10?10:5)),n[0].retryWhenExactFailed&&n[0].useExactDeviceId&&(n[0].useExactDeviceId=!1)):2===o?n[0].useDeviceIdOnly=!0:3===o&&!n[0].useExactDeviceId&&(n[0].useTrueAsConstraint=!0),i()):r(t),n[0].microphoneId&&CP(n[0].microphoneId,!1),n[0].cameraId&&CP(n[0].cameraId,!0)},onRetrying:e=>{SO.warn("getUserMedia NotReadableError observed, retrying [".concat(e,"/3]"))},onRetryFailed:e=>{fN.logFailedEvent({eventType:uR,error:e})},onRetrySuccess:e=>{fN.logSuccessEvent({eventType:uR}),fN.uploadEvent({log:"stat-".concat(uR,"-success-").concat(e)})}});async function CP(e,t){let i=(t?await gP():await mP()).find(t=>t.deviceId===e);i&&Bk(i.getCapabilities)&&SO.warn(pC(i.getCapabilities(),{keysToInclude:fR}))}function DP(e){if(!e.audio)return!1;if(e.useTrueAsConstraint)return!0;let t={echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:e.sampleRate};return!RP(e.microphoneId)&&(t.deviceId=e.useExactDeviceId?{exact:e.microphoneId}:e.microphoneId,e.useDeviceIdOnly)?t:(jk(e.channelCount)&&(t.channelCount=e.channelCount),(zk(e.echoCancellation)||"remote-only"===e.echoCancellation||"all"===e.echoCancellation)&&(t.echoCancellation=e.echoCancellation),zk(e.noiseSuppression)&&!e.noiseSuppression&&(t.noiseSuppression=!1),zk(e.autoGainControl)&&!e.autoGainControl&&(t.autoGainControl=!1),!!RP(t)||t)}function OP(e){if(!e.video)return!1;if(e.useTrueAsConstraint)return!0;let{maxResolution:t=!0}=e,i={};return e.cameraId?i.deviceId=e.useExactDeviceId?{exact:e.cameraId}:e.cameraId:e.facingMode&&(i.facingMode=e.facingMode),e.useDeviceIdOnly&&!RP(i)?i:(e.width&&(i.width={ideal:e.width},t&&!nD&&(i.width.max=e.width)),e.height&&(i.height={ideal:e.height},t&&!nD&&(i.height.max=e.height)),nD&&ND&&e.width&&e.height&&e.width*e.height<101376&&(i.width=e.width,i.height=e.height),e.frameRate&&(i.frameRate=e.frameRate),!!RP(i)||i)}var LP=kP,NP=(()=>{let e=!1,t=document.visibilityState;return()=>{document.visibilityState!==t&&SO.info("visibility change: ".concat(document.visibilityState)),!e&&(document.addEventListener("visibilitychange",()=>{SO.info("visibility change: ".concat(document.visibilityState)),t=document.visibilityState}),e=!0)}})(),PP=0,xP=class{constructor(e){vA(this,"log"),vA(this,"isRunning",!1),vA(this,"queue",[]);let t="fq".concat(++PP);e&&(t+="|".concat(e)),this.log=SO.createLogger({id:t})}get length(){return this.queue.length}get lastQueueItem(){return 0===this.length?null:this.queue[this.length-1]}push(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var i,r;let n=dA({},e),a=new Promise((e,t)=>{n.resolve=e,n.reject=t});return n.promise=a,t?this.length<=1?this.queue.push(n):null==(r=null==(i=this.lastQueueItem)?void 0:i.promise)||r.then(n.resolve,n.reject):this.queue.push(n),this.log.debug("push ".concat(this.length),e.funcName,e.args),this.isRunning||this.callNext(),a}shift(){let e=this.queue.shift();return this.log.debug("shift ".concat(this.length),null==e?void 0:e.funcName,null==e?void 0:e.args),e}callNext(){if(this.isRunning||0===this.length)return;let{fn:e,args:t,context:i,resolve:r,reject:n,funcName:a}=this.queue[0];this.log.debug("callNext",this.length,a,t),this.isRunning=!0,e.apply(i,t).then(r,n).finally(()=>{this.isRunning=!1,this.shift(),this.callNext()})}},MP=new WeakMap;function UP(e,t){return AA((i,r)=>function(){let r=e;try{for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];let e=i.apply(this,a),s=eC();return Yk(e)?e.then(e=>(t?FO.addSuccessEvent({key:r,cost:eC()-s}):FO.addSuccessEvent({key:r}),e)).catch(e=>{throw FO.addFailedEvent({key:r,error:e}),e}):(FO.addSuccessEvent({key:r}),e)}catch(DA){throw FO.addFailedEvent({key:r,error:DA}),DA}})}function FP(){}var BP=e=>e();function VP(){this.dispose()}var HP=1,jP=class extends Function{toString(){return"".concat(this.name,"(").concat(this.args.length?[...this.args].join(", "):"",")")}subscribe(e){let t=new ZP(e,this,this.streamId++);return JP.subscribe({id:this.id,end:!1},{nodeId:t.sourceId,streamId:t.id}),this(t),t}},zP=class{constructor(){this.defers=new Set,this.disposed=!1}next(e){}complete(){this.dispose()}error(e){this.dispose()}get bindDispose(){return()=>this.dispose()}dispose(){this.disposed=!0,this.complete=FP,this.error=FP,this.next=FP,this.dispose=FP,this.subscribe=FP,this.doDefer()}subscribe(e){return e instanceof jP?e.subscribe(this):e(this),this}get bindSubscribe(){return e=>this.subscribe(e)}doDefer(){this.defers.forEach(BP),this.defers.clear()}defer(e){this.defers.add(e)}removeDefer(e){this.defers.delete(e)}reset(){this.disposed=!1,delete this.complete,delete this.next,delete this.dispose,delete this.next,delete this.subscribe}resetNext(){delete this.next}resetComplete(){delete this.complete}resetError(){delete this.error}},WP=class extends zP{constructor(e){super(),this.sink=e,e.defer(this.bindDispose)}next(e){this.sink.next(e)}complete(){this.sink.complete()}error(e){this.sink.error(e)}},GP=class extends zP{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:FP,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:FP,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:FP;if(super(),this._next=t,this._error=i,this._complete=r,this.then=FP,e instanceof jP){let n={toString:()=>"subscribe",id:0,source:e};this.defer(()=>{JP.defer(n,0)}),JP.create(n),JP.pipe(n),this.sourceId=n.id,this.subscribe(e),JP.subscribe({id:n.id,end:!0}),t==FP?this._next=e=>JP.next(n,0,e):this.next=e=>{JP.next(n,0,e),t(e)},r==FP?this._complete=()=>JP.complete(n,0):this.complete=()=>{this.dispose(),JP.complete(n,0),r()},i==FP?this._error=e=>JP.complete(n,0,e):this.error=e=>{this.dispose(),JP.complete(n,0,e),i(e)}}else this.subscribe(e)}next(e){this._next(e)}complete(){this.dispose(),this._complete()}error(e){this.dispose(),this._error(e)}};function qP(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return i.reduce((e,t)=>t(e),e)}function KP(e,t,i){if("undefined"!=typeof __FASTRX_DEVTOOLS__){let r=Object.defineProperties(Object.setPrototypeOf(e,jP.prototype),{streamId:{value:0,writable:!0,configurable:!0},name:{value:t,writable:!0,configurable:!0},args:{value:i,writable:!0,configurable:!0},id:{value:0,writable:!0,configurable:!0}});JP.create(r);for(let e=0;e<i.length;e++){let t=i[e];"function"==typeof t&&t instanceof jP&&JP.addSource(r,t)}return r}return e}function YP(e,t){return function(){for(var i=arguments.length,r=new Array(i),n=0;n<i;n++)r[n]=arguments[n];return i=>{if(i instanceof jP){let n=KP(t=>{let a=new e(t,...r);a.sourceId=n.id,a.subscribe(i)},t,arguments);return n.source=i,JP.pipe(n),n}return t=>i(new e(t,...r))}}}function XP(e,t){window.postMessage({source:"fastrx-devtools-backend",payload:{event:e,payload:t}})}var ZP=class extends WP{constructor(e,t,i){super(e),this.source=t,this.id=i,this.sourceId=e.sourceId,this.defer(()=>{JP.defer(this.source,this.id)})}next(e){JP.next(this.source,this.id,e),this.sink.next(e)}complete(){JP.complete(this.source,this.id),this.sink.complete()}error(e){JP.complete(this.source,this.id,e),this.sink.error(e)}},JP={addSource(e,t){XP("addSource",{id:e.id,name:e.toString(),source:{id:t.id,name:t.toString()}})},next(e,t,i){XP("next",{id:e.id,streamId:t,data:i&&i.toString()})},subscribe(e,t){let{id:i,end:r}=e;XP("subscribe",{id:i,end:r,sink:{nodeId:t&&t.nodeId,streamId:t&&t.streamId}})},complete(e,t,i){XP("complete",{id:e.id,streamId:t,err:i?i.toString():null})},defer(e,t){XP("defer",{id:e.id,streamId:t})},pipe(e){XP("pipe",{name:e.toString(),id:e.id,source:{id:e.source.id,name:e.source.toString()}})},update(e){XP("update",{id:e.id,name:e.toString()})},create(e){e.id||(e.id=HP++),XP("create",{name:e.toString(),id:e.id})}},QP=class extends zP{constructor(e){super(),this.source=e,this.sinks=new Set}add(e){e.defer(()=>this.remove(e)),1===this.sinks.add(e).size&&(this.reset(),this.subscribe(this.source))}remove(e){this.sinks.delete(e),0===this.sinks.size&&this.dispose()}next(e){this.sinks.forEach(t=>t.next(e))}complete(){this.sinks.forEach(e=>e.complete()),this.sinks.clear()}error(e){this.sinks.forEach(t=>t.error(e)),this.sinks.clear()}};function $P(){return e=>{let t=new QP(e);if(e instanceof jP){let i=KP(e=>{t.add(e)},"share",arguments);return t.sourceId=i.id,i.source=e,JP.pipe(i),i}return KP(t.add.bind(t),"share",arguments)}}function ex(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return KP(e=>{let i=new WP(e),r=t.length;i.complete=()=>{0===--r&&e.complete()},t.forEach(i.bindSubscribe)},"merge",arguments)}function tx(e){let t=arguments,i=$P()(KP(t=>{i.next=e=>t.next(e),i.complete=()=>t.complete(),i.error=e=>t.error(e),e&&t.subscribe(e)},"subject",t));return i.next=FP,i.complete=FP,i.error=FP,i}function ix(e,t){return i=>{let r=e=>i.next(e);i.defer(()=>t(r)),e(r)}}function rx(e,t){if("on"in e&&"off"in e)return KP(ix(i=>e.on(t,i),i=>e.off(t,i)),"fromEvent",arguments);if("addListener"in e&&"removeListener"in e)return KP(ix(i=>e.addListener(t,i),i=>e.removeListener(t,i)),"fromEvent",arguments);if("addEventListener"in e)return KP(ix(i=>e.addEventListener(t,i),i=>e.removeEventListener(t,i)),"fromEvent",arguments);throw"target is not a EventDispachter"}var nx=YP(class extends WP{constructor(e,t,i){super(e),this.filter=t,this.thisArg=i}next(e){this.filter.call(this.thisArg,e)&&this.sink.next(e)}},"filter"),ax=YP(class extends WP{constructor(e,t){super(e),this.count=t}next(e){this.sink.next(e),0===--this.count&&(this.doDefer(),this.complete())}},"take"),ox=YP(class extends WP{constructor(e,t){super(e);let i=new WP(e);i.next=()=>{i.doDefer(),e.complete()},i.complete=VP,i.subscribe(t)}},"takeUntil"),sx=YP(class extends WP{constructor(e,t){super(e),this.f=t}next(e){this.f(e)||(this.next=super.next,this.next(e))}},"skipWhile"),cx=YP(class extends WP{constructor(e,t,i){super(e),this.mapper=t,this.thisArg=i}next(e){super.next(this.mapper.call(this.thisArg,e))}},"map"),lx=class extends WP{constructor(e,t,i){super(e),this.data=t,this.context=i}next(e){let t=this.context.combineResults;t?this.sink.next(t(this.data,e)):this.sink.next(e)}tryComplete(){this.context.resetComplete(),this.dispose()}},dx=class e extends WP{constructor(e,t,i){super(e),this.makeSource=t,this.combineResults=i,this.index=0}subInner(t,i){let r=this.currentSink=new i(this.sink,t,this);this.complete===e.prototype.complete&&(this.complete=this.tryComplete),r.complete=r.tryComplete,r.subscribe(this.makeSource(t,this.index++))}complete(){this.sink.complete()}tryComplete(){this.currentSink.resetComplete(),this.dispose()}},ux=class extends lx{},hx=class extends dx{next(e){this.subInner(e,ux),this.next=e=>{this.currentSink.dispose(),this.subInner(e,ux)}}},px=YP(hx,"switchMap");var fx,mx=function(e){return(t,i)=>e(()=>t,i)}(YP(hx,"switchMapTo")),gx=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:FP,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:FP,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:FP;return r=>new GP(r,e,t,i)},vx=YP(class extends WP{constructor(e,t){super(e),t instanceof Function?this.next=i=>{t(i),e.next(i)}:(t.next&&(this.next=i=>{t.next(i),e.next(i)}),t.complete&&(this.complete=()=>{t.complete(),e.complete()}),t.error&&(this.error=i=>{t.error(i),e.error(i)}))}},"tap"),_x=((fx=_x||{})[fx.AUTO_SWITCH_NEW_DEVICE=0]="AUTO_SWITCH_NEW_DEVICE",fx[fx.WAIT_CURRENT_DEVICE=1]="WAIT_CURRENT_DEVICE",fx),yx=class extends SP{constructor(e,t){super({mediaType:e,PlayerClass:t}),vA(this,"isRemote",!1),vA(this,"deviceId"),vA(this,"groupId",""),vA(this,"label",""),vA(this,"sourceTrack"),vA(this,"enableAutoSwitchWhenRecapturing",!0),vA(this,"_isRecapturing",!1),vA(this,"_lastRecaptureTime",0),vA(this,"_onMuteTimeoutId",-1),vA(this,"_encodeCheckTimeoutId",-1),vA(this,"recaptureMode",0),vA(this,"profile"),vA(this,"retryEncodeFailed")}get enableEncodeFrame(){return!1}get isPublishing(){return"publishing"===this.state.toString()}get isPublished(){return"publish"===this.state}get isUseCustomSource(){return!(!this.mediaTrack||this.sourceTrack===this.mediaTrack)}encodeFrame(e,t){throw new Error("Method not implemented.")}installTrackEvent(e){e.addEventListener(YA,this.onTrackMuted),e.addEventListener(XA,this.onTrackUnmuted),e.addEventListener(ZA,this.onTrackEnded),e.muted&&this.onTrackMuted(),e.readyState===ZA&&this.onTrackEnded()}uninstallTrackEvent(e){e.removeEventListener(YA,this.onTrackMuted),e.removeEventListener(XA,this.onTrackUnmuted),e.removeEventListener(ZA,this.onTrackEnded)}setStateToReady(){}async capture(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var i;let r=this.sourceTrack;try{let r,n=eC();bO.emit(wO.LOCAL_TRACK_CAPTURE_START,{track:this}),e.customSource?(r=new MediaStream,r.addTrack(e.customSource)):(t||null==(i=this.sourceTrack)||i.stop(),r=await LP(e));let a=r.getTracks()[0];return await this.setInputMediaStreamTrack(a),e.customSource||(this.sourceTrack=a,this.updateDeviceIdInUse(),this.listenDeviceChange()),bO.emit(wO.LOCAL_TRACK_CAPTURE_SUCCESS,{track:this,cost:eC()-n}),r}catch(DA){throw bO.emit(wO.LOCAL_TRACK_CAPTURE_FAILED,{track:this,error:DA}),this.log.error("getUserMedia error observed ".concat(DA)),DA}finally{t&&(null==r||r.stop())}}setOutputMediaStreamTrack(e){var t;if(super.setOutputMediaStreamTrack(e),this.setStateToReady(),this.isPublishing||this.isPublished)return null==(t=this.room)?void 0:t.replaceTrack(this)}get hasFlag(){var e,t;let i=aC((null==(e=this.room)?void 0:e.localPublishFlag)||0,(null==(t=this.room)?void 0:t.userId)||"");return 4===this.mediaType&&i.hasVideo||1===this.mediaType&&i.hasAudio||2===this.mediaType&&i.hasAuxiliary}async publish(e,t){return this.room=e,this.room.localTracks.add(this),this.emit("4",{mediaType:this.strMediaType,state:"starting",prevState:"stopped"}),this.userId=e.userId,this._log.bindParent(e.getLogger()),await t,this._checkPublishFlag(e)}_checkPublishFlag(e){return new Promise(async(t,i)=>{var r,n,a,o,s;let c=()=>i(new YR({code:qR.API_CALL_ABORTED,message:"publish aborted"}));if(this.hasFlag||this.muted?t():((this.state===iN.INIT||"ready"===this.state)&&c(),qP(rx(e,"local-publish-flag-changed"),nx(()=>this.hasFlag),ox(ex(rx(this,iN.INIT),rx(this,"ready"))),gx(t,i,c))),null!=(a=null==(n=null==(r=this.room)?void 0:r.networkQuality)?void 0:n.hadRecentBadUplink)&&a.call(n,2))return t();let l=e.heartbeatCount,d=(null==(s=null==(o=this.mediaTrack)?void 0:o.stats)?void 0:s.totalFrames)||0;this._encodeCheckTimeoutId=setTimeout(async()=>{var r,n,a,o,s,c,u,h;if(null!=(a=null==(n=null==(r=this.room)?void 0:r.networkQuality)?void 0:n.hadRecentBadUplink)&&a.call(n,2)||e.heartbeatCount-l<3)return t();if((this.isPublished||this.isPublishing)&&this.isMediaTrackActive){if(null!=(o=this.mediaTrack)&&o.stats){let e=this.mediaTrack.stats.totalFrames||0;e-d===0&&this.log.warn("capture totalFrames is 0 during encode check, totalFrames",e)}let e=this.kind===WA,r=this.stat.bytesSent>0;if(FO[r?"addSuccessEvent":"addFailedEvent"]({key:e?503700:513702}),!e){let e={H264:513704,H265:513705,VP8:513706}[(null==(c=null==(s=this.room)?void 0:s.videoCodec)?void 0:c.toUpperCase())||"H264"];e&&FO[r?"addSuccessEvent":"addFailedEvent"]({key:e})}if(!r){if(FO.addEnum({key:e?503701:513703,value:yO()}),fN.uploadEvent({log:"stat-encode-failed-".concat(this.kind,"-").concat(gO()||EO()),userId:this.userId}),this.log.warn(e?"encode failed":"".concat(null==(h=null==(u=this.room)?void 0:u.videoCodec)?void 0:h.toUpperCase()," encode failed")),this.retryEncodeFailed&&(this.log.warn("retry encode"),await this.retryEncodeFailed(this),this.stat.bytesSent>0||this.hasFlag||(await EC(5e3),this.stat.bytesSent>0||this.hasFlag)))return t();this.emit("6",this),i(new YR({message:"".concat(this.strMediaType," encode failed"),code:e?qR.AUDIO_ENCODE_FAILED:qR.VIDEO_ENCODE_FAILED}))}}},1e4)})}unpublish(){this.room&&this.room.localTracks.delete(this),this.log.info("unpublish"),bO.emit(wO.LOCAL_TRACK_UNPUBLISHED,{track:this})}async updateDeviceIdInUse(){if(this.sourceTrack&&TL){let{deviceId:e,groupId:t}=this.sourceTrack.getSettings(),{label:i}=this.sourceTrack;await EP({newDeviceId:e,oldDeviceId:this.deviceId,oldGroupId:this.groupId,oldLabel:this.label,kind:this.kind})||(this.deviceId=e,this.label=i,t&&(this.groupId=t),fP().then(i=>{let r=i.find(i=>{let r=i.deviceId===e;return t&&(r=r&&i.groupId===t),r});r&&this.emit("2",r)}))}}setProfile(e){this.log.info("setProfile",e),Object.assign(this.profile,e)}isNeedToRecapture(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!(!this.deviceId||!this.sourceTrack||this.kind===WA&&!function(e){if(e instanceof CanvasCaptureMediaStreamTrack||!(e instanceof MediaStreamTrack))return!1;let t=e.label.toLocaleLowerCase();if(t.includes("mic")||t.includes("麦克风"))return!0;let i="".concat(((null==e?void 0:e.getSettings())||{}).deviceId,"_").concat(rR);return!!yP.has(i)}(this.sourceTrack)||this.kind===GA&&!function(e){if(e instanceof CanvasCaptureMediaStreamTrack||!(e instanceof MediaStreamTrack))return!1;let t=e.label.toLocaleLowerCase();if(t.includes("camera")||t.includes("webcam"))return!0;let i="".concat(((null==e?void 0:e.getSettings())||{}).deviceId,"_").concat(nR);return!!yP.has(i)}(this.sourceTrack)||this._isRecapturing||e&&ND&&nO)}onTrackMuted(){if(super.onTrackMuted(),NP(),this.isNeedToRecapture(!0)){if(Date.now()-this._lastRecaptureTime<pR)return void setTimeout(()=>this.onTrackMuted(),pR);this._onMuteTimeoutId=setTimeout(async()=>{var e;if(null!=(e=this.sourceTrack)&&e.muted){if((eD||iD)&&"visible"!==document.visibilityState)return;this.recapture(await this.getRecoverCaptureDeviceId())}},5e3)}}onTrackUnmuted(){super.onTrackUnmuted(),this._onMuteTimeoutId>0&&clearTimeout(this._onMuteTimeoutId)}async onTrackEnded(){if(super.onTrackEnded(),this.isNeedToRecapture()&&0===this.recaptureMode){if(Date.now()-this._lastRecaptureTime<pR)return void setTimeout(()=>this.onTrackEnded(),pR);this.emit("7"),this.recapture(await this.getRecoverCaptureDeviceId())}}async recapture(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var i;if(this._isRecapturing||!this.sourceTrack)return;this.log.warn("recapture trying");let r=this.sourceTrack;t||null==(i=this.sourceTrack)||i.stop(),this._isRecapturing=!0,this._lastRecaptureTime=Date.now();let n={useExactDeviceId:!0};if("user"===e||"environment"===e)n.facingMode=e;else{let t;("audio"===this.kind?await mP():await gP()).find(t=>t.deviceId===e)&&(t=e),n.deviceId=t}return this.capture(n,t).then(()=>{this._isRecapturing=!1,this.log.warn("recapture success"),this.emit("1",{deviceId:this.deviceId}),bO.emit(wO.LOCAL_TRACK_RECAPTURE,{track:this})}).catch(e=>{this._isRecapturing=!1,this.log.warn("recapture failed ".concat(e.message)),this.emit("5",e),bO.emit(wO.LOCAL_TRACK_RECAPTURE,{track:this,error:e})}).finally(()=>{t&&(null==r||r.stop())})}async getRecoverCaptureDeviceId(){let e=this instanceof Ix;if(e&&this.facingMode)return this.facingMode;let{deviceId:t}=this;if(t){let i=(Ex.get(t)||0)+1;if(Ex.set(t,i),i>=3&&this.enableAutoSwitchWhenRecapturing){let r=e?(await gP()).find(e=>!Ex.has(e.deviceId)):(await mP()).find(e=>!Ex.has(e.deviceId));r&&(this.log.warn("".concat(t," capture fail ").concat(i," times, change new ").concat(r.deviceId)),t=r.deviceId)}}return t}stopCapture(){var e;this.sourceTrack&&(this.sourceTrack.stop(),this.uninstallTrackEvent(this.sourceTrack)),this._inputTrack&&this.uninstallTrackEvent(this._inputTrack),null==(e=this.manager)||e.removeInput(this),this._onMuteTimeoutId&&clearTimeout(this._onMuteTimeoutId)}close(){super.close(),this.stopCapture()}};gA([$L(iN.INIT,"ready",{ignoreError:!0,sync:!0})],yx.prototype,"setStateToReady",1),gA([function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,i,r){let n=r.value;return r.value=function(){let t=MP.get(this)||new xP;for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return MP.set(this,t),t.push({fn:n,args:a,context:this,funcName:i},e)},r}}()],yx.prototype,"capture",1),gA([$L("ready","publish",{ignoreError:!0,success(){bO.emit(wO.LOCAL_TRACK_PUBLISHED,{track:this,room:this.room}),this.emit("4",{mediaType:this.strMediaType,state:"started",prevState:"starting"}),this.log.info("published")},fail(e){var t;null==(t=this.room)||t.localTracks.delete(this);let i="error",r=e instanceof YR?e:e.cause instanceof YR?e.cause:e,n=!1;r instanceof YR&&(r.message.includes("timeout")?i="timeout":r.code===qR.API_CALL_ABORTED&&(n=!0,i="api-call")),this.emit("4",{mediaType:this.strMediaType,state:"stopped",prevState:"starting",reason:i,error:r}),this.log[n?"info":"error"]("publish failed",r)}}),UP(521714,!1)],yx.prototype,"publish",1),gA([AA(e=>async function(){let t="publish"===this.state?"started":"starting";e.call(this),this.emit("4",{mediaType:this.strMediaType,state:"stopped",prevState:t,reason:"api-call"}),clearTimeout(this._encodeCheckTimeoutId)}),$L([],"ready",{sync:!0})],yx.prototype,"unpublish",1);var Ex=new Map;bO.on(wO.SWITCH_DEVICE_SUCCESS,e=>{e.track.deviceId&&Ex.delete(e.track.deviceId)});var bx=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.dataView=e,this.isSEI&&(t?this.addPreventionByte():this.removePreventionByte())}addPreventionByte(){let{seiPayloadStartIndex:e}=this,t=this.dataView.byteLength-2,i=[],r=0;for(let a=e;a<=t;a++){let e=this.dataView.getInt8(a);switch(e){case 0:case 1:case 2:case 3:2===r&&(i.push(3),r=0),0===e?r+=1:r=0,i.push(e);break;default:r=0,i.push(e)}}i.push(this.dataView.getInt8(this.dataView.byteLength-1));let n=new DataView(new Uint8Array([...new Uint8Array(this.dataView.buffer).slice(0,e),...i]).buffer);this.dataView=n}removePreventionByte(){let{seiPayloadStartIndex:e}=this,t=this.dataView.byteLength-1,i=[],r=0;for(let a=e;a<=t;a++)switch(this.dataView.getInt8(a)){case 0:r++,i.push(this.dataView.getInt8(a));break;case 3:2!==r&&i.push(this.dataView.getInt8(a)),r=0;break;default:i.push(this.dataView.getInt8(a)),r=0}let n=new DataView(new Uint8Array([...new Uint8Array(this.dataView.buffer).slice(0,e),...i]).buffer);this.dataView=n}get seiPayloadStartIndex(){let e=6;for(let t=6;t<this.dataView.buffer.byteLength&&(e+=1,255===this.dataView.getUint8(t));t+=1);return e}get seiPayloadType(){return this.isSEI?this.dataView.getUint8(5):null}get seiPayload(){if(!this.isSEI)return null;let e=0,t=6;for(let a=6;a<this.dataView.buffer.byteLength;a+=1){let i=this.dataView.getUint8(a);if(t+=1,255!==i){e+=i;break}e+=255}let i=new ArrayBuffer(e),r=new DataView(i),n=t;for(let a=0;a<i.byteLength;a+=1)r.setInt8(a,this.dataView.getInt8(n+a));return r}get naluType(){let e=this.getStartCodeLength();return e>=this.dataView.byteLength?0:31&this.dataView.getUint8(e)}getStartCodeLength(){return this.dataView.byteLength>=4&&0===this.dataView.getUint8(0)&&0===this.dataView.getUint8(1)&&0===this.dataView.getUint8(2)&&1===this.dataView.getUint8(3)?4:this.dataView.byteLength>=3&&0===this.dataView.getUint8(0)&&0===this.dataView.getUint8(1)&&1===this.dataView.getUint8(2)?3:0}get isIDR(){return 5===this.naluType}get isSPS(){return 7===this.naluType}get isPPS(){return 8===this.naluType}get isSEI(){return 6===this.naluType}},wx=class{constructor(){vA(this,"_seiMessageList",[]),vA(this,"_smallSeiMessageList",[]),vA(this,"_seiPayloadType",243)}encodeSEINalu(e){let t=e.byteLength,i=parseInt(String(t/255),10),r=t%255,n=[];n.push(0,0,0,1,6,this._seiPayloadType);for(let o=0;o<i;o++)n.push(255);n.push(r);let a=new DataView(e);return n.push(...new Uint8Array(a.buffer)),n.push(128),new bx(new DataView(new Uint8Array(n).buffer),!0)}sendSEI(e,t){null!=t&&t.seiPayloadType&&(this._seiPayloadType=t.seiPayloadType),this._seiMessageList.push(e),null!=t&&t.small&&this._smallSeiMessageList.push(e)}isEmpty(){return!this._seiMessageList.length}getNaluCount(e){let t=0,i=0,r=new DataView(e);for(let n=0;n<e.byteLength;n++)switch(r.getUint8(n)){case 0:t++;break;case 1:(2===t||3===t)&&i++,t=0;break;default:t=0}return i}encode(e,t){let i=t?this._smallSeiMessageList:this._seiMessageList;if(i.length>0&&e.data.byteLength>0){let t=9-this.getNaluCount(e.data);if(t<=0)return 0;let r=i.splice(0,t).reverse().map(this.encodeSEINalu.bind(this)),n=r.reduce((e,t)=>e+t.dataView.byteLength,0),a=new ArrayBuffer(n+e.data.byteLength),o=new DataView(a),s=new DataView(e.data),c=0;for(let e=0;e<r.length;e++)for(let t=0;t<r[e].dataView.byteLength;t++)o.setInt8(c++,r[e].dataView.getInt8(t));for(let i=0;i<e.data.byteLength;i++)o.setInt8(c++,s.getInt8(i));return e.data=a,r.length}return 0}},Ix=class extends yx{constructor(e){super(arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,HN),vA(this,"profile",dA({},jA)),vA(this,"avoidCropping",!1),vA(this,"_scaleResolutionDownBy"),vA(this,"stat",{bytesSent:0,packetsSent:0,framesEncoded:0,framesSent:0,frameWidth:0,frameHeight:0,fpsCapture:0,framesCaptured:0}),vA(this,"small"),vA(this,"isNeedToSetBandwidth"),vA(this,"muteImage"),vA(this,"manager"),vA(this,"_seiCodec",new wx),this.manager=e;let t=()=>{var e;if(this.isAllowed2k4k(this.profile))this.room&&this.settings.height>=1440&&"publish"===this.state&&this.room.sendAbilityStatus({"2k4k":1});else{let t=yk((null==(e=this.room)?void 0:e.sdkAppId)||0)?UA:MA;this.log.warn("Resolution is reset to 1080p, need to upgrade ability here ".concat(t)),this.setProfile(uA(dA({},this.profile),{width:1920,height:1080})),this.applyProfile()}};this.on("input-media-track-changed",t),this.on("publish",t),this.handleCameraAdded=this.handleCameraAdded.bind(this),this.handleCameraRemoved=this.handleCameraRemoved.bind(this)}get facingMode(){if(TL&&this.mediaTrack)return this.mediaTrack.getSettings().facingMode}get contentHint(){var e;return(null==(e=this._inputTrack)?void 0:e.contentHint)||""}get isQosClearFirst(){var e;return"detail"===(null==(e=this._inputTrack)?void 0:e.contentHint)}get hasSmall(){var e;return!(null==(e=this.manager)||!e.hasSmall)}async setMute(e){var t,i,r;if(Hk(e)){if(this.muteImage===e)return;await(null==(t=this.manager)?void 0:t.deleteWatermark("mute")),await(null==(i=this.manager)?void 0:i.setWatermark({x:0,y:0,width:this.settings.width,height:this.settings.height,type:"mute",zIndex:999,imageUrl:e,fillVideo:!0})),this.muteImage=e,super.setMute(!1)}else this.muteImage&&(await(null==(r=this.manager)?void 0:r.deleteWatermark("mute")),this.muteImage=void 0),super.setMute(e)}async capture(e){let{deviceId:t,facingMode:i,useExactDeviceId:r=!0,customSource:n,retryWhenExactFailed:a=!0}=e,o={audio:!1,video:!0,facingMode:i||this.facingMode,cameraId:t,width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate,useExactDeviceId:r,retryWhenExactFailed:a,customSource:n};if("environment"===o.facingMode){let e=await this.getDeviceIdWhenUsingBackCamera();e&&(o.cameraId=e)}return super.capture(o)}setProfile(e){var t;let i=this.fallbackProfile(e);if(i.bitrate&&(this.isNeedToSetBandwidth=i.bitrate!==this.profile.bitrate),this.isAllowed2k4k(this.profile))super.setProfile(i);else{let e=yk((null==(t=this.room)?void 0:t.sdkAppId)||0)?UA:MA;this.log.warn("Resolution is reset to 1080p, need to upgrade ability here ".concat(e)),super.setProfile(uA(dA({},this.profile),{width:1920,height:1080}))}}async applyProfile(){var e;if(!this.mediaTrack)return;let{width:t=0,height:i=0}=(this.sourceTrack||this.mediaTrack).getSettings(),r=t*i,n=this.settings,a=n.height!==this.profile.height||n.width!==this.profile.width||n.frameRate!==this.profile.frameRate;if(a&&(16===lO&&this.deviceId?await this.recapture(this.deviceId):(await(null==(e=this.sourceTrack||this.mediaTrack)?void 0:e.applyConstraints({width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate})),this.manager&&this.manager.changeInput(this)),this.room&&this.settings.height>=1440&&"publish"===this.state&&this.room.sendAbilityStatus({"2k4k":1})),this.isNeedToSetBandwidth&&this.room&&this.room.setBandWidth){this.isNeedToSetBandwidth=!1;let{width:e=0,height:t=0}=(this.sourceTrack||this.mediaTrack).getSettings(),i=e*t;return a&&i&&r&&i===r?void this.log.warn("set bandwidth failed: resolution is not changed"):this.room.setBandWidth({bandwidth:this.profile.bitrate,type:GA,videoType:KA})}}get settings(){let e={width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate},t=this.sourceTrack||this.mediaTrack;return TL&&t&&Object.assign(e,t.getSettings()),e}get scaleResolutionDownBy(){return this._scaleResolutionDownBy?this._scaleResolutionDownBy:TC(this.settings,this.profile)}isAllowed2k4k(e){var t;return!(this.room&&this.room.scheduleResult&&!this.isScreen&&!(e.height*e.width<3686400))||1===(null==(t=this.room.scheduleResult.trtcAutoConf)?void 0:t["2k4k"])}isNeedToSwitchDevice(e){return!(!this.mediaTrack||this.deviceId===e||this.facingMode===e)}async switchDevice(e){try{if(!this.isNeedToSwitchDevice(e)&&!this.isUseCustomSource)return;let t={useExactDeviceId:!0,retryWhenExactFailed:!1};"user"===e||"environment"===e?t.facingMode=e:t.deviceId=e,this.sourceTrack&&this.sourceTrack.stop(),await this.capture(t),bO.emit(wO.SWITCH_DEVICE_SUCCESS,{track:this}),this.log.info("switch camera success")}catch(CA){throw this.log.error("switch camera failed ".concat(CA)),this.deviceId&&this.recapture(this.deviceId),CA}}async getDeviceIdWhenUsingBackCamera(){let e;try{if(VD&&!XD&&AL){let t=(await gP(!0)).map(e=>{var t;return uA(dA({},e),{capabilities:null==(t=e.getCapabilities)?void 0:t.call(e)})}).filter(e=>{var t,i;return null==(i=null==(t=e.capabilities)?void 0:t.facingMode)?void 0:i.includes("environment")}),i=t[0];t.forEach(e=>{var t,r,n,a;let{capabilities:o}=e;(null!=(t=o.width)&&t.max&&null!=(r=o.height)&&r.max?o.width.max*o.height.max:0)>(null!=(n=i.capabilities.width)&&n.max&&null!=(a=i.capabilities.height)&&a.max?i.capabilities.width.max*i.capabilities.height.max:0)&&(i=e)}),null!=i&&i.capabilities&&(this._log.info("use max resolution back camera",i),e=i.deviceId)}}catch(CA){this._log.warn("get max res camera failed",CA)}return e}async updateSmallConfig(e){var t,i;this._log.info("update small stream config: ".concat(JSON.stringify(e)));let r=!this.small;this.small=this.fallbackProfile(e,!0),await(null==(t=this.manager)?void 0:t.update()),r&&await(null==(i=this.room)?void 0:i.enableSmall(!0)),this.log.info("update small stream config success")}fallbackProfile(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.width>e.height,r=dA({},e);return e.width*e.height<=19200&&iD&&QD&&(this.log.warn("".concat(t?"small ":"","resolution is ").concat(e.width,"*").concat(e.height,", fallback to 240*180 for android chrome")),r.width=i?240:180,r.height=i?180:240,r.bitrate=Math.max(e.bitrate,150)),e.width*e.height>921600&&uO&&(r.width=i?1280:720,r.height=i?720:1280,this.log.warn("reset to 1280 * 720 on iOS 13~14")),function(e,t){let i=e.split(".").map(e=>Number(e)),r=t.split(".").map(e=>Number(e));for(let n=0;n<Math.max(i.length,r.length);n++){let e=i[n]||0,t=r[n]||0;if(e<t)return!0;if(e>t)return!1}return!1}(sO,"14.3")&&cO(sO,"14.0",!0)&&this.on("7",()=>{let e=this.profile.width>this.profile.height;this.profile.width*this.profile.height>307200?(this.profile.width=e?640:480,this.profile.height=e?480:640,this.log.warn("reduce the resolution to 480p on iOS 14.0 ~ 14.2")):this.profile.width*this.profile.height>230400&&(this.profile.width=e?640:360,this.profile.height=e?360:640,this.log.warn("reduce the resolution to 360p on iOS 14.0 ~ 14.2"))}),!t&&this.avoidCropping&&(QD||nD)&&!(iD||eD||QC||ZC||XD)&&e.width*e.height<=230400&&e.width/e.height===16/9&&(this._scaleResolutionDownBy=1280/e.width,r.width=1280,r.height=720,this.log.warn("capture 720p, scale: ".concat(this._scaleResolutionDownBy))),r}stopSmall(){var e,t;this.small&&(delete this.small,null==(e=this.manager)||e.update(),null==(t=this.room)||t.enableSmall(!1))}listenDeviceChange(){hP&&!hP.listeners("videoInputRemoved").includes(this.handleCameraRemoved)&&hP.on("videoInputRemoved",this.handleCameraRemoved,this)}async handleCameraRemoved(e){if(e.deviceId===this.deviceId){let t=1===this.recaptureMode;if(this.log.warn("RecaptureMode: ".concat(_x[this.recaptureMode],". Current camera is lost: ").concat(JSON.stringify(e))),0===this.recaptureMode){Kx(this.userId,{eventId:2003,param1:7,streamType:2});let e=await gP();e[0]?this.recapture(e[0].deviceId):t=!0}t&&hP.on("videoInputAdded",this.handleCameraAdded,this)}}async handleCameraAdded(e){1===this.recaptureMode&&e.deviceId!==this.deviceId||(hP.off("videoInputAdded",this.handleCameraAdded,this),this.log.warn("camera added: ".concat(JSON.stringify(e))),this.recapture(e.deviceId))}encodeFrame(e,t){if(!this.manager)return e;let i=t?8:this.mediaType;return this.manager.encodePipeline.reduceRight((e,t)=>t?t({frame:e,mediaType:i}):e,e)}get enableEncodeFrame(){return!!this.manager&&this.manager.encodePipeline.some(e=>e)}play(e,t){return Vk(this.mirror)&&!this.isScreen&&this.setMirror("view"),super.play(e,t)}close(){hP.off("videoInputAdded",this.handleCameraAdded,this),hP.off("videoInputRemoved",this.handleCameraRemoved,this),super.close()}async recapture(e){try{await super.recapture(e)}catch(CA){let i=(await gP()).find(t=>t.deviceId!==e);if(!i)throw CA;await super.recapture(i.deviceId)}}setContentHint(e){this.mediaTrack&&"contentHint"in this.mediaTrack&&(this.mediaTrack.contentHint!==e&&(this.log.info("setContentHint ".concat(e)),this.mediaTrack.contentHint=e),this.outMediaTrack&&this.outMediaTrack.contentHint!==e&&(this.outMediaTrack.contentHint=e))}setRotation(e){this.manager&&(this.isScreen||Vk(e)||e!==this.rotation&&(this.rotation=e,this.manager.rotation=e))}};gA([SA(function(e){this.setContentHint(e.contentHint||"motion")})],Ix.prototype,"capture",1);var Tx=[-1,-1,1,-1,-1,1,1,1],Sx=[0,0,1,0,0,1,1,1],Ax=class e extends iN{constructor(e,t){if(super(),this.context=e,vA(this,"name"),vA(this,"input"),vA(this,"output"),vA(this,"texture"),vA(this,"ctx2d",null),vA(this,"fbo"),vA(this,"width",0),vA(this,"height",0),vA(this,"x",0),vA(this,"y",0),vA(this,"program"),vA(this,"vertexShader"),vA(this,"fragmentShader"),vA(this,"totalFrames",0),vA(this,"dropFrames",0),vA(this,"matchInputSize",!0),vA(this,"texCoordBuffer"),vA(this,"positionBuffer"),vA(this,"lastInfo",{name:"",timestamp:0,totalFrames:0,x:0,y:0,width:0,height:0,fps:0}),vA(this,"cost",0),vA(this,"_canvas",null),vA(this,"_image"),vA(this,"log"),this.context.on("disconnect",this.close,this),this.name=t.name,this.log=t.logger,this.matchInputSize=!1!==t.matchInputSize,this.width=t.width||e.width,this.height=t.height||e.height,this._image=t.image,e instanceof Bx)e.ctx&&t.create2d&&("function"==typeof OffscreenCanvas&&16!==lO?this._canvas=new OffscreenCanvas(this.width,this.height):(this._canvas=document.createElement("canvas"),this._canvas.width=this.width,this._canvas.height=this.height),this.ctx2d=this._canvas.getContext("2d"),this._image=this._canvas);else try{let i=e.ctx;this.texCoordBuffer=this.createBuffer(Sx),this.positionBuffer=this.createBuffer(Tx),!1!==t.createTexture&&(this.texture=i.createTexture(),this.useTexture(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.pixelStorei(i.UNPACK_ALIGNMENT,1)),t.useFbo&&(this.fbo=i.createFramebuffer(),this.useBufferFrame(),this.useTexture(),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,null),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.texture,0)),t.useDefaultProgram?this.program=e.defaultProgam:(t.vertexShaderSource||t.fragmentShaderSource)&&(this.vertexShader=t.vertexShaderSource?e.createShader(i.VERTEX_SHADER,t.vertexShaderSource):e.defaultVShader,this.fragmentShader=t.fragmentShaderSource?e.createShader(i.FRAGMENT_SHADER,t.fragmentShaderSource):e.defaultFShader,this.program=e.createProgram(this.vertexShader,this.fragmentShader))}catch(i){this.context.destroy(new YR({code:qR.VIDEO_MANAGER_ERROR,extraCode:3,message:"create video node ".concat(this.name," error ").concat(i.message||i)}))}}get image(){return this._image}set image(e){this._image=e}createFramebuffer(e){let t=this.context.ctx,i=t.createFramebuffer();return t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),i}connect(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return e.addInput(this,...i),this.output=e,e}addInput(e){this.input=e,this.matchInputSize&&e.width&&e.height&&this.resize(e.width,e.height)}requestFrame(e){let t=Date.now();return!!(this.context instanceof Fx&&this.render(e)||this.context instanceof Bx&&this.render2d(e))&&(this.totalFrames++,this.cost=Date.now()-t,!0)}render2d(e){var t;return!(null==(t=this.input)||!t.requestFrame(e))&&this.draw2d(this.input.image,0,0,this.width,this.height)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;var t;null==(t=this.output)||t.update(e)}disconnect(){for(var e,t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];null==(e=this.output)||e.removeInput(this,...i),delete this.output}removeInput(e){delete this.input}close(){var e,t;if(this.context.off("disconnect",this.close,this),null==(e=this.output)||e.removeInput(this),delete this.output,null==(t=this.input)||t.disconnect(),this.context instanceof Fx){let e=this.context.ctx;e.deleteBuffer(this.texCoordBuffer),e.deleteBuffer(this.positionBuffer),this.fbo&&e.deleteFramebuffer(this.fbo),this.texture&&e.deleteTexture(this.texture),this.vertexShader&&this.vertexShader!==this.context.defaultVShader&&e.deleteShader(this.vertexShader),this.fragmentShader&&this.fragmentShader!==this.context.defaultFShader&&e.deleteShader(this.fragmentShader),this.program&&this.program!==this.context.defaultProgam&&e.deleteProgram(this.program)}this._canvas&&(this._canvas.width=0,this._canvas.height=0,this.ctx2d=null),this.removeAllListeners()}useTexture(){this.useTextures(this.texture)}useInputTexture(){var e;this.useTextures(null==(e=this.input)?void 0:e.texture)}useTextures(){let e=this.context.ctx;for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];i.forEach((t,i)=>{t&&(e.activeTexture(e.TEXTURE0+i),e.bindTexture(e.TEXTURE_2D,t))})}useProgram(){this.context.ctx.useProgram(this.program)}useBufferFrame(){let e=this.context.ctx;e.bindFramebuffer(e.FRAMEBUFFER,this.fbo||null)}createBuffer(e){let t=this.context.ctx,i=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW),i}setTexBuffer(e){let t=this.context.ctx;t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW)}setPosBuffer(e){let t=this.context.ctx;t.bindBuffer(t.ARRAY_BUFFER,this.positionBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(e),t.STATIC_DRAW)}changeBufferData(e,t){let i=this.context.ctx;i.bindBuffer(i.ARRAY_BUFFER,e),i.bufferData(i.ARRAY_BUFFER,new Float32Array(t),i.STATIC_DRAW)}setAttributes(){let e=this.context.ctx;for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];i.forEach((t,i)=>{e.enableVertexAttribArray(i),e.bindBuffer(e.ARRAY_BUFFER,t),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0)})}getVertexPoint(e,t){return[e/this.width*2-1,t/this.height*2-1]}layout2texCoords(e){return[...this.getVertexPoint(e.x,e.y),...this.getVertexPoint(e.x+e.width,e.y),...this.getVertexPoint(e.x,e.y+e.height),...this.getVertexPoint(e.x+e.width,e.y+e.height)]}resize(e,t){if(this.width!==e||this.height!==t){if(this.width=e,this.height=t,this._canvas&&(this._canvas.width=e,this._canvas.height=t),this.texture&&this.fbo){this.useTexture();let i=this.context.ctx;i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,t,0,i.RGBA,i.UNSIGNED_BYTE,null)}this.output&&this.output.matchInputSize&&this.output.resize(e,t)}}draw(e,t){this.setAttributes(e||this.positionBuffer,t||this.texCoordBuffer);let i=this.context.ctx;i.drawArrays(i.TRIANGLE_STRIP,0,4)}draw2d(t,i,r,n,a,o,s,c,l){let d=!(Vk(o)||Vk(s)||Vk(c)||Vk(l));return!(!this.ctx2d||!t)&&(t instanceof ImageData?(d?this.ctx2d.putImageData(t,i,r,o,s,c,l):this.ctx2d.putImageData(t,i,r),this.emit(e.RENDER,this.ctx2d.canvas)):(d?this.ctx2d.drawImage(t,o,s,c,l,i,r,n,a):this.ctx2d.drawImage(t,i,r,n,a),this.emit(e.RENDER,t)),"undefined"!=typeof VideoFrame&&t instanceof VideoFrame&&t.close(),!0)}drawBackGround2d(e){this.ctx2d&&(this.ctx2d.save(),this.ctx2d.fillStyle=e,this.ctx2d.fillRect(0,0,this.width,this.height),this.ctx2d.restore())}getInfo(){var e;let{totalFrames:t,x:i,y:r,width:n,height:a,name:o,cost:s}=this,c=Date.now(),l=(t-this.lastInfo.totalFrames)/((c-this.lastInfo.timestamp)/1e3)|0;return this.lastInfo={totalFrames:t,x:i,y:r,width:n,height:a,timestamp:c,fps:l,name:o,cost:s},dA({parent:null==(e=this.input)?void 0:e.getInfo()},this.lastInfo)}createTexture(e){let t=this.context.ctx,i=t.createTexture();return this.useTextures(i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.pixelStorei(t.UNPACK_ALIGNMENT,1),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),i}};vA(Ax,"RENDER","render"),gA([$L(iN.INIT,"connected",{sync:!0})],Ax.prototype,"connect",1),gA([$L("connected",iN.INIT,{ignoreError:!0,sync:!0})],Ax.prototype,"disconnect",1),gA([$L([],"closed",{sync:!0})],Ax.prototype,"close",1);var Rx=Ax,kx=qP(function(e){return KP(t=>{let i=0,r=setInterval(()=>t.next(i++),e);return t.defer(()=>{clearInterval(r)}),"interval"},"interval",arguments)}(250),cx(()=>performance.now()),$P()),Cx=[0,1,1,1,0,0,1,0],Dx=class extends Rx{constructor(e,t){super(e,Object.assign({useDefaultProgram:!0,createTexture:!1,name:"destination"},t)),vA(this,"_intervalId",0),vA(this,"_sequence",0),vA(this,"checkGLError",!1),vA(this,"checkVisibilityChange"),e instanceof Bx?this.ctx2d=e.ctx||null:e.available&&null!=t&&t.mirrorUpAndDown&&this.setTexBuffer(Cx)}start(e){this.log.info("".concat(this.name," start render ").concat(e," fps")),cN.clearTask(this._intervalId),this._intervalId=cN.run("intervalInWorker",()=>{if(e!==this.context.frameRate&&(cN.clearTask(this._intervalId),this.start(this.context.frameRate)),this.requestFrame(this._sequence++),this.checkGLError&&this.context instanceof Fx){let e=this.context.ctx.getError();e&&this.context.destroy(new YR({code:qR.VIDEO_MANAGER_ERROR,extraCode:5,message:"".concat(this.name," req ").concat(this._sequence," render ").concat(this.totalFrames," faild ").concat(e)}))}},{fps:this.context.frameRate})}render(e){var t;return!(null==(t=this.input)||!t.requestFrame(e))&&(this.useProgram(),this.useBufferFrame(),this.useInputTexture(),this.draw(),this.emit(Rx.RENDER,this.context._canvas),!0)}addInput(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];super.addInput(e,...i),this.start(this.context.frameRate)}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;"closed"!==this.state&&(this._intervalId&&(cN.clearTask(this._intervalId),this._intervalId=0,1===e&&(this.log.info("".concat(this.name," use requestVideoFrameCallback")),this.checkVisibilityChange=()=>{document.hidden&&(this.start(this.context.frameRate),this.log.info("".concat(this.name," use timer")),document.removeEventListener("visibilitychange",this.checkVisibilityChange))},document.addEventListener("visibilitychange",this.checkVisibilityChange))),this.requestFrame(this._sequence++))}removeInput(e){super.removeInput(e),cN.clearTask(this._intervalId)}resize(e,t){super.resize(e,t),this.context.setSize(e,t)}close(){super.close(),cN.clearTask(this._intervalId),document.removeEventListener("visibilitychange",this.checkVisibilityChange)}},Ox=class extends Dx{constructor(e,t){super(e,t),vA(this,"_videoTrack"),vA(this,"_muteOb"),vA(this,"_closedOb",rx(this,"closed")),vA(this,"_subscription"),vA(this,"_canvasContainer"),Number(oO)<17&&(this._canvasContainer=document.createElement("div"),this._canvasContainer.style.display="none"),[this._videoTrack]=e.canvas.captureStream().getVideoTracks(),this._muteOb=rx(this._videoTrack,"mute"),qP(rx(this._videoTrack,"ended"),ox(this._closedOb),gx(()=>{this.context.destroy(new YR({code:qR.VIDEO_MANAGER_ERROR,extraCode:8,message:"video track ended"}))}))}enableCheckMute(){this._subscription=qP(this._muteOb,ox(this._closedOb),mx((e=>t=>{let i=performance.now();qP(kx,sx(t=>t-i<e),ax(1))(t)})(5e3)),nx(()=>{var e;return!(null==(e=this._videoTrack)||!e.muted||document.hidden)}),gx(()=>{this.context.destroy(new YR({code:qR.VIDEO_MANAGER_ERROR,extraCode:7,message:"video track muted"}))}))}disableCheckMute(){var e;null==(e=this._subscription)||e.dispose()}get videoTrack(){return this._videoTrack}putCanvasIntoDom(){!this.context._canvas||!this._canvasContainer||document.getElementById(this.context._canvas.id)||(this.log.info("".concat(this.name," put canvas to body")),document.body.appendChild(this._canvasContainer),this._canvasContainer.appendChild(this.context._canvas))}render(e){return this.putCanvasIntoDom(),super.render(e)}render2d(e){return this.putCanvasIntoDom(),super.render2d(e)}close(){var e,t;super.close(),null==(e=this._videoTrack)||e.stop(),delete this._videoTrack,null==(t=this._canvasContainer)||t.remove()}},Lx=class extends Rx{constructor(e,t){super(e,dA({name:"imageSource"},t)),vA(this,"_lastImage"),vA(this,"_totalFrames",0),vA(this,"_autoResize",!1),vA(this,"_canvasRendered"),vA(this,"videoCallbackId",0),vA(this,"waitingFirstFrame",!0),vA(this,"shouldUpdate",!0),this._autoResize=!1!==(null==t?void 0:t.autoResize),16===lO&&(this._canvasRendered=tx(),qP(this._canvasRendered,function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return e=>KP(function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.length;for(;r<n&&!i.disposed;)i.next(t[r++]);i.disposed||i.subscribe(e)},"startWith",arguments)}(this._image),px(e=>e instanceof HTMLCanvasElement?rx(e,"rendered"):function(){return KP(e=>e.complete(),"empty",arguments)}()),ox(rx(this,"closed")),gx(()=>{this.update()})))}onFirstFrame(){this.waitingFirstFrame=!1}tryVideoFrameCallback(){if(!this.shouldUpdate)return;let e=this.image;this.videoCallbackId&&e.cancelVideoFrameCallback(this.videoCallbackId),BL()&&!document.hidden&&(this.videoCallbackId=e.requestVideoFrameCallback((e,t)=>{this.waitingFirstFrame&&this.onFirstFrame(),document.hidden||(this._totalFrames=t.presentedFrames,this.update(1))}))}_render(e,t){var i;let{width:r,height:n}=this,{image:a}=this;if(a instanceof HTMLVideoElement){if(this.tryVideoFrameCallback(),({videoWidth:r,videoHeight:n}=a),!r||!n)return!1;a.width=r,a.height=n}else if(a instanceof HTMLImageElement||a instanceof ImageData||a instanceof ImageBitmap){if(({width:r,height:n}=a),a!==this._lastImage)this._lastImage=a;else if(r===this.width&&n===this.height)return!0}else a instanceof HTMLCanvasElement||a instanceof OffscreenCanvas?(({width:r,height:n}=a),this._lastImage=a):"undefined"!=typeof VideoFrame&&a instanceof VideoFrame&&(({displayWidth:r,displayHeight:n}=a),null==(i=this._lastImage)||i.close(),this._lastImage=a);if(!this._autoResize)return!0;if(this.width===r&&this.height===n&&this.totalFrames){if(t){this.useTexture();let e=this.context.ctx;e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,a)}}else{if(t){this.useTexture();let e=this.context.ctx;e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a)}this.resize(r,n)}return!0}get image(){return this._image}set image(e){var t;null==(t=this._canvasRendered)||t.next(e),this._image=e}render(e){return this._render(e,!0)}render2d(e){return this._render(e,!1)}},Nx=class extends Lx{constructor(e,t,i){super(e,i),this._player=t,this.name="videoPlayerSource",qP(rx(this._player,lN.PLAYER_STATE_CHANGED),ox(rx(this,"closed")),nx(e=>{let{state:t}=e;return"PLAYING"===t}),gx(()=>{this.tryVideoFrameCallback()}))}get image(){return this._player.element}},Px=class extends Nx{get available(){return this._player.isPlaying&&!this.waitingFirstFrame}constructor(e,t,i){super(e,new HN({id:i.name,track:t,muted:!0,container:null,objectFit:"contain",log:i.logger}),i),this.name="videoTrackSource",this._player.play()}replaceTrack(e){this.waitingFirstFrame=!0,this._player.setTrack(e),this._player.play()}close(){super.close(),this._player.stop()}},xx=class extends Rx{constructor(e,t,i){super(e,uA(dA({name:"textSource"},i),{create2d:!0})),vA(this,"hasChange",!0),vA(this,"content",""),this.ctx2d.textBaseline="top",this.content=t.content||"",t.font&&(this.font=t.font),t.color&&(this.color=t.color)}set font(e){this.ctx2d&&(this.ctx2d.font=e,this.hasChange=!0)}get font(){var e;return(null==(e=this.ctx2d)?void 0:e.font)||""}set color(e){this.ctx2d&&(this.ctx2d.fillStyle=e,this.hasChange=!0)}get color(){var e;return(null==(e=this.ctx2d)?void 0:e.fillStyle)||""}render2d(e){return!(!this.ctx2d||!this.hasChange)&&(this.ctx2d.clearRect(0,0,this.width,this.height),this.drawMultilineText(0,0),this.hasChange=!1,!0)}render(e){return!1}resize(e,t){if(!this.ctx2d)return;let{color:i,font:r}=this;super.resize(e,t),this.color=i,this.font=r}drawMultilineText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.2;if(!this.ctx2d)return;let r=this.ctx2d.measureText(this.content);t+=r.fontBoundingBoxAscent||r.actualBoundingBoxAscent||0;let n=this.font.match(/(\d+)px/),a=(n?parseInt(n[1],10):16)*i,o=this.content.split("\n");for(let s=0;s<o.length;s++)this.ctx2d.fillText(o[s],e,t+s*a)}},Mx=class extends iN{constructor(e){super(),vA(this,"frameRate"),vA(this,"_canvas"),vA(this,"log"),vA(this,"hasAlpha",!1),vA(this,"name"),vA(this,"error"),this.name=e.name,this.log=e.logger.createChild({id:"vc-".concat(this.name)}),this.frameRate=e.frameRate}get canvas(){return this._canvas}set width(e){this._canvas&&(this._canvas.width=e)}get width(){var e;return(null==(e=this._canvas)?void 0:e.width)||0}set height(e){this._canvas&&(this._canvas.height=e)}get height(){var e;return(null==(e=this._canvas)?void 0:e.height)||0}setSize(e,t){this._canvas&&(this._canvas.width=e,this._canvas.height=t)}createVideoTrackSource(e,t){return new Px(this,e,{logger:this.log,name:t})}createVideoTrackDestination(e){return new Ox(this,e)}createVideoImageSource(e,t){return new Lx(this,t?Object.assign(t,{logger:this.log,image:e}):{logger:this.log,image:e})}createVideoPlayerSource(e,t){return new Nx(this,e,t?Object.assign(t,{logger:this.log}):{logger:this.log})}createTextSource(e,t){return new xx(this,e,t?Object.assign(t,{logger:this.log}):{logger:this.log})}get available(){return"created"===this.state}disconnect(){this.emit("disconnect")}};vA(Mx,"_ids",0);var Ux=class extends Mx{constructor(){super(...arguments),vA(this,"defaultProgam"),vA(this,"defaultVShader"),vA(this,"defaultFShader"),vA(this,"ctx"),vA(this,"_canvas2d")}get canvas(){return this._canvas2d||this._canvas}create(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.id="trtc_".concat(this.name,"_").concat(Mx._ids++)),e&&(this._canvas2d=document.createElement("canvas")),this.ctx=this._canvas.getContext("webgl2",mR),!this.ctx)throw new YR({code:qR.VIDEO_MANAGER_ERROR,extraCode:2,message:"webgl2 not supported"});this.defaultVShader=this.createShader(this.ctx.VERTEX_SHADER,"\n// 顶点着色器\nattribute vec4 a_position;\nattribute vec2 a_texCoord;\nvarying vec2 v_texCoord;\n\nvoid main() {\n  gl_Position = a_position;\n  v_texCoord = a_texCoord;\n}\n"),this.defaultFShader=this.createShader(this.ctx.FRAGMENT_SHADER,"\n// 片元着色器\nprecision mediump float;\nvarying vec2 v_texCoord;\nuniform sampler2D u_texture;\n\nvoid main() {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n} "),this.defaultProgam=this.createProgram(this.defaultVShader,this.defaultFShader),this._canvas.addEventListener("webglcontextlost",()=>{this.destroy(new YR({code:qR.VIDEO_MANAGER_ERROR,extraCode:4,message:"webgl context lost"}))})}destroy(e){let t="";return e&&(t=e.message,this.error=e,FO.addFailedEvent({key:512702,error:e})),this.disconnect(),this.log.info("video context destroy".concat(t)?": ".concat(t):""),this.ctx&&(this.ctx.deleteShader(this.defaultVShader),this.ctx.deleteShader(this.defaultFShader),this.ctx.deleteProgram(this.defaultProgam),delete this.ctx),e}set width(e){var t;null==(t=this.ctx)||t.viewport(0,0,e,this.height),super.width=e,this._canvas2d&&(this._canvas2d.width=e)}set height(e){var t;null==(t=this.ctx)||t.viewport(0,0,this.width,e),super.height=e,this._canvas2d&&(this._canvas2d.height=e)}setSize(e,t){var i;null==(i=this.ctx)||i.viewport(0,0,e,t),super.setSize(e,t),this._canvas2d&&(this._canvas2d.width=e,this._canvas2d.height=t)}createShader(e,t){let i=this.ctx,r=i.createShader(e);return i.shaderSource(r,t),i.compileShader(r),r}createProgram(e,t){let i=this.ctx,r=i.createProgram();return i.attachShader(r,e),i.attachShader(r,t),i.linkProgram(r),i.getProgramParameter(r,i.LINK_STATUS)||this.log.error(i.getProgramInfoLog(r)),r}};vA(Ux,"UNAVAILABLE","unavailable"),gA([$L(iN.INIT,"created",{sync:!0,fail(e){this.log.error("video gl context create failed",e.cause),FO.addFailedEvent({key:512700,error:e.cause||e})},success(){this.log.info("video context created use webgl"),FO.addSuccessEvent({key:512700})}})],Ux.prototype,"create",1),gA([$L("created",iN.INIT,{ignoreError:!0,sync:!0,success(e){e&&this.emit(Ux.UNAVAILABLE,e),this.removeAllListeners()}})],Ux.prototype,"destroy",1);var Fx=Ux,Bx=class extends Mx{constructor(){super(...arguments),vA(this,"ctx")}create(e){if(this.hasAlpha=e.alpha,this._canvas=document.createElement("canvas"),this._canvas.id="trtc_".concat(this.name,"_").concat(Mx._ids++),this.ctx=this._canvas.getContext("2d",{alpha:e.alpha,willReadFrequently:e.willReadFrequently}),!this.ctx)throw new YR({code:qR.VIDEO_MANAGER_ERROR,extraCode:2,message:"2d context not supported"});this._canvas.addEventListener("contextlost",()=>{this.log.error("2d context lost")}),this._canvas.addEventListener("contextrestored",()=>{this.log.warn("2d context restored")})}destroy(e){let t="";e&&(t=e.message,this.error=e,FO.addFailedEvent({key:512703,error:e})),this.disconnect(),this.log.info("video context destroy ".concat(t?": ".concat(t):"")),delete this.ctx,this._canvas&&(this._canvas.remove(),this._canvas.width=0,this._canvas.height=0,delete this._canvas),this.removeAllListeners(),FO.addSuccessEvent({key:512703})}};gA([$L(iN.INIT,"created",{sync:!0,fail(e){this.log.error("video 2d context create failed",e.cause),FO.addFailedEvent({key:512701,error:e.cause||e})},success(){this.log.info("video context created use 2d"),FO.addSuccessEvent({key:512701})}})],Bx.prototype,"create",1),gA([$L("created",iN.INIT,{ignoreError:!0,sync:!0})],Bx.prototype,"destroy",1);var Vx=AO();if("undefined"!=typeof navigator&&navigator.mediaDevices&&"setCaptureHandleConfig"in navigator.mediaDevices)try{navigator.mediaDevices.setCaptureHandleConfig({handle:Vx,exposeOrigin:!0,permittedOrigins:["*"]})}catch(JS){}var Hx=async function(e){let t=null,i=function(e){let t={preferCurrentTab:"current-tab"===e.preferDisplaySurface||!!e.captureElement,systemAudio:"include",selfBrowserSurface:"include",surfaceSwitching:"include"},i={width:nO?{max:e.width}:{ideal:e.width,max:e.width},height:nO?{max:e.height}:{ideal:e.height,max:e.height},frameRate:e.frameRate,displaySurface:e.preferDisplaySurface||"monitor"};if(t.video=i,e.systemAudio){let{echoCancellation:i=!0,noiseSuppression:r=!1,autoGainControl:n=!1}=e;t.audio={echoCancellation:i,noiseSuppression:r,autoGainControl:n,sampleRate:48e3}}return t}(e);SO.info("getDisplayMedia with constraints: ".concat(JSON.stringify(i)));let r=await navigator.mediaDevices.getDisplayMedia(i);e.systemAudio&&0===r.getAudioTracks().length&&($D&&tO<74||nO||nD)&&SO.warn("Your browser not support capture system audio");let n=r.getVideoTracks()[0];if(n){if(e.frameRate)try{await n.applyConstraints({frameRate:{min:e.frameRate,ideal:e.frameRate},width:e.width,height:e.height})}catch(a){SO.warn("screen applyConstraints failed: ".concat(a))}e.captureElement&&await async function(e,t){var i;if("CropTarget"in window&&"fromElement"in CropTarget&&Bk(e.cropTo))try{if((null==(i=e.getCaptureHandle())?void 0:i.handle)!==Vx)return;let r=await CropTarget.fromElement(t);await e.cropTo(r)}catch(r){SO.warn("cropTo target failed ".concat(r))}}(n,e.captureElement)}if(e.audio){let i=function(e){let t={echoCancellation:e.echoCancellation,autoGainControl:e.autoGainControl,noiseSuppression:e.noiseSuppression,sampleRate:e.sampleRate,channelCount:e.channelCount};return Vk(e.microphoneId)||(t.deviceId=e.microphoneId),{audio:t,video:!1}}(e);SO.info("getUserMedia with constraints: ".concat(JSON.stringify(i))),t=await navigator.mediaDevices.getUserMedia(i),r.addTrack(t.getAudioTracks()[0])}return r};gA([SA(function(e){this.setContentHint(e.contentHint||"detail")})],class extends Ix{constructor(e){super(e,2),vA(this,"profile",{width:1920,height:1080,frameRate:5,bitrate:1600}),vA(this,"objectFit","contain"),vA(this,"isScreen",!0),this._log.id="s-".concat(this._log.id)}get isShareCurrentTab(){var e,t;try{return Vx===(null==(t=null==(e=this.mediaTrack)?void 0:e.getCaptureHandle())?void 0:t.handle)}catch(i){return}}async capture(e){let{systemAudio:t=!1,autoGainControl:i,echoCancellation:r,noiseSuppression:n,audioTrack:a,videoTrack:o,captureElement:s,preferDisplaySurface:c}=e;try{let e;return o||a?(e=new MediaStream,o&&e.addTrack(o),a&&e.addTrack(a)):(e=await Hx({audio:!1,systemAudio:t,width:this.profile.width,height:this.profile.height,frameRate:this.profile.frameRate,autoGainControl:i,echoCancellation:r,noiseSuppression:n,captureElement:s,preferDisplaySurface:c}),this.sourceTrack=e.getVideoTracks()[0]),await this.setInputMediaStreamTrack(e.getVideoTracks()[0]),e}catch(l){throw this.log.error("getDisplayMedia error observed ".concat(l)),l instanceof YR?l:new YR({code:qR.INITIALIZE_FAILED,name:l.name,message:l.message})}}async switchDevice(e){throw new Error("Method not implemented.")}}.prototype,"capture",1);var jx=class e extends SP{constructor(t,i,r){super({userId:i.userId,sdkAppId:t.sdkAppId,mediaType:r,room:t}),this.room=t,this.user=i,vA(this,"tinyId"),vA(this,"isRemote",!0),vA(this,"jitterBufferDelay",0),vA(this,"availableState"),vA(this,"remotePublishState"),vA(this,"_triggerCheckDecodeSubject",tx(rx(this,e.STATE_SUBSCRIBE))),vA(this,"ignoreUpdatePlayingState"),this.tinyId=i.tinyId,this.availableState=new iN("".concat(i.userId,"-").concat(this.mediaType,"-available"),"remote-track-available"),this.remotePublishState=new iN("".concat(i.userId,"-").concat(this.mediaType,"-remote-publish"),"remote-track-publish"),qP(ex(rx(this,iN.STATECHANGED),rx(this.remotePublishState,iN.STATECHANGED)),cx(()=>this.isRemotePublished&&(this.isSubscribed||this.isSubscribing)),gx(e=>{this.availableState.state!==(e?iN.ON:iN.OFF)&&(this.availableState.state=e?iN.ON:iN.OFF),(!this.isRemotePublished||!this.ignoreUpdatePlayingState)&&this.updatePlayingState(e)}));let n=qP(rx(this.player,lN.ERROR),nx(e=>e.code===MediaError.MEDIA_ERR_DECODE)),a=qP(function(e,t){return KP(i=>{let r=0,n=setTimeout(()=>{if(i.removeDefer(a),i.next(r++),t){let e=setInterval(()=>i.next(r++),t);i.defer(()=>{clearInterval(e)})}else i.complete()},e),a=()=>clearTimeout(n);i.defer(a)},"timer",arguments)}(5e3),nx(()=>!!(!this.ignoreDecodeError&&this.isSubscribed&&this.isPlayCalled&&this.stat.bytesReceived&&this.isRemotePublished)&&(!this.player.isPlaying&&!(this.kind===WA?this.getAudioLevel()>0:this.stat.framesDecoded>0)||(this.reportDecodeResult(!0),!1)))),o=qP(function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return KP(e=>{let i=new Map;t.forEach(t=>{let r=new WP(e);i.set(t,r),r.complete=()=>{i.delete(t),0===i.size?e.complete():r.dispose()},r.next=e=>{i.delete(t),i.forEach(e=>e.dispose()),r.resetNext(),r.resetComplete(),r.next(e)}}),t.forEach(e=>i.get(e).subscribe(e))},"race",arguments)}(n,a),ox(rx(this,iN.INIT)));qP(this._triggerCheckDecodeSubject,nx(()=>!this.ignoreDecodeError),mx(o),gx(e=>{this.reportDecodeResult(!1,e)}))}setMute(e){this.isRemotePublished&&super.setMute(e)}setInputMediaStreamTrack(e){super.setInputMediaStreamTrack(e),this.isRemotePublished&&this.isSubscribed&&this.player.setTrack(this.outMediaTrack)}checkDecodeResult(){this._triggerCheckDecodeSubject.next(!0)}waitHasMediaTrack(){return new Promise(e=>{this.mediaTrack?e():this.once("input-media-track-changed",e)})}get ignoreDecodeError(){var e,t,i,r;return null!=(r=null==(i=null==(t=null==(e=this.room)?void 0:e.networkQuality)?void 0:t.hadRecentBadDownlink)?void 0:i.call(t,2))&&r||this.player.isInAutoPlayFailedState}get isSubscribing(){return"subscribeing"===this.state.toString()}get isSubscribed(){return this.state===e.STATE_SUBSCRIBE}get isAvailable(){return this.availableState.state===iN.ON}get isNeedPlay(){return this.isAvailable&&this.isPlayCalled}subscribe(e){return e}unsubscribe(){"main"===this.streamType&&"video"===this.kind&&this.room.changeType(!1,this.user)}reportDecodeResult(e,t){var i,r;let n=this.kind===WA;if(FO[e?"addSuccessEvent":"addFailedEvent"]({key:n?504700:514702}),!n){let t=(null==(i=this.room)?void 0:i.downlinkVideoCodec.toUpperCase())||"H264";FO[e?"addSuccessEvent":"addFailedEvent"]({key:MO["DECODE_".concat(t,"_RESULT")]}),e||this.log.warn("".concat(null==(r=this.room)?void 0:r.downlinkVideoCodec," decode failed"))}e||(FO.addEnum({key:n?504701:514703,value:yO()}),fN.uploadEvent({log:"stat-decode-failed-".concat(this.kind,"-").concat(gO()||EO()),userId:this.room.userId}),this._log.warn("decode failed: isPlaying: ".concat(this.player.isPlaying," ").concat(this.kind===WA?"audioLevel: ".concat(this.getAudioLevel()):"framesDecoded: ".concat(this.stat.framesDecoded>0))),this.emit("decode-failed",{error:t}))}updatePlayingState(e){if(this.player.isPlayCalled&&this.player.setTrack(this.playerMediaTrack),this.isPlayCalled&&this.player.isStopped===e){if(e&&(!this.isSubscribed||!this.isRemotePublished||!this.outMediaTrack))return void this.log.info("abort play, isSubscribed: ".concat(this.isSubscribed," isAvailable: ").concat(this.isRemotePublished," hasTrack: ").concat(!!this.outMediaTrack," "));super.updatePlayingState(e)}}close(){super.close(),this.outMediaTrack&&this.uninstallTrackEvent(this.outMediaTrack)}onFlagChanged(){this.remotePublishState.state=this.isRemotePublished?iN.ON:iN.OFF,this.emit("remote-publish-changed",this.isRemotePublished)}onTrackMuted(){this.isNeedPlay&&super.onTrackMuted()}onTrackUnmuted(){this.isNeedPlay&&super.onTrackUnmuted()}onTrackEnded(){this.isNeedPlay&&super.onTrackEnded()}};vA(jx,"STATE_SUBSCRIBE","subscribe"),gA([function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return AA((i,r)=>function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return new Promise((n,o)=>{let s=setTimeout(()=>{let i=new YR({code:qR.API_CALL_TIMEOUT,message:"checkPendingPromise ".concat(r,"() timeout ").concat(e,"s")});(this.log||this._log||SO).warn(i),2===t?o(i):1===t&&n()},1e3*e);this._checkPendingPromiseSet||(this._checkPendingPromiseSet=new Set),this._checkPendingPromiseSet.add(s),i.apply(this,a).then(n,o).finally(()=>{clearTimeout(s),this._checkPendingPromiseSet&&s&&this._checkPendingPromiseSet.delete(s)})})})}(5,1)],jx.prototype,"waitHasMediaTrack",1),gA([$L(iN.INIT,jx.STATE_SUBSCRIBE,{success(){this.log.info("subscribed"),bO.emit(wO.REMOTE_TRACK_SUBSCRIBED,{track:this})},ignoreError:!0}),UP(521716,!1)],jx.prototype,"subscribe",1),gA([$L(jx.STATE_SUBSCRIBE,iN.INIT,{sync:!0,success(){this.log.info("unsubscribed"),bO.emit(wO.REMOTE_TRACK_UNSUBSCRIBED,{track:this})}})],jx.prototype,"unsubscribe",1);var zx=jx,Wx=class extends Rx{constructor(e,t,i,r,n){super(e,{useDefaultProgram:!0,useFbo:!0,name:"alpha",create2d:!0,logger:t}),this.setContainer=r,vA(this,"initStat",{alphaStitchingType:1}),vA(this,"end",tx()),vA(this,"minSize",320),vA(this,"maxSize",1280),vA(this,"draggable",!1),vA(this,"startDragX",0),vA(this,"startDragY",0),vA(this,"left",0),vA(this,"top",0),vA(this,"baseWidth",320),vA(this,"baseRatio"),vA(this,"container"),this.initStat=n,this.draggable=i,this.bindDragEvents(),FO.addEnum({key:515700,value:1}),this.draggable&&FO.addEnum({key:515700,value:11})}bindDragEvents(){let e=this.context._canvas;if(e)if(this.draggable){let t=ox(this.end);qP(rx(e,"mousedown"),vx(this.startDrag.bind(this)),px(()=>qP(rx(window,"mousemove"),ox(rx(window,"mouseup")))),t,gx(this.doDrag.bind(this))),qP(rx(e,"dblclick"),t,gx(this.resetPosition.bind(this))),qP(rx(e,"wheel"),t,gx(this.handleZoom.bind(this))),this.renderCanvas()}else{if(!this.container)return;this.container.style.removeProperty("left"),this.container.style.removeProperty("top"),this.end.next()}}render(e){var t;return!(null==(t=this.input)||!t.requestFrame(e))&&(this.useProgram(),this.useBufferFrame(),this.useInputTexture(),this.draw(),!0)}startDrag(e){e.preventDefault(),0===e.button&&(this.startDragX=e.clientX-this.left,this.startDragY=e.clientY-this.top)}renderCanvas(){let{container:e}=this;e||this.setContainer(),e&&this.baseRatio&&this.draggable&&(e.style.setProperty("width","".concat(this.baseWidth,"px")),e.style.setProperty("height","".concat(this.baseWidth/this.baseRatio,"px")),e.style.setProperty("position","fixed"),e.style.setProperty("left","".concat(this.left,"px")),e.style.setProperty("top","".concat(this.top,"px")))}doDrag(e){e.preventDefault(),this.left=e.clientX-this.startDragX,this.top=e.clientY-this.startDragY,this.renderCanvas()}handleZoom(e){e.preventDefault();let t=e.deltaY,i=this.context._canvas;i&&(this.baseWidth||(this.baseWidth=i.offsetWidth),this.baseWidth=t<0?Math.min(1.1*this.baseWidth,this.maxSize):Math.max(.9*this.baseWidth,this.minSize),this.renderCanvas())}resetPosition(){this.left=0,this.top=0,this.renderCanvas()}onRatioReset(){this.renderCanvas()}draw2d(e,t,i,r,n){var a;let{ctx2d:o}=this,s=this.context._canvas;if(!o||!s)return!1;let c=super.draw2d(e,t,i,r,n),l=o.getImageData(0,0,r,n),{data:d}=l,u=!1;if(1===this.initStat.alphaStitchingType){let e=Math.floor(r/2);for(let t=0;t<n;t++)for(let i=0;i<e;i++){let n=4*(t*r+i),a=4*(t*r+(i+e)),o=d[a];d[a+3]=0;let s=o>=100;d[n+3]=s?255:0}u=super.draw2d(l,0,0,0,0,e,n),s.width=e}else if(2===this.initStat.alphaStitchingType){let e=Math.floor(n/2);for(let t=0;t<e;t++)for(let i=0;i<r;i++){let n=4*(t*r+i),a=4*((t+e)*r+i),o=d[a];d[a+3]=0;let s=o>=100;d[n+3]=s?255:0}u=super.draw2d(l,0,0,0,0,r,e),s.height=e}return null==(a=this.context.ctx)||a.clearRect(0,0,r,n),c&&u}close(){this.baseRatio=void 0,this.end.next(),this.end.complete()}};var Gx=class extends zx{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:4),vA(this,"mediaType",4),vA(this,"source"),vA(this,"shouldRenderAlpha",!1),vA(this,"alphaNode"),vA(this,"shouldBeDraggable",!0),vA(this,"stat",{bytesReceived:0,packetsReceived:0,packetsLost:0,framesReceived:0,framesDecoded:0,frameWidth:0,frameHeight:0,end2EndDelay:0,jitterBufferDelay:0,keyFramesDecoded:0}),vA(this,"_keyFrameCountLogged",!1),vA(this,"_keyFrameStartTimestamp",0),vA(this,"_keyFrameStartCount",0),vA(this,"_keyFrameIntervals",[]),vA(this,"_prevKeyFrameTimestamp",0),this.manager=e.videoManager,this.on("first-video-frame",e=>{this.room.emit("first-video-frame",e)})}isAlphaSei(e){if(this.userId!==e.userId||50!==e.seiPayloadType)return!1;let t=new Uint8Array(e.data);return t.length%3==0&&0===t[0]&&1===t[1]&&t}play(e,t){return null!=t&&t.canvasRender&&!this.source&&this.useCanvasPlayer(),super.play(e,t).then(()=>{this.player.calculateStat(),bO.emit("156",{track:this,player:this.player})})}updateAlphaRenderInfo(e){let t=this.isAlphaSei(e);if(t)if(this.alphaNode){let e=t[2];if(this.alphaNode.baseRatio&&this.alphaNode.initStat.alphaStitchingType===e)return;this.alphaNode.initStat={alphaStitchingType:e};let i=this.player.getElement();if(i){let t=i.videoWidth/i.videoHeight;t&&(this.alphaNode.baseRatio=t*(1===e?.5:2),this.alphaNode.onRatioReset())}this.player.canvas&&(this.player.canvas.id=this.generateAlphaCanvasName(e))}else this.shouldRenderAlpha=!0,this.player.shouldRenderAlpha=!0,this.useCanvasPlayer(t[2])}generateAlphaCanvasName(e){let t=OA[e];return"".concat("alpha","_").concat(t,"_").concat(this.userId)}useCanvasPlayer(e){if(this.log.info("useCanvasPlayer(), has element:".concat(!!this.player.element)),!this.player.element)return;let t=new Bx({frameRate:15,logger:this.log,name:this.shouldRenderAlpha&&e?this.generateAlphaCanvasName(e):this.userId});t.create({alpha:this.shouldRenderAlpha,willReadFrequently:this.shouldRenderAlpha});let i=new Dx(t,{name:"remotePlayer",logger:this.log});if(this.source=t.createVideoPlayerSource(this.player),this.player.setCanvas(t._canvas),this.shouldRenderAlpha&&e){let r=()=>{!this.player.container||!this.alphaNode||(this.alphaNode.container=this.player.container,this.alphaNode.renderCanvas())},n=new Wx(t,this.log,this.shouldBeDraggable,r,{alphaStitchingType:e});this.source.connect(n),n.connect(i),this.alphaNode=n}else this.source.connect(i);BL()||(this.updateCanvasPlayerFPS=this.updateCanvasPlayerFPS.bind(this,t),this.room.on("heartbeat-report",this.updateCanvasPlayerFPS,this))}updateCanvasPlayerFPS(e){let t=this.decodeFPS,i=function(e){return[15,30,45,60].reduce((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t)}(t);!jk(t)||t<=0?this.log.debug("updateCanvasPlayerFPS() ignore decoder: ".concat(t," ")):i!==e.frameRate?(this.log.info("updateCanvasPlayerFPS() decoder: ".concat(t,", closest: ").concat(i,", current: ").concat(e.frameRate)),e.frameRate=i):this.log.debug("updateCanvasPlayerFPS() ignore ClosestFPS ".concat(i," == ").concat(e.frameRate))}get decodeFPS(){var e;let{msg_video_status:t}=(null==(e=this.room.heartbeatReport)?void 0:e.msg_down_stream_info.find(e=>e.msg_user_info.str_identifier===this.userId))||{},i=2===this.mediaType?7:this.isSmall?3:2;if(!t||0===t.length)return 0;let r=t.find(e=>e.uint32_video_stream_type===i);return(null==r?void 0:r.uint32_video_dec_fps)||0}stop(){return this.room.off("heartbeat-report",this.updateCanvasPlayerFPS,this),bO.emit("157",{track:this,player:this.player}),this.alphaNode&&this.alphaNode.close(),super.stop()}decodeFrame(e){if(!this.manager)return e;for(let t of this.manager.decodePipeline)if(t&&!(e=t({frame:e,track:this})))return;return e}get isBig(){return 4===this.mediaType}get isSmall(){return 8===this.mediaType}changeType(e){this.room.changeType(e,this.user)}get isRemotePublished(){return this.user.muteState.videoAvailable}setMirror(e){"publish"===e||"both"===e||super.setMirror(e)}setDraggable(e){this.shouldBeDraggable=e,this.alphaNode&&(this.alphaNode.draggable=e,this.alphaNode.bindDragEvents())}onDecodeDowngradeStateChanged(e){this.emit("decode-downgrade-state-changed",e)}updateKeyFramesDecoded(e){let t=this.stat.keyFramesDecoded||0;if(this.stat.keyFramesDecoded=e,this._keyFrameCountLogged)return;let i=Date.now();if(!this._keyFrameStartTimestamp)return this._keyFrameStartTimestamp=i,this._keyFrameStartCount=e,void(this._prevKeyFrameTimestamp=i);if(this._prevKeyFrameTimestamp&&e>t){let r=e-t,n=(i-this._prevKeyFrameTimestamp)/1e3/r;this._keyFrameIntervals.push(n)}this._prevKeyFrameTimestamp=i;let r=i-this._keyFrameStartTimestamp;if(r>=16e3){let t=e-this._keyFrameStartCount,i=t>0?r/1e3/t:0,n="".concat(t," keyframes in 16s ").concat(i," [").concat(this._keyFrameIntervals.map(e=>e.toFixed(1)).join(","),"] keyFramesDecoded ").concat(e),a=i<=2.5?"debug":"info";this.log[a](n),this._keyFrameCountLogged=!0}}},qx=new Map;function Kx(e,t){let i=uA(dA({},t),{timestamp:XR()});qx.has(e)?qx.get(e).push(i):qx.set(e,[i])}bO.on(wO.JOIN_SUCCESS,e=>{let{room:t}=e;Kx(t.userId,{eventId:32788})}),bO.on(wO.LEAVE_START,e=>{let{room:t}=e;Kx(t.userId,{eventId:32789})}),bO.on(wO.LOCAL_TRACK_PUBLISHED,e=>{let{track:t}=e;if(t.room){let e=32769;4===t.mediaType?e=32768:2===t.mediaType&&(e=32805),Kx(t.room.userId,{eventId:e})}}),bO.on(wO.LOCAL_TRACK_UNPUBLISHED,e=>{let{track:t}=e;if(t.room){let e=32771;4===t.mediaType?e=32770:2===t.mediaType&&(e=32806),Kx(t.room.userId,{eventId:e})}}),bO.on(wO.TRACK_MUTED,e=>{let{track:t}=e;t.room&&(t.kind===WA?Kx(t.room.userId,{eventId:t.isRemote?32785:32772,remoteUserId:t.isRemote?t.userId:void 0}):Kx(t.room.userId,{eventId:t.isRemote?32784:32773,remoteUserId:t.isRemote?t.userId:void 0}))}),bO.on(wO.TRACK_UNMUTED,e=>{let{track:t}=e;t.room&&(t.kind===WA?Kx(t.room.userId,{eventId:t.isRemote?32787:32774,remoteUserId:t.isRemote?t.userId:void 0}):Kx(t.room.userId,{eventId:t.isRemote?32786:32775,remoteUserId:t.isRemote?t.userId:void 0}))}),bO.on(wO.REMOTE_TRACK_SUBSCRIBED,e=>{let{track:t}=e;t.room&&(1===t.mediaType&&Kx(t.room.userId,{eventId:32777,remoteUserId:t.userId}),4===t.mediaType&&Kx(t.room.userId,{eventId:32776,remoteUserId:t.userId}),8===t.mediaType&&Kx(t.room.userId,{eventId:32803,remoteUserId:t.userId}))}),bO.on(wO.REMOTE_TRACK_UNSUBSCRIBED,e=>{let{track:t}=e;t.room&&(1===t.mediaType&&Kx(t.room.userId,{eventId:32779,remoteUserId:t.userId}),4===t.mediaType&&Kx(t.room.userId,{eventId:32778,remoteUserId:t.userId}),8===t.mediaType&&Kx(t.room.userId,{eventId:32804,remoteUserId:t.userId}))}),bO.on(wO.SWITCH_DEVICE_SUCCESS,e=>{let{track:t}=e;t.room&&Kx(t.room.userId,{eventId:t.kind===GA?32780:32781})}),bO.on(wO.LOCAL_TRACK_REPLACED,e=>{let{track:t}=e;t.room&&Kx(t.room.userId,{eventId:t.kind===GA?32782:32783})}),bO.on(wO.SIGNAL_CONNECTION_STATE_CHANGED,e=>{let t,{room:i,prevState:r,state:n}=e;switch(n){case"CONNECTED":t="RECONNECTING"===r?32795:32791;break;case"DISCONNECTED":t="RECONNECTING"===r?32796:32790;break;case"RECONNECTING":t=32794}t&&Kx(i.userId,{eventId:t})}),bO.on(wO.PEER_CONNECTION_STATE_CHANGED,e=>{let t,{room:i,prevState:r,state:n,remoteUserId:a}=e,o=!!a;switch(n){case"CONNECTED":t="RECONNECTING"===r?o?32801:32798:o?32793:32792;break;case"DISCONNECTED":"RECONNECTING"===r&&(t=o?32802:32799);break;case"RECONNECTING":t=o?32800:32797}t&&Kx(i.userId,{eventId:t,remoteUserId:a})}),bO.on(wO.VIDEO_CODEC_IMPLEMENTATION_CHANGED,e=>{let{implementation:t,userId:i,remoteUserId:r,codec:n,isHWCodec:a,prevImplementation:o,streamType:s}=e,c=a?1:0;o||(c=a?3:2);let l={H264:0,H265:1,VP8:2}[n.toUpperCase()],d={eventId:4004,param1:c,param2:l,streamType:s||2};r&&(d.remoteUserId=r,d.eventId=4005),Kx(i,d),FO.addEnum({key:r?514701:513701,value:c}),FO.addEnum({key:r?514700:513700,value:l})}),bO.on(wO.LOCAL_TRACK_RECAPTURE,e=>{let{track:t,error:i}=e;if(t.userId){let e={eventId:2003,param1:0};t.kind===WA?(e.streamType=1,i&&(e.param1=2)):(e.streamType="auxiliary"===t.streamType?7:2,i&&(e.param1=8)),Kx(t.userId,e)}}),mA(yA(),1),mA(yA(),1);var Yx="trtc_debug_dialog",Xx="".concat(Yx,"_activated"),Zx="".concat(Yx,"_switch"),Jx="".concat(Yx,"_mask"),Qx="".concat(Yx,"_panel"),$x="".concat(Yx,"_tabber"),eM="".concat(Yx,"_tab"),tM="".concat(Yx,"_topbar"),iM="".concat(Yx,"_toptab"),rM="".concat(Yx,"_content"),nM="".concat(Yx,"_has_topbar"),aM="".concat(rM,"_log"),oM="".concat(rM,"_network"),sM="".concat(Yx,"_dump"),cM="".concat(oM,"_title"),lM="".concat(oM,"_basic"),dM="".concat(oM,"_local"),uM="".concat(oM,"_remote"),hM="".concat(sM,"_title"),pM="".concat(sM,"_local"),fM="".concat(sM,"_remote"),mM="".concat(fM,"_hook"),gM="".concat(Yx,"_banner"),vM="".concat(gM,"_item"),_M="".concat(Yx,"_toolbar"),yM="".concat(Yx,"_tool"),EM="".concat(Yx,"_item"),bM="".concat(EM,"_debug"),wM="".concat(EM,"_info"),IM="".concat(EM,"_warn"),TM="".concat(EM,"_error"),SM="".concat(Yx,"_back_top"),AM="".concat(Yx,"_go_bottom"),RM="".concat(sM,"_local_audio"),kM="".concat(sM,"_local_video_main"),CM="".concat(sM,"_local_video_aux"),DM="".concat(Yx,"_tooltip"),OM="".concat(lM,"_network_info"),LM="".concat(lM,"_room_info"),NM="".concat(aM,"_controller"),PM="success",xM="warning",MM="failed",UM=0,FM=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.addStyle(),this.addDialog()}addDialog(){var e;let t=document.createElement("template");t.innerHTML='<div id="'.concat(Yx,'" class="').concat(Yx,'"><div class="').concat(Zx,'">Debug#').concat(++UM,'</div><div class="').concat(Jx,'"></div><div class="').concat(Qx,'"><div class="').concat($x,'"><a class="').concat(eM," ").concat(Xx,'" data-tab="log">').concat(ER,'</a><a class="').concat(eM,'" data-tab="network">').concat(bR,'</a><a class="').concat(eM,'" data-tab="dump">').concat(wR,'</a></div><div class="').concat(NM,'"><div data-type="back_top">').concat(OR,'</div><div data-type="go_bottom">').concat(DR,'</div><div data-type="clear_log">').concat(LR,'</div></div><div class="').concat(tM,'"><a class="').concat(iM," ").concat(Xx,'" data-type="all">All</a><a class="').concat(iM,'" data-type="debug">Debug</a><a class="').concat(iM,'" data-type="info">Info</a><a class="').concat(iM,'" data-type="warn">Warn</a><a class="').concat(iM,'" data-type="error">Error</a></div><div class="').concat(rM," ").concat(nM,'"><div class="').concat(aM,'"></div><div class="').concat(oM,'"><div class="').concat(cM,'">').concat(MR,'</div><div class="').concat(lM,'"><div class="').concat(LM,'"></div><div class="').concat(OM,'">').concat(xR,'</div></div><div class="').concat(cM,'">').concat(NR,'</div><div class="').concat(dM,'">').concat(xR,'</div><div class="').concat(cM,'">').concat(PR,'</div><div class="').concat(uM,'">').concat(xR,'</div></div><div class="').concat(sM,'"><div class="').concat(hM,'">').concat(NR,'</div><div class="').concat(pM,'"><div id="').concat(RM,'"><span>').concat(BR," - ").concat(UR,'(s):</span><input type="number" min=0 value=0></input><button class="dump">').concat(IR,'</button><button class="dump-opus">').concat(TR,'</button><button class="end-dump" disabled>').concat(AR,'</button></div><div id="').concat(kM,'"><span>').concat(FR," - ").concat(UR,'(s):</span><input type="number" min=0 value=0></input><button class="dump">').concat(wR,'</button><button class="end-dump" disabled>').concat(AR,'</button></div><div id="').concat(CM,'"><span>').concat(VR," - ").concat(UR,'(s):</span><input type="number" min=0 value=0></input><button class="dump">').concat(wR,'</button><button class="end-dump" disabled>').concat(AR,'</button></div></div><div class="').concat(hM,'">').concat(PR,'</div><div class="').concat(fM,'"><div class="').concat(mM,"\">userId:<input id=\"dump-remote-video-hook-userid\" value='*' />duration:<input id=\"dump-remote-video-hook-duration\" min='1' value='0' type='number' />mediaType:<select id=\"dump-remote-video-hook-mediaType\" value='main' ><option value='main' checked>Video</option><option value='sub'>Screen</option></select><button id=\"dump-remote-video-hook-button\">dump if video is available</button></div></div></div></div><div class=\"").concat(gM,'"></div><div class="').concat(_M,'"><a id="trtc_upload" class="').concat(yM,'">').concat(RR,'</a><a id="trtc_export" class="').concat(yM,'">').concat(kR,'</a><a id="trtc_hide" class="').concat(yM,'">').concat(CR,"</a></div></div></div>"),null==(e=this.shadowRoot)||e.appendChild(t.content.firstChild)}addStyle(){var e;let t=document.createElement("style");t.textContent="#".concat(Yx,"{font-size:14px;--DD-BG-0:#ededed;--DD-BG-1:#f7f7f7;--DD-BG-2:#fff;--DD-BORDER:rgba(0,0,0,0.1);--DD-ERROR:red;--DD-WARN:#fa9d3b;--DD-INFO:#000;--DD-DEBUG:#10aeff;--DD-WARN-BG:#fff3cc;--DD-ERROR-BG:#ffe6e6;}#").concat(Yx," a,.").concat(Zx,"{cursor:pointer;}.").concat(Yx,"{color:black;}.").concat(Zx,"{display:block;position:fixed;right:50px;bottom:").concat(150+50*UM,"px;border-radius:5px;background-color:#07c160;color:#fff;padding:5px 10px;z-index:10000;}.").concat(Jx,"{display:none;position:fixed;left:0;top:0;right:0;bottom:0;z-index:10001;background-color:rgb(0,0,0,0.6);}.").concat(Qx,"{background-color:#ededed;display:none;position:fixed;min-height:85%;left:60%;right:0;bottom:0;z-index:10002;border:1px solid var(--DD-BG-0);}@media (max-width:768px) {.").concat(Qx,"{left:0;}}.").concat($x,"{display:flex;height:2em;border-bottom:1px solid var(--DD-BORDER);}.").concat(eM,"{padding:0 20px;border-right:1px solid rgba(0,0,0,0.1);line-height:2em;color:black;}.").concat(eM,".").concat(Xx,"{background-color:var(--DD-BG-2);}.").concat(eM,".disabled{cursor:not-allowed;background-color:#ededed;color:#999;}.").concat(tM,"{height:2em;display:flex;flex-direction:row;}.").concat(iM,"{width:20%;text-align:center;line-height:2em;border-right:1px solid var(--DD-BORDER);border-bottom:1px solid var(--DD-BORDER);color:black;}.").concat(iM,".").concat(Xx,"{border-bottom:1px solid #1485ee;background-color:var(--DD-BG-2);}.").concat(rM,"{background-color:#fff;position:absolute;left:0;right:0;top:2em;bottom:8em;overflow-y:scroll;overflow-x:hidden;}.").concat(rM,".").concat(nM,"{top:4em;bottom:10em}.").concat(oM,"{display:none;}.").concat(sM,"{display:none;}.").concat(cM,",.").concat(hM,"{line-height:2em;text-align:center;background-color:var(--DD-BG-0);border-bottom:1px solid var(--DD-BORDER);}.").concat(lM,",.").concat(dM,",.").concat(uM,"{text-align:center;border-bottom:1px solid var(--DD-BORDER);}.").concat(pM,",.").concat(fM,"{display:flex;flex-direction:column;padding:0.5em 0;justify-content:center;align-items:center;}.").concat(pM," div input{margin:0 10px;height:1.5em;width:4em;}.").concat(pM," div {padding:10px 0;border-radius:5px;}.").concat(pM," div button,.").concat(fM," div button {cursor:pointer;height:1.8em;border-radius:5px;margin-right:5px;}.").concat(pM," div button[disabled],.").concat(fM," div button[disabled]{cursor:not-allowed;}.").concat(fM," select {height:1.8em;margin:0 10px;}.").concat(fM," div input{margin:0 10px;height:1.5em;width:4em;}.").concat(mM," {line-height:3em;padding:0.5em;}.").concat(cM,"{text-align:center;background-color:var(--DD-BG-0);border-bottom:1px solid var(--DD-BORDER);}.").concat(lM,",.").concat(dM,",.").concat(uM,"{text-align:center;border-bottom:1px solid var(--DD-BORDER);}.").concat(EM,"{border-bottom:1px solid var(--DD-BG-0);padding:5px 10px;overflow-wrap: break-word;}.").concat(TM,"{color:var(--DD-ERROR);background-color:var(--DD-ERROR-BG);}.").concat(IM,"{color:var(--DD-WARN);background-color:var(--DD-WARN-BG);}div .").concat(wM,"{color:var(--DD-INFO);}.").concat(bM,"{color:var(--DD-DEBUG);}.").concat(gM,"{position:absolute;left:0;right:0;bottom:2em;height:6em;border-bottom:1px solid var(--DD-BORDER);display:flex;flex-direction:column;overflow-y:scroll;background-color:var(--DD-BG-1);}.").concat(vM,"{border-bottom:1px solid var(--DD-BORDER);padding:5px 10px;overflow-wrap: break-word;}.").concat(_M,"{position:absolute;line-height:2em;display:flex;flex-direction:row;left:0;right:0;bottom:0;}.").concat(yM,"{flex:1;color:black;text-align:center;background-color:#ededed;border-right:1px solid var(--DD-BORDER);}#").concat(Yx," .").concat(SM,",#").concat(Yx," .").concat(AM,"{position:absolute;height:2em;width:6em;right:2em;border-radius:5px;background-color:rgba(30,136,229,0.8);z-index:10003;cursor:pointer;padding:0 5px;line-height:2em;color:white;text-align:center;}.").concat(AM,"{bottom:9em;}.").concat(SM,"{bottom:11.5em;}#").concat(Yx," .").concat(yM,".disable{cursor:not-allowed;background-color:#ededed;color:#999;}.").concat(DM," {position:relative;display:inline-block;}.").concat(DM," .tooltiptext{visibility:hidden;width:180px;background-color:black;color:#fff;text-align:center;padding:5px 0;border-radius:6px;position:absolute;}.").concat(DM," .tooltip-top {bottom:125%;left:50%;margin-left:-90px;}.").concat(DM,":hover .tooltiptext{visibility:visible;}.").concat(NM,"{position:absolute;left:0;right:0;bottom:8em;height:2em;display:flex;align-items:center;}.").concat(NM," div{flex:1;cursor:pointer;border-right:1px solid var(--DD-BORDER);text-align: center;}"),null==(e=this.shadowRoot)||e.appendChild(t)}};customElements.define("trtc-basic-debug-dialog",FM);var BM=class{constructor(e,t){vA(this,"_dialogNode",null),vA(this,"_switchNode",null),vA(this,"_maskNode",null),vA(this,"_panelNode",null),vA(this,"_logContentNode",null),vA(this,"_networkContentNode",null),vA(this,"_dumpContentNode",null),vA(this,"_tabNodes",[]),vA(this,"_toptabNodes",[]),vA(this,"_hasMove",!1),vA(this,"_showDialog",!1),vA(this,"_isMobile",!1),vA(this,"_showLogType","all"),vA(this,"prevBytesSent",0),vA(this,"prevBytesReceived",0),vA(this,"_core"),vA(this,"_log"),vA(this,"_logList",[]),vA(this,"isUploading",!1),vA(this,"publishMap",new Map),vA(this,"dumpLocalVideoMap",{}),vA(this,"dumpRemoteVideoMap",{}),vA(this,"dumpLocalAudioMap",{}),vA(this,"dumpRemoteAudioMap",{}),vA(this,"eventMap",new Map),vA(this,"switchPos",{x:0,y:0,startX:0,startY:0,endX:0,endY:0,isTouchEnd:!1}),vA(this,"handleLeaveSuccess",e=>{let{room:t}=e;var i,r;if(!this.hitTest(t))return;let n=null==(r=null==(i=this._dialogNode)?void 0:i.shadowRoot)?void 0:r.querySelector(".".concat(fM));for(let a of this.publishMap.values())null==n||n.removeChild(a);this.publishMap.clear()}),vA(this,"handleJoinSuccess",e=>{let{room:t}=e;var i,r;if(!this.hitTest(t))return;(null==(r=null==(i=this._dialogNode)?void 0:i.shadowRoot)?void 0:r.querySelector(".".concat(LM))).innerHTML="sdkAppId: ".concat(t.sdkAppId,"<br/>roomId: ").concat(t.roomId,"<br/>userId: ").concat(t.userId,"<br/>")}),vA(this,"handleRemoteVideoAvailable",e=>{let t="sub"===e.streamType?"auxiliary":"main";this.renderDumpTab(e.userId,"remote",t,"publish")}),vA(this,"handleRemoteVideoUnavailable",e=>{let t="sub"===e.streamType?"auxiliary":"main";this.renderDumpTab(e.userId,"remote",t,"unpublish")}),vA(this,"handleRemoteAudioAvailable",e=>{this.renderDumpTab(e.userId,"remote","audio","publish")}),vA(this,"handleRemoteAudioUnavailable",e=>{this.renderDumpTab(e.userId,"remote","audio","unpublish")}),vA(this,"renderDumpTab",(e,t,i,r)=>{var n,a,o;let s={main:"video",auxiliary:"screen",audio:"audio"},c=(e,t)=>{var i,r,n;let a=document.createElement("div");a.innerText="".concat(e," - ").concat(s[t]," - ").concat(UR,"(s):");let o=document.createElement("input");o.type="number",o.min="0",o.value="10",o.id="dump_remote_".concat(t,"_").concat(e);let c,l=document.createElement("button");l.innerText=AR,l.disabled=!0,"audio"===t&&(c=document.createElement("button"),c.innerText=TR,c.style.marginLeft="5px");let d,u,h=document.createElement("button");if(h.innerText="audio"===t?IR:wR,h.onclick=()=>{let i,r,n=Number(o.value);if("audio"===t)({download:i,onDumpEnd:r}=this.dumpAudio("remote",n,e));else{if(!this.isSupportDumpVideo())return;({download:i,onDumpEnd:r}=this.dumpVideo(t,"remote",n,e))}i&&(this.inactiveButton(h,SR),c&&this.inactiveButton(c),n>0?setTimeout(()=>{null==i||i(),this.activeButton(h,wR),c&&this.activeButton(c,TR)},1e3*n):(this.activeButton(l),l.onclick=()=>{l.onclick=null,null==i||i(),null==r||r(),this.activeButton(h,wR),c&&this.activeButton(c,TR),this.inactiveButton(l)}))},c&&(c.onclick=()=>{let t=Number(o.value),{download:i,onDumpEnd:r}=this.dumpAudioFromPipeline("remote",t,e);i&&(this.inactiveButton(c,SR),this.inactiveButton(h),t>0?setTimeout(()=>{null==i||i(),this.activeButton(c,TR),this.activeButton(h,wR)},1e3*t):(this.activeButton(l),l.onclick=()=>{l.onclick=null,null==i||i(),null==r||r(),this.activeButton(c,TR),this.activeButton(h,wR),this.inactiveButton(l)}))}),"audio"!==t&&(d=document.createElement("button"),d.innerText="Dump w/ Audio",d.style.marginLeft="5px",d.onclick=()=>{if(!this.isSupportDumpVideo())return;let i=Number(o.value),r=this.dumpVideo(t,"remote",i,e),n=this.dumpAudioFromPipeline("remote",i,e);if(!r.download&&!n.download)return;let a=async()=>{var i,a,o,s;let c=new WR.default,l=this.dumpRemoteVideoMap["".concat(e,"-").concat(t)];if(l&&l.data.length>0){let i,r="h264",n=this.getVideoCodec(e);if("vp8"===n){let n=this._core.room.remotePublishedUserMap.get(e),a="main"===t?null==n?void 0:n.remoteVideoTrack:null==n?void 0:n.remoteAuxiliaryTrack;this.addInfoToBanner(xM,"package vp8 into ivf format"),i=this.convertVP8ToIVF(l.data,a),r="ivf"}else i=new Blob(l.data),r=n||"h264";let a="remote-".concat(e,"_").concat(t,"_").concat(this.formatStartDumpTime(l.startTimestamp),".").concat(r);c.file(a,i)}let d=this.dumpRemoteAudioMap["".concat(e)];if(d&&d.data.length>0){let t,r=(null==(a=null==(i=this._core.room.userManager)?void 0:i.getPublishedUser(e))?void 0:a.audioCodec)||"opus",n=r;"opus"===r?(this.addInfoToBanner(xM,"package opus to ogg"),t=this.convertOpusToOgg(d.data),n="ogg"):t=new Blob(d.data);let o="remote-".concat(e,"_audio_").concat(this.formatStartDumpTime(d.startTimestamp),".").concat(n);c.file(o,t)}let u=await c.generateAsync({type:"blob"}),h=URL.createObjectURL(u),p=document.createElement("a");p.href=h,p.download="dump_".concat(e,"_").concat(this.formatStartDumpTime(Date.now()),".zip"),p.style.display="none",document.body.appendChild(p),p.click(),URL.revokeObjectURL(h),document.body.removeChild(p),null==(o=r.onDumpEnd)||o.call(r),null==(s=n.onDumpEnd)||s.call(n),this.addInfoToBanner(PM,"Dump success, file name is: ".concat(p.download))};this.inactiveButton(d,SR),this.inactiveButton(h),i>0?setTimeout(()=>{a(),this.activeButton(d,"Dump w/ Audio"),this.activeButton(h,wR)},1e3*i):(this.activeButton(l),l.onclick=()=>{l.onclick=null,a(),this.activeButton(d,"Dump w/ Audio"),this.activeButton(h,wR),this.inactiveButton(l)})}),"audio"!==t){u=document.createElement("button"),u.innerText="Preview",u.style.whiteSpace="Pre";let i=document.createElement("video");document.body.appendChild(i),i.id="".concat(Yx,"_preview_remote_").concat(t,"_").concat(e),i.style.cssText="\n          width: 320px;\n          height: 240px;\n          display: none;\n          position: absolute;\n          top: 50%;\n          left: 50%;\n          border: 3px solid #cccccc;\n          transform: translate(-50%, -50%);\n          z-index: 10004;\n        ",u.onclick=async()=>{var r;if(i.style.display="none"===i.style.display?"":"none",u&&(u.innerText="none"===i.style.display?"Preview":"  Hide  "),!i.srcObject){let n=this._core.room.remotePublishedUserMap.get(e);if(n){let e=null==(r=n["main"===t?"remoteVideoTrack":"remoteAuxiliaryTrack"])?void 0:r.mediaTrack;e?(i.srcObject=new MediaStream([e]),await i.play()):this.addInfoToBanner(MM,"failed to preview, remote video track is not available")}}}}a.appendChild(o),a.appendChild(h),c&&a.appendChild(c),d&&a.appendChild(d),a.appendChild(l),u&&a.appendChild(u),a.style.cssText="padding:10px;";let p=document.createElement("div");return p.style.cssText="width:100%;display:flex;justify-content:center;border-top: 1px solid var(--DD-BORDER);",p.appendChild(a),null==(n=null==(r=null==(i=this._dialogNode)?void 0:i.shadowRoot)?void 0:r.querySelector(".".concat(fM)))||n.appendChild(p),p};if("remote"===t)if("publish"===r){let r=c(e,i);this.publishMap.set("".concat(e,"-").concat(t,"-").concat(i),r)}else{let r=this.publishMap.get("".concat(e,"-").concat(t,"-").concat(i));if(!r)return;null==(o=null==(a=null==(n=this._dialogNode)?void 0:n.shadowRoot)?void 0:a.querySelector(".".concat(fM)))||o.removeChild(r);let s=document.querySelector("#".concat(Yx,"_preview_remote_").concat(i,"_").concat(e));s&&document.body.removeChild(s),this.publishMap.delete("".concat(e,"-").concat(t,"-").concat(i))}}),vA(this,"handleStatistics",e=>{var t,i,r,n,a,o;let s=(e.bytesSent-this.prevBytesSent)/2,c=(e.bytesReceived-this.prevBytesReceived)/2;this.prevBytesSent=e.bytesSent,this.prevBytesReceived=e.bytesReceived,(null==(i=null==(t=this._dialogNode)?void 0:t.shadowRoot)?void 0:i.querySelector(".".concat(OM))).innerHTML="rtt: ".concat(e.rtt," ms upLoss: ").concat(e.upLoss,"% downLoss: ").concat(e.downLoss,"% <br>\n        ↑ ").concat(s/1e3," KB/s (").concat(8*s/1e3," Kb/s) <br>\n        ↓ ").concat(c/1e3," KB/s (").concat(8*c/1e3," Kb/s) <br>\n      ");let l=null==(n=null==(r=this._dialogNode)?void 0:r.shadowRoot)?void 0:n.querySelector(".".concat(dM)),d="";e.localStatistics.audio.bitrate&&(d="<li>local audio: ".concat(e.localStatistics.audio.bitrate," Kb/s audioLevel: ").concat(e.localStatistics.audio.audioLevel.toFixed(5),"</li>")),e.localStatistics.video.length>0&&(d+="".concat(e.localStatistics.video.map(e=>"<li>local ".concat(e.videoType," video: ").concat(e.bitrate," Kb/s ").concat(e.width,"*").concat(e.height," ").concat(e.frameRate,"fps</li>")).join(""))),l.innerHTML=""===d?"".concat(xR):d;let u=null==(o=null==(a=this._dialogNode)?void 0:a.shadowRoot)?void 0:o.querySelector(".".concat(uM)),h="";e.remoteStatistics.length>0&&e.remoteStatistics.forEach(e=>{let t="remote ".concat(e.userId,":");e.audio.bitrate>0&&(t+="<li>audio: ".concat(e.audio.bitrate," Kb/s audioLevel: ").concat(e.audio.audioLevel.toFixed(5),"</li>")),e.video.length>0&&e.video.forEach(e=>{t+="<li>".concat(e.videoType," video: ").concat(e.bitrate," Kb/s ").concat(e.width,"*").concat(e.height," ").concat(e.frameRate,"fps</li>")}),h+=t}),u.innerHTML=""===h?"".concat(xR):h}),vA(this,"pad",e=>e<10?"0".concat(e):"".concat(e)),this._core=e,this._log=t,this.initCustomElements(),this.synchronizeLog(),this.installEvents(),this.addVideoProcessor(),this.addAudioProcessor(),window["__trtc_instance_".concat(UM,"__")]=this._core.trtc}initCustomElements(){this._isMobile=(()=>{let e=window.navigator&&window.navigator.userAgent||"",t=/iPad/i.test(e)||/iPhone/i.test(e),i=/Android/i.test(e);return t||i})();let e=document.createElement("trtc-basic-debug-dialog");document.body.appendChild(e);let t=e.shadowRoot;if(this._dialogNode=e,!t)return;this._switchNode=t.querySelector(".".concat(Zx)),this._addEventListener(this._switchNode,"click",this.onSwitchClick.bind(this));let i=getComputedStyle(this._switchNode);this.switchPos.x=parseInt(i.right,10)||50,this.switchPos.y=parseInt(i.bottom,10)||100+50*UM,this._isMobile?(this._switchNode.ontouchstart=this.onTouchStart.bind(this),this._switchNode.ontouchend=this.onTouchEnd.bind(this),this._switchNode.ontouchmove=this.onTouchMove.bind(this)):this._switchNode.onmousedown=this.onMouseDown.bind(this),this._maskNode=t.querySelector(".".concat(Jx)),this._addEventListener(this._maskNode,"click",this.onMaskClick.bind(this)),this._panelNode=t.querySelector(".".concat(Qx)),t.querySelector(".".concat(NM)).childNodes.forEach(e=>{switch(e.getAttribute("data-type")){case"go_bottom":this._addEventListener(e,"click",this.onGoBottomClick.bind(this));break;case"back_top":this._addEventListener(e,"click",this.onBackTopClick.bind(this));break;case"clear_log":this._addEventListener(e,"click",this.onClearLogClick.bind(this))}}),this._logContentNode=t.querySelector(".".concat(aM)),this._networkContentNode=t.querySelector(".".concat(oM)),this._dumpContentNode=t.querySelector(".".concat(sM)),this._tabNodes=Array.from(t.querySelector(".".concat($x)).children),this._tabNodes.forEach(e=>{this._addEventListener(e,"click",this.onTabClick.bind(this))}),this._toptabNodes=Array.from(t.querySelector(".".concat(tM)).children),this._toptabNodes.forEach(e=>{this._addEventListener(e,"click",this.onToptabClick.bind(this))});let r=t.querySelector("#trtc_upload");this._addEventListener(r,"click",this.onUploadClick.bind(this));let n=t.querySelector("#trtc_export");this._addEventListener(n,"click",this.onExportClick.bind(this));let a=t.querySelector("#trtc_hide");this._addEventListener(a,"click",this.onHideClick.bind(this));let o=t.querySelector("#".concat(kM," .dump")),s=t.querySelector("#".concat(kM," .end-dump")),c=Number(t.querySelector("#".concat(kM," input")).value);this._addEventListener(o,"click",this.getDumpButtonClickHandler.bind(this,o,s,c,"main","local"));let l=t.querySelector("#".concat(CM," .dump")),d=t.querySelector("#".concat(CM," .end-dump")),u=Number(t.querySelector("#".concat(CM," input")).value);this._addEventListener(l,"click",this.getDumpButtonClickHandler.bind(this,l,d,u,"auxiliary","local"));let h=t.querySelector("#".concat(RM," .dump")),p=t.querySelector("#".concat(RM," .dump-opus")),f=t.querySelector("#".concat(RM," .end-dump"));this._addEventListener(h,"click",()=>{let e=Number(t.querySelector("#".concat(RM," input")).value),{download:i,onDumpEnd:r}=this.dumpAudio("local",e);i?(this.inactiveButton(h,SR),this.inactiveButton(p),e>0?setTimeout(()=>{i(),this.activeButton(h,IR),this.activeButton(p,TR)},1e3*e):(this.activeButton(f),f.onclick=()=>{f.onclick=null,i(),null==r||r(),this.activeButton(h,IR),this.activeButton(p,TR),this.inactiveButton(f)})):this.addInfoToBanner(MM,"Failed to dump, please check if the current user has started the audio")}),this._addEventListener(p,"click",()=>{let e=Number(t.querySelector("#".concat(RM," input")).value),{download:i,onDumpEnd:r}=this.dumpAudioFromPipeline("local",e);i?(this.inactiveButton(p,SR),this.inactiveButton(h),e>0?setTimeout(()=>{i(),this.activeButton(p,TR),this.activeButton(h,IR)},1e3*e):(this.activeButton(f),f.onclick=()=>{f.onclick=null,i(),null==r||r(),this.activeButton(p,TR),this.activeButton(h,IR),this.inactiveButton(f)})):this.addInfoToBanner(MM,"Failed to dump opus, please check if the current user has started the audio")});let m=t.querySelector("#dump-remote-video-hook-userid"),g=t.querySelector("#dump-remote-video-hook-duration"),v=t.querySelector("#dump-remote-video-hook-mediaType"),_=t.querySelector("#dump-remote-video-hook-button");_.onclick=()=>{let e=Number(g.value);if(e<1)return void this.addInfoToBanner(MM,"duration at least 1s");let t=m.value;if(!t)return void this.addInfoToBanner(MM,"please input user id");"*"===t&&this.inactiveButton(_);let i,r,n=v.value,a="remote_".concat(t,"_").concat("sub"===n?"auxiliary":n),o=a=>{if((a.userId===t||"*"===t)&&a.streamType===n){if(this.addInfoToBanner(PM,"[".concat(a.userId,"_").concat(n,"] starting to dump video, duration: ").concat(e,"s")),({download:i,onDumpEnd:r}=this.dumpVideo("sub"===a.streamType?"auxiliary":a.streamType,"remote",e,a.userId)),!i)return;setTimeout(()=>{null==i||i(),null==r||r(),"*"!==t&&this._core.trtc.off(this._core.TRTC.EVENT.REMOTE_VIDEO_AVAILABLE,o)},1e3*e)}};this._core.trtc.on(this._core.TRTC.EVENT.REMOTE_VIDEO_AVAILABLE,o),this.addInfoToBanner(PM,"[".concat(a,"] waiting to dump video from ").concat("*"===t?"all remote users":"user ".concat(t),", duration: ").concat(e,"s"))}}synchronizeLog(){this._core.loggerManager.getQueue().forEach(e=>{this.updateLog(e)})}isSupportDumpVideo(){return!(!this._core.rtcDectection.IS_INSERTABLE_STREAM_SUPPORTED&&!this._core.rtcDectection.IS_SCRIPT_TRANSFORM_SUPPORTED)||(this.addInfoToBanner(MM,"Current browser does not support dumping video"),!1)}_addEventListener(e,t,i,r){e&&(e.addEventListener(t,i,r),this.eventMap.set(e,{type:t,listener:i}))}_removeEventListener(){this.eventMap.forEach((e,t)=>{let{type:i,listener:r}=e;t&&t.removeEventListener(i,r)}),this.eventMap.clear(),this._switchNode&&(this._switchNode.onmousedown=null,this._switchNode.ontouchmove=null,this._switchNode.ontouchstart=null,this._switchNode.ontouchend=null)}closeDialog(){this.uninstallEvents(),this._removeEventListener(),this.removeVideoProcessor(),this.removeAudioProcessor(),this._dialogNode&&(document.body.removeChild(this._dialogNode),this._dialogNode=null)}updateLog(e){var t;this._logList.push(e);let i=document.createElement("div");switch(i.classList.add(EM),e.level){case 4:i.classList.add(TM);break;case 2:i.classList.add(wM);break;case 3:i.classList.add(IM);break;case 1:i.classList.add(bM)}i.textContent=e.log,"all"!==this._showLogType&&!i.classList.contains("".concat(EM,"_").concat(this._showLogType))&&(i.style.display="none"),null==(t=this._logContentNode)||t.appendChild(i),this.addHelper(i)}getDumpButtonClickHandler(e,t,i,r,n){if(!this.isSupportDumpVideo())return;let{download:a,onDumpEnd:o}=this.dumpVideo(r,n,i);if(a)return this.addInfoToBanner(PM,"[".concat(n,"_").concat(r,"] starting to dump...")),this.inactiveButton(e,SR),void(i>0?setTimeout(()=>{a(),this.activeButton(e,wR)},1e3*i):(this.activeButton(t),t.onclick=()=>{t.onclick=null,null==o||o(),a(),this.activeButton(e,wR),this.inactiveButton(t)}));this.addInfoToBanner(PM,"[".concat(n,"_").concat(r,"] waiting to dump..."));let s=a=>{let{track:o}=a;if(o.room===this._core.room&&o.streamType===r){this.addInfoToBanner(PM,"[".concat(n,"_").concat(r,"] starting to dump")),"local"===n&&this._core.innerEmitter.off("104",s);let{download:a,onDumpEnd:o}=this.dumpVideo(r,n,i);if(!a)return;i>0?setTimeout(()=>{a(),this.activeButton(e,wR)},1e3*i):(this.activeButton(t),t.onclick=()=>{t.onclick=null,null==o||o(),a(),this.activeButton(e,wR),this.inactiveButton(t)})}};s.bind(this),"local"===n&&this._core.innerEmitter.on("104",s),this.inactiveButton(e,SR)}onSwitchClick(){this._hasMove?this._hasMove=!1:this._showDialog?this.hideDialog():(this._isMobile&&(this._maskNode.style.display="block"),this._panelNode.style.display="block",this._switchNode.style.display="none",this._showDialog=!0,this.logContentGoBottom())}onTabClick(e){var t,i,r,n,a,o,s;let c=e.target;null==(t=this._tabNodes)||t.forEach(e=>{e.classList.remove(Xx)}),c.classList.add(Xx);let l=c.getAttribute("data-tab");"log"===l?(null==(n=null==(r=null==(i=this._dialogNode)?void 0:i.shadowRoot)?void 0:r.querySelector(".".concat(rM)))||n.classList.add(nM),this._logContentNode.style.display="block",this._networkContentNode.style.display="none",this._dumpContentNode.style.display="none",this.logContentGoBottom()):(null==(s=null==(o=null==(a=this._dialogNode)?void 0:a.shadowRoot)?void 0:o.querySelector(".".concat(rM)))||s.classList.remove(nM),"network"===l?(this._networkContentNode.style.display="block",this._logContentNode.style.display="none",this._dumpContentNode.style.display="none"):"dump"===l&&(this._dumpContentNode.style.display="block",this._networkContentNode.style.display="none",this._logContentNode.style.display="none"))}onToptabClick(e){var t,i;let r=e.target;null==(t=this._toptabNodes)||t.forEach(e=>{e.classList.remove(Xx)}),r.classList.add(Xx),this._showLogType=r.getAttribute("data-type");let n=null==(i=this._logContentNode)?void 0:i.querySelectorAll(".".concat(EM)),a="".concat(EM,"_").concat(this._showLogType);n.forEach(e=>{e.classList.contains(a)||"all"===this._showLogType?e.style.display="block":e.style.display="none"}),this.logContentGoBottom()}onExportClick(){let e=this._logList.reduce((e,t)=>"".concat(e+t.log,"\n"),""),t=new Blob([e],{type:"text/plain"}),i=document.createElement("a"),r=URL.createObjectURL(t);i.href=r;let n="trtc_".concat(void 0===this._core.room.sdkAppId?"EmptySdkAppId":this._core.room.sdkAppId,"_").concat(void 0===this._core.room.userId?"EmptyUserId":this._core.room.userId,"_").concat(this.formatStartDumpTime(+new Date),".log");i.download=n,i.style.display="none",document.body.appendChild(i),i.click(),URL.revokeObjectURL(r),document.body.removeChild(i),this.addInfoToBanner(PM,"Export success: The log file name is ".concat(n)),this._core.kvStatManager.addSuccessEvent({key:592703})}addInfoToBanner(e,t){var i,r;let n=null==(r=null==(i=this._dialogNode)?void 0:i.shadowRoot)?void 0:r.querySelector(".".concat(gM)),a=document.createElement("div");a.classList.add(vM);let o=e===PM?"🟩":e===xM?"🟧":"🟥";a.innerText="".concat(o," [").concat(this.getCurrentTime(),"] ").concat(t),n.appendChild(a),n.scrollTop=n.scrollHeight}async onUploadClick(){var e,t;if(this.isUploading)return;this.isUploading=!0;let i=null==(t=null==(e=this._dialogNode)?void 0:e.shadowRoot)?void 0:t.querySelector("#trtc_upload");i.innerText="Uploading...",null==i||i.classList.add(".disable");let r=this._logList.reduce((e,t)=>"".concat(e+t.log,"\n"),""),n=new Blob([r],{type:"text/plain"}),a=new FormData;a.append("file",n,"trtc.log"),a.append("sdkAppId","".concat(this._core.room.sdkAppId||"EmptySdkAppId")),a.append("userId","".concat(this._core.room.userId||"EmptyUserId")),fetch("https://service.trtc.qcloud.com/api/uploadLogFile",{method:"POST",body:a}).then(e=>e.json()).then(e=>{this.addInfoToBanner(e.type,e.message_en||"Upload Failed: Please use local export"),this.isUploading=!1,this._log.info(e.message_en),this._core.kvStatManager.addSuccessEvent({key:592704})}).catch(()=>{this.addInfoToBanner(MM,"Upload Failed: Please use local export"),this._log.info("Upload Failed: Please use local export"),this._core.kvStatManager.addFailedEvent({key:592704})}).finally(()=>{i.innerText=RR,null==i||i.classList.remove(".disable"),this.isUploading=!1})}onHideClick(){this.hideDialog()}onMaskClick(){this.hideDialog()}hideDialog(){this._isMobile&&(this._maskNode.style.display="none"),this._panelNode.style.display="none",this._switchNode.style.display="block",this._showDialog=!1}onBackTopClick(){var e,t,i;null==(i=null==(t=null==(e=this._dialogNode)?void 0:e.shadowRoot)?void 0:t.querySelector(".".concat(rM)))||i.scrollTo(0,0)}onGoBottomClick(){this.logContentGoBottom()}onClearLogClick(){this._logList=[],this._logContentNode&&(this._logContentNode.innerHTML="")}logContentGoBottom(){var e,t;let i=null==(t=null==(e=this._dialogNode)?void 0:e.shadowRoot)?void 0:t.querySelector(".".concat(rM));null==i||i.scrollTo(0,null==i?void 0:i.scrollHeight)}onMouseDown(e){e.preventDefault(),this.switchPos.startX=e.pageX,this.switchPos.startY=e.pageY,document.onmousemove=this.onMouseMove.bind(this),document.onmouseup=this.onMouseUp.bind(this)}onMouseMove(e){e.cancelable&&e.preventDefault(),this._hasMove=!0;let t=this.switchPos.x-(e.pageX-this.switchPos.startX),i=this.switchPos.y-(e.pageY-this.switchPos.startY);[t,i]=this.getSafeAreaXY(t,i),this._switchNode.style.right="".concat(t,"px"),this._switchNode.style.bottom="".concat(i,"px"),this.switchPos.endX=t,this.switchPos.endY=i}onMouseUp(){this.switchPos.startX=0,this.switchPos.startY=0,this.switchPos.x=this.switchPos.endX,this.switchPos.y=this.switchPos.endY,document.onmousemove=null,document.onmouseup=null}onTouchStart(e){this.switchPos.startX=e.touches[0].pageX,this.switchPos.startY=e.touches[0].pageY,this.switchPos.isTouchEnd=!1}onTouchEnd(){this.switchPos.isTouchEnd&&(this.switchPos.startX=0,this.switchPos.startY=0,this.switchPos.isTouchEnd=!1,this.switchPos.x=this.switchPos.endX,this.switchPos.y=this.switchPos.endY)}onTouchMove(e){if(e.touches.length<=0)return;let t=e.touches[0].pageX-this.switchPos.startX,i=e.touches[0].pageY-this.switchPos.startY,r=Math.floor(this.switchPos.x-t),n=Math.floor(this.switchPos.y-i);[r,n]=this.getSafeAreaXY(r,n),this._switchNode.style.right="".concat(r,"px"),this._switchNode.style.bottom="".concat(n,"px"),this.switchPos.endX=r,this.switchPos.endY=n,this.switchPos.isTouchEnd=!0,e.cancelable&&e.preventDefault()}getSafeAreaXY(e,t){let i=Math.max(document.documentElement.offsetWidth,window.innerWidth),r=Math.max(document.documentElement.offsetHeight,window.innerHeight);return e+this._switchNode.offsetWidth>i&&(e=i-this._switchNode.offsetWidth),t+this._switchNode.offsetHeight>r&&(t=r-this._switchNode.offsetHeight),e<0&&(e=0),t<20&&(t=20),[e,t]}hitTest(e){return e===this._core.room}installEvents(){this._core.innerEmitter.on("264",this.handleLog,this),this._core.innerEmitter.on("53",this.handleLeaveSuccess,this),this._core.innerEmitter.on("27",this.handleJoinSuccess,this),this._core.trtc.on(this._core.TRTC.EVENT.STATISTICS,this.handleStatistics,this),this._core.trtc.on(this._core.TRTC.EVENT.REMOTE_AUDIO_AVAILABLE,this.handleRemoteAudioAvailable),this._core.trtc.on(this._core.TRTC.EVENT.REMOTE_AUDIO_UNAVAILABLE,this.handleRemoteAudioUnavailable),this._core.trtc.on(this._core.TRTC.EVENT.REMOTE_VIDEO_AVAILABLE,this.handleRemoteVideoAvailable),this._core.trtc.on(this._core.TRTC.EVENT.REMOTE_VIDEO_UNAVAILABLE,this.handleRemoteVideoUnavailable),this._core.room.on("dump",this.handleDumpFromScriptTransform,this)}uninstallEvents(){this._core.innerEmitter.off("264",this.handleLog,this),this._core.innerEmitter.off("53",this.handleLeaveSuccess,this),this._core.innerEmitter.off("27",this.handleJoinSuccess,this),this._core.trtc.off(this._core.TRTC.EVENT.STATISTICS,this.handleStatistics,this),this._core.trtc.off(this._core.TRTC.EVENT.REMOTE_AUDIO_AVAILABLE,this.handleRemoteAudioAvailable),this._core.trtc.off(this._core.TRTC.EVENT.REMOTE_AUDIO_UNAVAILABLE,this.handleRemoteAudioUnavailable),this._core.trtc.off(this._core.TRTC.EVENT.REMOTE_VIDEO_AVAILABLE,this.handleRemoteVideoAvailable),this._core.trtc.off(this._core.TRTC.EVENT.REMOTE_VIDEO_UNAVAILABLE,this.handleRemoteVideoUnavailable),this._core.room.off("dump",this.handleDumpFromScriptTransform,this)}handleDumpFromScriptTransform(e){if(!e.isAudio)if(e.userId){let t=this.dumpRemoteVideoMap["".concat(e.userId,"-").concat(e.streamType)];t&&(t.data.push(e.data),t.duration>0&&Date.now()-t.startTimestamp>1e3*t.duration&&t.onDumpEnd())}else{let t="main"===e.streamType?"main":"sub",i=this.dumpLocalVideoMap[t];i&&(i.data.push(e.data),i.duration>0&&Date.now()-i.startTimestamp>1e3*i.duration&&i.onDumpEnd())}}inactiveButton(e,t){e.disabled=!0,t&&(e.innerText=t)}activeButton(e,t){e.disabled=!1,t&&(e.innerText=t)}handleLog(e){this.updateLog(e.log)}addHelper(e){let t=/((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}/g,i=zR,r=e.innerText;r=r.split("\n").map(e=>{if((e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")).includes("failed"))return e.includes("on autoplay-failed")?e:"<span class='red' style=\"background:red; color:#fff;\">".concat(e,"</span>");if(e.includes("clientIp:")){let i=e.match(t);return null==i||i.forEach(t=>{e=e.replace(t,'<a href="javascript:void(0);" target=""><span class=\'ip\' style="background:#e1dfdf">'.concat(t,"</span></a>"))}),e}return e.includes("URL of current page")&&(e=e.replace(/URL of current page: (.+)/,'URL of current page: <a href="$1">$1</a>')),e}).join("\n"),i.forEach(t=>{if(e.innerText.includes(t)){let i="";i="function"==typeof HR[t].tips?HR[t].tips(e.innerText):HR[t].tips,r=r.replace(new RegExp("".concat((e=>e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d").replace(">","&gt;").replace(">","&lt;"))(t)),"gi"),'<span class="'.concat(DM,'" style="background:').concat(HR[t].color||"#e1dfdf","; color: ").concat(HR[t].textColor||"#000",'">').concat(t,'\n            <span class="tooltiptext tooltip-top">').concat(i,"</span>\n          </span>"))}}),e.innerHTML=r}getCurrentTime(){let e=new Date,t=this.pad(e.getHours()),i=this.pad(e.getMinutes()),r=this.pad(e.getSeconds());return"".concat(t,":").concat(i,":").concat(r)}dumpAudioFromPipeline(e,t,i){this.addInfoToBanner(xM,"dump audio from pipeline");let r=Date.now(),n=this.formatStartDumpTime(r),a=[],o="".concat(e,"_").concat(i);if("local"===e)this._core.trtc._localAudioTrack;else if(i){let e=this._core.room.remotePublishedUserMap.get(i);e&&e.remoteAudioTrack}let s;if("local"===e){if(!this.hasLocalTrack("main","audio"))return{};s=()=>{delete this.dumpLocalAudioMap.main},this.dumpLocalAudioMap.main={startTimestamp:r,data:a,duration:t,onDumpEnd:s}}if("remote"===e&&i){if(s=()=>{delete this.dumpRemoteAudioMap["".concat(i)]},this.dumpRemoteAudioMap["".concat(i)])return this.addInfoToBanner(xM,"[".concat(o,"] dump already exists.")),{};this.dumpRemoteAudioMap["".concat(i)]={startTimestamp:r,data:a,duration:t,onDumpEnd:s}}return{download:()=>{var t,r;if(0===a.length)return void this.addInfoToBanner(MM,"[".concat(o,"] dump failed. Reason: data is empty"));let s,c=("local"===e?null==(t=this._core.room.singlePC)?void 0:t.audioCodec:null==(r=this._core.room.userManager)?void 0:r.getPublishedUser(i).audioCodec)||"opus",l=c;"opus"===c?(this.addInfoToBanner(xM,"[".concat(o,"] package opus to ogg")),s=this.convertOpusToOgg(a),l="ogg"):s=new Blob(a);let d=URL.createObjectURL(s),u=document.createElement("a"),h="local"===e?"local_".concat(n,".").concat(l):"remote-".concat(i,"_").concat(n,".").concat(l);u.href=d,u.download=h,u.style.display="none",document.body.appendChild(u),u.click(),URL.revokeObjectURL(d),u.remove(),this.addInfoToBanner(PM,"[".concat(o,"] dump success. File name is: ").concat(h))},onDumpEnd:s}}dumpVideo(e,t,i,r){let n,a=Date.now(),o=this.formatStartDumpTime(a),s=[],c="".concat(t,"_").concat(r,"_").concat(e);if("local"===t)n="main"===e?this._core.trtc._localVideoTrack:this._core.trtc._localScreenTrack;else if(r){let t=this._core.room.remotePublishedUserMap.get(r);t&&(n="main"===e?t.remoteVideoTrack:t.remoteAuxiliaryTrack)}let l;if("local"===t){if(!this.hasLocalTrack(e,"video"))return{};l=()=>{delete this.dumpLocalVideoMap["auxiliary"===e?"sub":"main"]},this.dumpLocalVideoMap["auxiliary"===e?"sub":"main"]={startTimestamp:a,data:s,duration:i,onDumpEnd:l}}if("remote"===t&&r){if(l=()=>{delete this.dumpRemoteVideoMap["".concat(r,"-").concat(e)]},this.dumpRemoteVideoMap["".concat(r,"-").concat(e)])return this.addInfoToBanner(xM,"[".concat(c,"] dump already exists.")),{};this.dumpRemoteVideoMap["".concat(r,"-").concat(e)]={startTimestamp:a,data:s,duration:i,onDumpEnd:l}}return{download:()=>{var i,a;if(0===s.length)return void this.addInfoToBanner(MM,"[".concat(c,"] dump failed. Reason: data is empty"));let l,d;"main"===e?l="video":"auxiliary"===e&&(l="screen"),"vp8"===this.getVideoCodec(r||"")?(this.addInfoToBanner(xM,"[".concat(c,"] package vp8 into ivf format")),d=this.convertVP8ToIVF(s,n)):d=new Blob(s);let u=URL.createObjectURL(d),h=document.createElement("a"),p="local"===t?"local_".concat(l,"_").concat(o,".").concat((null==(i=this._core.room.singlePC)?void 0:i.videoCodec)||"h264"):"remote-".concat(r,"_").concat(l,"_").concat(o,".").concat((null==(a=this._core.room.userManager)?void 0:a.getPublishedUser(r).videoCodec)||"h264");h.href=u,h.download=p,h.style.display="none",document.body.appendChild(h),h.click(),URL.revokeObjectURL(u),h.remove(),this.addInfoToBanner(PM,"[".concat(c,"] dump success. File name is: ").concat(p))},onDumpEnd:l}}convertVP8ToIVF(e,t){var i,r,n;function a(e,t,i){for(let r=0;r<i.length;r++)e.setUint8(t+r,i.charCodeAt(r))}let o=e.reduce((e,t)=>e+12+t.byteLength,32),s=new ArrayBuffer(o),c=new DataView(s),l=new Uint8Array(s),d=0;a(c,d,"DKIF"),d+=4,c.setUint16(d,0,!0),d+=2,c.setUint16(d,32,!0),d+=2,a(c,d,"VP80"),d+=4,c.setUint16(d,(null==(i=null==t?void 0:t._inputTrack)?void 0:i.getSettings().width)||0,!0),d+=2,c.setUint16(d,(null==(r=null==t?void 0:t._inputTrack)?void 0:r.getSettings().height)||0,!0),d+=2;let u=(t instanceof Gx?null==t?void 0:t.decodeFPS:null==(n=null==t?void 0:t.mediaTrack)?void 0:n.getSettings().frameRate)||15;return c.setUint32(d,u,!0),d+=4,c.setUint32(d,1,!0),d+=4,c.setUint32(d,e.length,!0),d+=4,c.setUint32(d,0,!0),d+=4,e.forEach((e,t)=>{let i=e.byteLength,r=Math.floor(1e6*t/u);c.setUint32(d,i,!0),d+=4,c.setFloat64(d,r,!0),d+=8,l.set(new Uint8Array(e),d),d+=i}),new Blob([s],{type:"application/octet-stream"})}getVideoCodec(e){var t,i;return""===e?null==(t=this._core.room.singlePC)?void 0:t.videoCodec:null==(i=this._core.room.remotePublishedUserMap.get(e))?void 0:i.videoCodec}hasLocalTrack(e,t){for(let i of this._core.room.localTracks)if(i.streamType===e&&i.kind===t)return!0;return!1}dumpAudio(e,t,i){var r,n,a;let o,s,c=null,l=[],d=[],u=[],h=[],p=[],f=[],m=[],g=new AbortController,v=Date.now(),_=this.formatStartDumpTime(v),y=this._core.room.audioManager._localAudioPipline,E=this._core.room.audioManager._localScreenAudioPipeline,b=e=>{let{room:t,data:i,type:r}=e;if(this.hitTest(t)){if("dump"===r){if(h[0]=h[0]?h[0].concat(i.captureInput):i.captureInput,h[1]=h[1]?h[1].concat(i.playInput):i.playInput,o){let e=i.startTime-o,t=i.endTime-i.startTime;if(e>30||t>30){let r=function(e){if("number"!=typeof e||e<0)return"0毫秒";let t=[],i=Math.floor(e/6e4),r=e%6e4;i>0&&t.push("".concat(i,"分"));let n=Math.floor(r/1e3);return r%=1e3,(n>0||t.length)&&t.push("".concat(n,"秒")),(r>0||!t.length)&&t.push("".concat(r,"毫秒")),t.join("")},n=i.startTime-s,a=o-s;m.push("".concat(i.startTime,"\t").concat(r(n),"~").concat(r(a),"\t").concat(e,"\t").concat(t))}o=i.startTime}else o=i.startTime,s=i.startTime;f.push(i.startTime)}"dump-screen-audio"===r&&(p[0]=p[0]?p[0].concat(i.captureInput):i.captureInput,p[1]=p[1]?p[1].concat(i.playInput):i.playInput)}};if("local"===e){let{sampleRate:e}=this._core.room.audioManager.audioContext;if(!this._core.room.audioManager.hasAudioTrack&&!this._core.room.audioManager.hasScreenAudioTrack)return{};if(null!=y&&y.source.node&&(l.push(y.source.node),d.push("local_audio_raw_capture-".concat(e,"-").concat(y.source.node.channelCount))),(null!=(r=null==y?void 0:y.aec)&&r.node||null!=E&&E.aec.node)&&(this._core.trtc.updatePlugin("AudioProcessor",{enableDump:!0}),this._core.innerEmitter.on("265",b),null!=(n=null==y?void 0:y.aec)&&n.node&&(l.push(y.aec.node),d.push("local_audio_audioProcessor_processed-".concat(e,"-").concat(y.aec.node.channelCount))),null!=E&&E.aec.node&&(l.push(E.aec.node),d.push("screen_audio_audioProcessor_processed-".concat(e,"-").concat(E.aec.node.channelCount)))),null!=y&&y.denoiser.node&&(l.push(y.denoiser.node),d.push("local_audio_denoiser_processed-".concat(e,"-").concat(y.denoiser.node.channelCount))),this._core.room.audioManager.mixWeight>1&&null!=y&&y.stream){let t=this._core.room.audioManager.audioContext.createMediaStreamSource(y.stream);t.channelCount=1,l.push(t),d.push("local_audio_destination-".concat(e,"-").concat(t.channelCount))}}else if("remote"===e&&void 0!==i){let e=null==(a=this._core.room.remotePublishedUserMap.get(i))?void 0:a.remoteAudioTrack;if(null==e||!e.mediaTrack)return{};let t=this._core.createAudioNode(e.mediaTrack);l.push(t),d.push("remote_".concat(i))}let w=async()=>{var t,i,r,n,a;let o=new WR.default;for(let e=0;e<d.length;e++)o.file("".concat(d[e],".pcm"),new Blob(u[e]));if(null!=(t=null==h?void 0:h[0])&&t.length&&o.file("audioProcessor_input_capture.pcm",new Blob(h[0])),null!=(i=null==h?void 0:h[1])&&i.length&&o.file("audioProcessor_input_playback.pcm",new Blob(h[1])),null!=(r=null==p?void 0:p[0])&&r.length&&o.file("audioProcessor_screen_audio_input_capture.pcm",new Blob(p[0])),null!=(n=null==p?void 0:p[1])&&n.length&&o.file("audioProcessor_screen_audio_input_playback.pcm",new Blob(p[1])),null!=f&&f.length){let e=f.reduce((e,t)=>"".concat(e,"\n").concat(t));o.file("audioProcessor_handle_timestamp.txt",new Blob([e]))}if(null!=m&&m.length){let e=m.reduce((e,t)=>"".concat(e,"\n").concat(t));o.file("audioProcessor_big_gap_data.txt",new Blob([e]))}let s=await o.generateAsync({type:"blob"}),l=URL.createObjectURL(s),v=document.createElement("a");v.href=l,v.download="".concat(e,"-audio-").concat(_,".zip"),v.style.display="none",document.body.appendChild(v),v.click(),URL.revokeObjectURL(l),v.remove(),this.addInfoToBanner(PM,"Dump success, file name is: ".concat(e,"-").concat(_,".zip")),this._core.innerEmitter.off("265",b),(null!=(a=null==y?void 0:y.aec)&&a.node||null!=E&&E.aec.node)&&this._core.trtc.updatePlugin("AudioProcessor",{enableDump:!1}),c&&clearTimeout(c),g.abort("download")};return t>0&&(c=Number(setTimeout(()=>{g.abort("timeout")},1e3*t))),l.length>0&&this._core.startGetPCM(l).then(e=>e.pipeTo(new WritableStream({write(e){e.forEach((e,t)=>{u[t]=u[t]?u[t].concat(e[0]):[e[0]]})}}),g).catch(()=>w)),{download:w,onDumpEnd:()=>{g.abort("timeout")}}}formatStartDumpTime(e){let t=new Date(e),i=t.getFullYear(),r=this.pad(t.getMonth()+1),n=this.pad(t.getDate()),a=this.pad(t.getHours()),o=this.pad(t.getMinutes()),s=this.pad(t.getSeconds()),c=-t.getTimezoneOffset(),l=Math.floor(Math.abs(c)/60),d=Math.abs(c)%60,u=c>=0?"+":"-";return"".concat(i,"-").concat(r,"-").concat(n,"T").concat(a,"-").concat(o,"-").concat(s).concat(u).concat(this.pad(l),"-").concat(this.pad(d))}convertOpusToOgg(e){let t=Math.floor(4294967295*Math.random()),i=0,r=0,n=[],a=this.createOpusHead(48e3,2);n.push(this.createOggPage(2,0,t,i++,[a]));let o=this.createOpusTags();n.push(this.createOggPage(0,0,t,i++,[o]));let s=[],c=0;return e.forEach((a,o)=>{let l=this.getOpusPacketDuration(a);s.push(a),c+=a.byteLength,r+=l;let d=o===e.length-1;if(c>6e4||s.length>=50||d){let e=d?4:0;n.push(this.createOggPage(e,r,t,i++,s)),s=[],c=0}}),new Blob(n,{type:"audio/ogg"})}createOpusHead(e,t){let i=new ArrayBuffer(19),r=new DataView(i);return this.writeString(r,0,"OpusHead"),r.setUint8(8,1),r.setUint8(9,t),r.setUint16(10,0,!0),r.setUint32(12,e,!0),r.setUint16(16,0,!0),r.setUint8(18,0),i}createOpusTags(){let e="TRTC Debugger",t=new ArrayBuffer(29),i=new DataView(t);return this.writeString(i,0,"OpusTags"),i.setUint32(8,13,!0),this.writeString(i,12,e),i.setUint32(25,0,!0),t}createOggPage(e,t,i,r,n){let a=0;n.forEach(e=>{let t=e.byteLength;for(;t>=255;)a++,t-=255;a++});let o=27+a,s=n.reduce((e,t)=>e+t.byteLength,0),c=new ArrayBuffer(o+s),l=new DataView(c),d=new Uint8Array(c);this.writeString(l,0,"OggS"),l.setUint8(4,0),l.setUint8(5,e),l.setUint32(6,4294967295&t,!0),l.setUint32(10,Math.floor(t/4294967295),!0),l.setUint32(14,i,!0),l.setUint32(18,r,!0),l.setUint32(22,0,!0),l.setUint8(26,a);let u=27;n.forEach(e=>{let t=e.byteLength;for(;t>=255;)d[u++]=255,t-=255;d[u++]=t});let h=o;n.forEach(e=>{d.set(new Uint8Array(e),h),h+=e.byteLength});let p=this.crc32(d);return l.setUint32(22,p,!0),d}writeString(e,t,i){for(let r=0;r<i.length;r++)e.setUint8(t+r,i.charCodeAt(r))}getOpusPacketDuration(e){if(0===e.byteLength)return 0;let t=new Uint8Array(e),i=t[0],r=i>>3&31,n=3&i,a=1;if(1===n||2===n)a=2;else if(3===n){if(e.byteLength<2)return 0;a=63&t[1]}return([480,480,480,480,960,960,960,960,1920,1920,1920,1920,2880,2880,480,480,120,120,120,120,240,240,240,240,480,480,480,480,960,960,960,960][r]||960)*a}crc32(e){let t=new Uint32Array(256);for(let r=0;r<256;r++){let e=r<<24;for(let t=0;t<8;t++)2147483648&e?e=e<<1^79764919:e<<=1;t[r]=e>>>0}let i=0;for(let r=0;r<e.length;r++){i=(i<<8^t[255&(i>>>24^e[r])])>>>0}return i}addVideoProcessor(){this._core.room.videoManager.addEncodeProcessor({processor:this._core.rtcDectection.IS_INSERTABLE_STREAM_SUPPORTED?this.encodeVideo.bind(this):gR,type:1}),this._core.room.videoManager.addDecodeProcessor({processor:this._core.rtcDectection.IS_INSERTABLE_STREAM_SUPPORTED?this.decodeVideo.bind(this):vR,type:1})}removeVideoProcessor(){this._core.room.videoManager.removeEncodeProcessor({type:1}),this._core.room.videoManager.removeDecodeProcessor({type:1})}addAudioProcessor(){this._core.room.audioManager.addEncodeProcessor({processor:this._core.rtcDectection.IS_INSERTABLE_STREAM_SUPPORTED?this.encodeAudio.bind(this):_R,type:2}),this._core.room.audioManager.addDecodeProcessor({processor:this._core.rtcDectection.IS_INSERTABLE_STREAM_SUPPORTED?this.decodeAudio.bind(this):yR,type:2})}removeAudioProcessor(){this._core.room.audioManager.removeEncodeProcessor({type:2}),this._core.room.audioManager.removeDecodeProcessor({type:2})}encodeVideo(e){let{frame:t,mediaType:i}=e;return gR({frame:t,onDump:()=>{if(!i)return;let e=2===i?"sub":"main",r=this.dumpLocalVideoMap[e];r&&(r.data.push(t.data.slice(0)),r.duration>0&&Date.now()-r.startTimestamp>1e3*r.duration&&r.onDumpEnd())}})}decodeVideo(e){let{frame:t,track:i}=e;return vR({frame:t,onDump:()=>{if(!i)return;let e=this.dumpRemoteVideoMap["".concat(i.userId,"-").concat(i.streamType)];e&&(e.data.push(t.data.slice(0)),e.duration>0&&Date.now()-e.startTimestamp>1e3*e.duration&&e.onDumpEnd())}})}encodeAudio(e){let{frame:t}=e;return _R({frame:t,onDump:()=>{let e=this.dumpLocalAudioMap.main;e&&(e.data.push(t.data.slice(0)),e.duration>0&&Date.now()-e.startTimestamp>1e3*e.duration&&e.onDumpEnd())}})}decodeAudio(e){let{frame:t,track:i}=e;return yR({frame:t,onDump:()=>{if(!i)return;let e=this.dumpRemoteAudioMap[i.userId];e&&(e.data.push(t.data.slice(0)),e.duration>0&&Date.now()-e.startTimestamp>1e3*e.duration&&e.onDumpEnd())}})}};
/*! Bundled license information:

	jszip/dist/jszip.min.js:
	  (*!
	  
	  JSZip v3.10.1 - A JavaScript class for generating and reading zip files
	  <http://stuartk.com/jszip>
	  
	  (c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
	  Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.
	  
	  JSZip uses the library pako released under the MIT license :
	  https://github.com/nodeca/pako/blob/main/LICENSE
	  *)
	*/
return gA([kA(300,()=>"export")],BM.prototype,"onExportClick",1),gA([kA(300,()=>"upload")],BM.prototype,"onUploadClick",1),BM});
